!function(r){var t={};function e(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return r[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}e.m=r,e.c=t,e.d=function(r,t,n){e.o(r,t)||Object.defineProperty(r,t,{enumerable:!0,get:n})},e.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},e.t=function(r,t){if(1&t&&(r=e(r)),8&t)return r;if(4&t&&"object"==typeof r&&r&&r.__esModule)return r;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:r}),2&t&&"string"!=typeof r)for(var o in r)e.d(n,o,function(t){return r[t]}.bind(null,o));return n},e.n=function(r){var t=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(t,"a",t),t},e.o=function(r,t){return Object.prototype.hasOwnProperty.call(r,t)},e.p="",e(e.s=0)}([function(r,t,e){const n=e(1),o=e(16),c=e(17),u=e(18);window.runGenScene=function(){var r=document.getElementById("app"),t=u.Main.embed(r);((r,t)=>{document.body.style.backgroundColor=t.background;const e=t;r.ports.requestFssRebuild.subscribe(({layer:t,model:c,value:u})=>{const i=c.layers[t];if(o(i)){const o=n(c,u,e.layers[t].sceneFuzz);r.ports.rebuildFss.send({value:o,layer:t})}r.ports.hideControls.send(null)});const u=c(e);u.layers=e.layers.map(r=>{const t=c(r);return t.model=JSON.stringify(r.model),t}),r.ports.import_.send(JSON.stringify(u))})(t,window.jsGenScene),setTimeout(()=>{t.ports.setCustomSize.send([1e3,800])},100)}},function(r,t,e){window.FSSAvoidFloat32Array=!0,e(2),e(3),e(4),e(5),e(6),e(7),e(8),e(9),e(10),e(11),e(12),e(13),e(14),e(15),r.exports=function(r,t,e){var n=r.palette,o=new FSS.Scene,c=new FSS.Plane(r.size[0],r.size[1],t.faces[0],t.faces[1]),u=new FSS.Material(n[0],n[1]),i=new FSS.Mesh(c,u),a=new FSS.Light(n[0],n[1]),_=new FSS.Light(n[1],n[2]);return a.speed=t.lightSpeed,_.speed=t.lightSpeed,function(){var r,t;for(o.add(i),o.add(a),o.add(_),r=c.vertices.length-1;r>=0;r--)(t=c.vertices[r]).anchor=FSS.Vector3.clone(t.position),t.v0=e&&e[r]?e[r].v0:FSS.Vector3.create(Math.randomInRange(.2,1),Math.randomInRange(.2,1),Math.randomInRange(.2,1)),t.time=e&&e[r]?e[r].time:Math.randomInRange(0,Math.PIM2),t.gradient=e&&e[r]?e[r].gradient:Math.randomInRange(.3,1);a.setPosition(120,120,50),_.setPosition(30,100,30)}(),o}},function(r,t){FSS={FRONT:0,BACK:1,DOUBLE:2,SVGNS:"http://www.w3.org/2000/svg"},FSS.Array="function"==typeof Float32Array&&void 0===window.FSSAvoidFloat32Array?Float32Array:Array,FSS.Utils={isNumber:function(r){return!isNaN(parseFloat(r))&&isFinite(r)}},function(){for(var r=0,t=["ms","moz","webkit","o"],e=0;e<t.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[t[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[e]+"CancelAnimationFrame"]||window[t[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,e){var n=(new Date).getTime(),o=Math.max(0,16-(n-r)),c=window.setTimeout(function(){t(n+o)},o);return r=n+o,c}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(r){clearTimeout(r)})}()},function(r,t){FSS.Vector3={create:function(r,t,e){var n=new FSS.Array(3);return this.set(n,r,t,e),n},clone:function(r){var t=this.create();return this.copy(t,r),t},set:function(r,t,e,n){return r[0]=t||0,r[1]=e||0,r[2]=n||0,this},setX:function(r,t){return r[0]=t||0,this},setY:function(r,t){return r[1]=t||0,this},setZ:function(r,t){return r[2]=t||0,this},copy:function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],this},add:function(r,t){return r[0]+=t[0],r[1]+=t[1],r[2]+=t[2],this},addVectors:function(r,t,e){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],this},addScalar:function(r,t){return r[0]+=t,r[1]+=t,r[2]+=t,this},subtract:function(r,t){return r[0]-=t[0],r[1]-=t[1],r[2]-=t[2],this},subtractVectors:function(r,t,e){return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],this},subtractScalar:function(r,t){return r[0]-=t,r[1]-=t,r[2]-=t,this},multiply:function(r,t){return r[0]*=t[0],r[1]*=t[1],r[2]*=t[2],this},multiplyVectors:function(r,t,e){return r[0]=t[0]*e[0],r[1]=t[1]*e[1],r[2]=t[2]*e[2],this},multiplyScalar:function(r,t){return r[0]*=t,r[1]*=t,r[2]*=t,this},divide:function(r,t){return r[0]/=t[0],r[1]/=t[1],r[2]/=t[2],this},divideVectors:function(r,t,e){return r[0]=t[0]/e[0],r[1]=t[1]/e[1],r[2]=t[2]/e[2],this},divideScalar:function(r,t){return 0!==t?(r[0]/=t,r[1]/=t,r[2]/=t):(r[0]=0,r[1]=0,r[2]=0),this},cross:function(r,t){var e=r[0],n=r[1],o=r[2];return r[0]=n*t[2]-o*t[1],r[1]=o*t[0]-e*t[2],r[2]=e*t[1]-n*t[0],this},crossVectors:function(r,t,e){return r[0]=t[1]*e[2]-t[2]*e[1],r[1]=t[2]*e[0]-t[0]*e[2],r[2]=t[0]*e[1]-t[1]*e[0],this},min:function(r,t){return r[0]<t&&(r[0]=t),r[1]<t&&(r[1]=t),r[2]<t&&(r[2]=t),this},max:function(r,t){return r[0]>t&&(r[0]=t),r[1]>t&&(r[1]=t),r[2]>t&&(r[2]=t),this},clamp:function(r,t,e){return this.min(r,t),this.max(r,e),this},limit:function(r,t,e){var n=this.length(r);return null!==t&&n<t?this.setLength(r,t):null!==e&&n>e&&this.setLength(r,e),this},dot:function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]},normalise:function(r){return this.divideScalar(r,this.length(r))},negate:function(r){return this.multiplyScalar(r,-1)},distanceSquared:function(r,t){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2];return e*e+n*n+o*o},distance:function(r,t){return Math.sqrt(this.distanceSquared(r,t))},lengthSquared:function(r){return r[0]*r[0]+r[1]*r[1]+r[2]*r[2]},length:function(r){return Math.sqrt(this.lengthSquared(r))},setLength:function(r,t){var e=this.length(r);return 0!==e&&t!==e&&this.multiplyScalar(r,t/e),this}}},function(r,t){FSS.Vector4={create:function(r,t,e,n){var o=new FSS.Array(4);return this.set(o,r,t,e),o},set:function(r,t,e,n,o){return r[0]=t||0,r[1]=e||0,r[2]=n||0,r[3]=o||0,this},setX:function(r,t){return r[0]=t||0,this},setY:function(r,t){return r[1]=t||0,this},setZ:function(r,t){return r[2]=t||0,this},setW:function(r,t){return r[3]=t||0,this},add:function(r,t){return r[0]+=t[0],r[1]+=t[1],r[2]+=t[2],r[3]+=t[3],this},multiplyVectors:function(r,t,e){return r[0]=t[0]*e[0],r[1]=t[1]*e[1],r[2]=t[2]*e[2],r[3]=t[3]*e[3],this},multiplyScalar:function(r,t){return r[0]*=t,r[1]*=t,r[2]*=t,r[3]*=t,this},min:function(r,t){return r[0]<t&&(r[0]=t),r[1]<t&&(r[1]=t),r[2]<t&&(r[2]=t),r[3]<t&&(r[3]=t),this},max:function(r,t){return r[0]>t&&(r[0]=t),r[1]>t&&(r[1]=t),r[2]>t&&(r[2]=t),r[3]>t&&(r[3]=t),this},clamp:function(r,t,e){return this.min(r,t),this.max(r,e),this}}},function(r,t){FSS.Vertex=function(r,t,e){this.position=FSS.Vector3.create(r,t,e)},FSS.Vertex.prototype={setPosition:function(r,t,e){return FSS.Vector3.set(this.position,r,t,e),this}}},function(r,t){FSS.Color=function(r,t){this.rgba=FSS.Vector4.create(),this.hex=r||"#000000",this.opacity=FSS.Utils.isNumber(t)?t:1,this.set(this.hex,this.opacity)},FSS.Color.prototype={set:function(r,t){var e=(r=r.replace("#","")).length/3;return this.rgba[0]=parseInt(r.substring(0*e,1*e),16)/255,this.rgba[1]=parseInt(r.substring(1*e,2*e),16)/255,this.rgba[2]=parseInt(r.substring(2*e,3*e),16)/255,this.rgba[3]=FSS.Utils.isNumber(t)?t:this.rgba[3],this},hexify:function(r){var t=Math.ceil(255*r).toString(16);return 1===t.length&&(t="0"+t),t},format:function(){var r=this.hexify(this.rgba[0]),t=this.hexify(this.rgba[1]),e=this.hexify(this.rgba[2]);return this.hex="#"+r+t+e,this.hex}}},function(r,t){FSS.Triangle=function(r,t,e){this.a=r||new FSS.Vertex,this.b=t||new FSS.Vertex,this.c=e||new FSS.Vertex,this.vertices=[this.a,this.b,this.c],this.u=FSS.Vector3.create(),this.v=FSS.Vector3.create(),this.centroid=FSS.Vector3.create(),this.normal=FSS.Vector3.create(),this.color=new FSS.Color,this.polygon=document.createElementNS(FSS.SVGNS,"polygon"),this.polygon.setAttributeNS(null,"stroke-linejoin","round"),this.polygon.setAttributeNS(null,"stroke-miterlimit","1"),this.polygon.setAttributeNS(null,"stroke-width","1"),this.computeCentroid(),this.computeNormal()},FSS.Triangle.prototype={computeCentroid:function(){return this.centroid[0]=this.a.position[0]+this.b.position[0]+this.c.position[0],this.centroid[1]=this.a.position[1]+this.b.position[1]+this.c.position[1],this.centroid[2]=this.a.position[2]+this.b.position[2]+this.c.position[2],FSS.Vector3.divideScalar(this.centroid,3),this},computeNormal:function(){return FSS.Vector3.subtractVectors(this.u,this.b.position,this.a.position),FSS.Vector3.subtractVectors(this.v,this.c.position,this.a.position),FSS.Vector3.crossVectors(this.normal,this.u,this.v),FSS.Vector3.normalise(this.normal),this}}},function(r,t){FSS.Object=function(){this.position=FSS.Vector3.create()},FSS.Object.prototype={setPosition:function(r,t,e){return FSS.Vector3.set(this.position,r,t,e),this}}},function(r,t){FSS.Light=function(r,t){FSS.Object.call(this),this.ambient=new FSS.Color(r||"#FFFFFF"),this.diffuse=new FSS.Color(t||"#FFFFFF"),this.ray=FSS.Vector3.create()},FSS.Light.prototype=Object.create(FSS.Object.prototype)},function(r,t){FSS.Material=function(r,t){this.ambient=new FSS.Color(r||"#444444"),this.diffuse=new FSS.Color(t||"#FFFFFF"),this.slave=new FSS.Color}},function(r,t){FSS.Geometry=function(){this.vertices=[],this.triangles=[],this.dirty=!1},FSS.Geometry.prototype={update:function(){if(this.dirty){var r,t;for(r=this.triangles.length-1;r>=0;r--)(t=this.triangles[r]).computeCentroid(),t.computeNormal();this.dirty=!1}return this}}},function(r,t){FSS.Plane=function(r,t,e,n){FSS.Geometry.call(this),this.width=r||100,this.height=t||100,this.segments=e||4,this.slices=n||4,this.segmentWidth=this.width/this.segments,this.sliceHeight=this.height/this.slices;var o,c,u,i,a,_,l,s=[],f=-.5*this.width,d=.5*this.height;for(o=0;o<=this.segments;o++)for(s.push([]),c=0;c<=this.slices;c++)l=new FSS.Vertex(f+o*this.segmentWidth,d-c*this.sliceHeight),s[o].push(l),this.vertices.push(l);for(o=0;o<this.segments;o++)for(c=0;c<this.slices;c++)u=s[o+0][c+0],i=s[o+0][c+1],a=s[o+1][c+0],_=s[o+1][c+1],t0=new FSS.Triangle(u,i,a),t1=new FSS.Triangle(a,i,_),this.triangles.push(t0,t1)},FSS.Plane.prototype=Object.create(FSS.Geometry.prototype)},function(r,t){FSS.Mesh=function(r,t){FSS.Object.call(this),this.geometry=r||new FSS.Geometry,this.material=t||new FSS.Material,this.side=FSS.FRONT,this.visible=!0},FSS.Mesh.prototype=Object.create(FSS.Object.prototype),FSS.Mesh.prototype.update=function(r,t){var e,n,o,c,u;if(this.geometry.update(),t)for(e=this.geometry.triangles.length-1;e>=0;e--){for(n=this.geometry.triangles[e],FSS.Vector4.set(n.color.rgba),o=r.length-1;o>=0;o--)c=r[o],FSS.Vector3.subtractVectors(c.ray,c.position,n.centroid),FSS.Vector3.normalise(c.ray),u=FSS.Vector3.dot(n.normal,c.ray),this.side===FSS.FRONT?u=Math.max(u,0):this.side===FSS.BACK?u=Math.abs(Math.min(u,0)):this.side===FSS.DOUBLE&&(u=Math.max(Math.abs(u),0)),FSS.Vector4.multiplyVectors(this.material.slave.rgba,this.material.ambient.rgba,c.ambient.rgba),FSS.Vector4.add(n.color.rgba,this.material.slave.rgba),FSS.Vector4.multiplyVectors(this.material.slave.rgba,this.material.diffuse.rgba,c.diffuse.rgba),FSS.Vector4.multiplyScalar(this.material.slave.rgba,u),FSS.Vector4.add(n.color.rgba,this.material.slave.rgba);FSS.Vector4.clamp(n.color.rgba,0,1)}return this}},function(r,t){FSS.Scene=function(){this.meshes=[],this.lights=[]},FSS.Scene.prototype={add:function(r){return r instanceof FSS.Mesh&&!~this.meshes.indexOf(r)?this.meshes.push(r):r instanceof FSS.Light&&!~this.lights.indexOf(r)&&this.lights.push(r),this},remove:function(r){return r instanceof FSS.Mesh&&~this.meshes.indexOf(r)?this.meshes.splice(this.meshes.indexOf(r),1):r instanceof FSS.Light&&~this.lights.indexOf(r)&&this.lights.splice(this.lights.indexOf(r),1),this}}},function(r,t){Math.PIM2=2*Math.PI,Math.PID2=Math.PI/2,Math.randomInRange=function(r,t){return r+(t-r)*Math.random()},Math.clamp=function(r,t,e){return r=Math.max(r,t),r=Math.min(r,e)}},function(r,t){r.exports=(r=>"fss"==r.kind||"fss-mirror"==r.kind)},function(r,t){r.exports=function(r){return JSON.parse(JSON.stringify(r))}},function(r,t){(function(){"use strict";function t(r){function t(t){return function(e){return r(t,e)}}return t.arity=2,t.func=r,t}function e(r){function t(t){return function(e){return function(n){return r(t,e,n)}}}return t.arity=3,t.func=r,t}function n(r){function t(t){return function(e){return function(n){return function(o){return r(t,e,n,o)}}}}return t.arity=4,t.func=r,t}function o(r){function t(t){return function(e){return function(n){return function(o){return function(c){return r(t,e,n,o,c)}}}}}return t.arity=5,t.func=r,t}function c(r){function t(t){return function(e){return function(n){return function(o){return function(c){return function(u){return r(t,e,n,o,c,u)}}}}}}return t.arity=6,t.func=r,t}function u(r){function t(t){return function(e){return function(n){return function(o){return function(c){return function(u){return function(i){return r(t,e,n,o,c,u,i)}}}}}}}return t.arity=7,t.func=r,t}function i(r){function t(t){return function(e){return function(n){return function(o){return function(c){return function(u){return function(i){return function(a){return r(t,e,n,o,c,u,i,a)}}}}}}}}return t.arity=8,t.func=r,t}function a(r){function t(t){return function(e){return function(n){return function(o){return function(c){return function(u){return function(i){return function(a){return function(_){return r(t,e,n,o,c,u,i,a,_)}}}}}}}}}return t.arity=9,t.func=r,t}function _(r,t,e){return 2===r.arity?r.func(t,e):r(t)(e)}function l(r,t,e,n){return 3===r.arity?r.func(t,e,n):r(t)(e)(n)}function s(r,t,e,n,o){return 4===r.arity?r.func(t,e,n,o):r(t)(e)(n)(o)}function f(r,t,e,n,o,c){return 5===r.arity?r.func(t,e,n,o,c):r(t)(e)(n)(o)(c)}function d(r,t,e,n,o,c,u){return 6===r.arity?r.func(t,e,n,o,c,u):r(t)(e)(n)(o)(c)(u)}var p=function(){var r=32,n=2,o={ctor:"_Array",height:0,table:[]};function c(t,e){var n=t.height;if(e.length===n){var o={ctor:"_Array",height:n+1,table:[],lengths:[]};e.push(o)}e[n].table.push(t);var u=v(t);e[n].lengths.length>0&&(u+=e[n].lengths[e[n].lengths.length-1]),e[n].lengths.push(u),e[n].table.length===r&&(c(e[n],e),e[n]={ctor:"_Array",height:n+1,table:[],lengths:[]})}function u(r,t){var e=r.table.length-1;r.table[e]=t,r.lengths[e]=v(t),r.lengths[e]+=e>0?r.lengths[e-1]:0}function i(r,t){if(t.table.length>0){r.table[0]=t,r.lengths[0]=v(t);for(var e=v(r.table[0]),n=1;n<r.lengths.length;n++)e+=v(r.table[n]),r.lengths[n]=e}else{r.table.shift();for(n=1;n<r.lengths.length;n++)r.lengths[n]=r.lengths[n]-r.lengths[0];r.lengths.shift()}}function a(t,e){for(var n=0,o=0;o<t.table.length;o++)n+=t.table[o].table.length;for(o=0;o<e.table.length;o++)n+=e.table[o].table.length;return t.table.length+e.table.length-(Math.floor((n-1)/r)+1)}function l(r,t,e){return e<r.length?r[e]:t[e-r.length]}function s(r,t,e,n){e<r.length?r[e]=n:t[e-r.length]=n}function f(r,t,e,n){s(r.table,t.table,e,n);var o=0===e||e===r.lengths.length?0:l(r.lengths,r.lengths,e-1);s(r.lengths,t.lengths,e,o+v(n))}function d(r,t){t<0&&(t=0);var e={ctor:"_Array",height:r,table:new Array(t)};return r>0&&(e.lengths=new Array(t)),e}function p(t,e,n){for(var o=d(t.height,Math.min(r,t.table.length+e.table.length-n)),c=d(t.height,o.table.length-(t.table.length+e.table.length-n)),u=0;l(t.table,e.table,u).table.length%r==0;)s(o.table,c.table,u,l(t.table,e.table,u)),s(o.lengths,c.lengths,u,l(t.lengths,e.lengths,u)),u++;for(var i=u,a=new d(t.height-1,0),_=0;u-i-(a.table.length>0?1:0)<n;){var p=l(t.table,e.table,u),h=Math.min(r-a.table.length,p.table.length);if(a.table=a.table.concat(p.table.slice(_,h)),a.height>0)for(var m=a.lengths.length,g=m;g<m+h-_;g++)a.lengths[g]=v(a.table[g]),a.lengths[g]+=g>0?a.lengths[g-1]:0;_+=h,p.table.length<=h&&(u++,_=0),a.table.length===r&&(f(o,c,i,a),a=d(t.height-1,0),i++)}for(a.table.length>0&&(f(o,c,i,a),i++);u<t.table.length+e.table.length;)f(o,c,i,l(t.table,e.table,u)),u++,i++;return[o,c]}function h(r){return r.table[r.table.length-1]}function m(r){return r.table[0]}function g(r){var t={ctor:"_Array",height:r.height,table:r.table.slice()};return r.height>0&&(t.lengths=r.lengths.slice()),t}function v(r){return 0===r.height?r.table.length:r.lengths[r.lengths.length-1]}function b(r,t){for(var e=r>>5*t.height;t.lengths[e]<=r;)e++;return e}function y(r,t){return 0===t?{ctor:"_Array",height:0,table:[r]}:{ctor:"_Array",height:t,table:[y(r,t-1)],lengths:[1]}}function T(r,t){return t===r.height?r:{ctor:"_Array",height:t,table:[T(r,t-1)],lengths:[v(r)]}}function w(r,t){return{ctor:"_Array",height:r.height+1,table:[r,t],lengths:[v(r),v(r)+v(t)]}}return{empty:o,fromList:function(t){if("[]"===t.ctor)return o;for(var e=new Array(r),n=[],u=0;"[]"!==t.ctor;)e[u]=t._0,t=t._1,++u===r&&(c({ctor:"_Array",height:0,table:e},n),e=new Array(r),u=0);u>0&&c({ctor:"_Array",height:0,table:e.splice(0,u)},n);for(var i=0;i<n.length-1;i++)n[i].table.length>0&&c(n[i],n);var a=n[n.length-1];return a.height>0&&1===a.table.length?a.table[0]:a},toList:function(r){return function r(t,e){for(var n=e.table.length-1;n>=0;n--)t=0===e.height?N.Cons(e.table[n],t):r(t,e.table[n]);return t}(N.Nil,r)},initialize:t(function(t,e){return t<=0?o:function t(e,n,o,c){if(0===n){for(var u=new Array((c-o)%(r+1)),i=0;i<u.length;i++)u[i]=e(o+i);return{ctor:"_Array",height:0,table:u}}for(var a=Math.pow(r,n),u=new Array(Math.ceil((c-o)/a)),_=new Array(u.length),i=0;i<u.length;i++)u[i]=t(e,n-1,o+i*a,Math.min(o+(i+1)*a,c)),_[i]=v(u[i])+(i>0?_[i-1]:0);return{ctor:"_Array",height:n,table:u,lengths:_}}(e,Math.floor(Math.log(t)/Math.log(r)),0,t)}),append:t(function(t,e){if(0===t.table.length)return e;if(0===e.table.length)return t;var o=function r(t,e){if(0===t.height&&0===e.height)return[t,e];if(1!==t.height||1!==e.height)if(t.height===e.height){t=g(t),e=g(e);var o=r(h(t),m(e));u(t,o[1]),i(e,o[0])}else if(t.height>e.height){t=g(t);var o=r(h(t),e);u(t,o[0]),e=T(o[1],o[1].height+1)}else{e=g(e);var o=r(t,m(e)),c=0===o[0].table.length?0:1,_=0===c?1:0;i(e,o[c]),t=T(o[_],o[_].height+1)}if(0===t.table.length||0===e.table.length)return[t,e];var l=a(t,e);return l<=n?[t,e]:p(t,e,l)}(t,e);if(o[0].table.length+o[1].table.length<=r){if(0===o[0].table.length)return o[1];if(0===o[1].table.length)return o[0];if(o[0].table=o[0].table.concat(o[1].table),o[0].height>0){for(var c=v(o[0]),_=0;_<o[1].lengths.length;_++)o[1].lengths[_]+=c;o[0].lengths=o[0].lengths.concat(o[1].lengths)}return o[0]}if(o[0].height>0){var l=a(t,e);l>n&&(o=p(o[0],o[1],l))}return w(o[0],o[1])}),push:t(function(t,e){var n=function t(e,n){if(0===n.height){if(n.table.length<r){var o={ctor:"_Array",height:0,table:n.table.slice()};return o.table.push(e),o}return null}var c=t(e,h(n));if(null!==c){var o=g(n);return o.table[o.table.length-1]=c,o.lengths[o.lengths.length-1]++,o}if(n.table.length<r){var u=y(e,n.height-1),o=g(n);return o.table.push(u),o.lengths.push(o.lengths[o.lengths.length-1]+v(u)),o}return null}(t,e);return null!==n?n:w(e,y(t,e.height))}),slice:e(function(r,t,e){return r<0&&(r+=v(e)),t<0&&(t+=v(e)),function r(t,e){if(0===t)return e;if(0===e.height){var n={ctor:"_Array",height:0};return n.table=e.table.slice(t,e.table.length+1),n}var o=b(t,e),c=r(t-(o>0?e.lengths[o-1]:0),e.table[o]);if(o===e.table.length-1)return c;var n={ctor:"_Array",height:e.height,table:e.table.slice(o,e.table.length+1),lengths:new Array(e.table.length-o)};n.table[0]=c;for(var u=0,i=0;i<n.table.length;i++)u+=v(n.table[i]),n.lengths[i]=u;return n}(r,function r(t,e){if(t===v(e))return e;if(0===e.height){var n={ctor:"_Array",height:0};return n.table=e.table.slice(0,t),n}var o=b(t,e),c=r(t-(o>0?e.lengths[o-1]:0),e.table[o]);if(0===o)return c;var n={ctor:"_Array",height:e.height,table:e.table.slice(0,o),lengths:e.lengths.slice(0,o)};return c.table.length>0&&(n.table[o]=c,n.lengths[o]=v(c)+(o>0?n.lengths[o-1]:0)),n}(t,e))}),get:t(function(r,t){if(r<0||r>=v(t))throw new Error("Index "+r+" is out of range. Check the length of your array first or use getMaybe or getWithDefault.");return function(r,t){for(var e=t.height;e>0;e--){for(var n=r>>5*e;t.lengths[n]<=r;)n++;n>0&&(r-=t.lengths[n-1]),t=t.table[n]}return t.table[r]}(r,t)}),set:e(function(r,t,e){return r<0||v(e)<=r?e:function r(t,e,n){if(0===(n=g(n)).height)n.table[t]=e;else{var o=b(t,n);o>0&&(t-=n.lengths[o-1]),n.table[o]=r(t,e,n.table[o])}return n}(r,t,e)}),map:t(function r(t,e){var n={ctor:"_Array",height:e.height,table:new Array(e.table.length)};e.height>0&&(n.lengths=e.lengths);for(var o=0;o<e.table.length;o++)n.table[o]=0===e.height?t(e.table[o]):r(t,e.table[o]);return n}),indexedMap:t(function(r,t){return function r(t,e,n){var o={ctor:"_Array",height:e.height,table:new Array(e.table.length)};e.height>0&&(o.lengths=e.lengths);for(var c=0;c<e.table.length;c++)o.table[c]=0===e.height?_(t,n+c,e.table[c]):r(t,e.table[c],0==c?n:n+e.lengths[c-1]);return o}(r,t,0)}),foldl:e(function r(t,e,n){if(0===n.height)for(var o=0;o<n.table.length;o++)e=_(t,n.table[o],e);else for(o=0;o<n.table.length;o++)e=r(t,e,n.table[o]);return e}),foldr:e(function r(t,e,n){if(0===n.height)for(var o=n.table.length;o--;)e=_(t,n.table[o],e);else for(o=n.table.length;o--;)e=r(t,e,n.table[o]);return e}),length:v,toJSArray:function(r){var t=new Array(v(r));return function r(t,e,n){for(var o=0;o<n.table.length;o++)if(0===n.height)t[e+o]=n.table[o];else{var c=0===o?0:n.lengths[o-1];r(t,e+c,n.table[o])}}(t,0,r),t},fromJSArray:function(t){return 0===t.length?o:function t(e,n,o,c){if(0===n)return{ctor:"_Array",height:0,table:e.slice(o,c)};for(var u=Math.pow(r,n),i=new Array(Math.ceil((c-o)/u)),a=new Array(i.length),_=0;_<i.length;_++)i[_]=t(e,n-1,o+_*u,Math.min(o+(_+1)*u,c)),a[_]=v(i[_])+(_>0?a[_-1]:0);return{ctor:"_Array",height:n,table:i,lengths:a}}(t,Math.floor(Math.log(t.length)/Math.log(r)),0,t.length)}}}(),h=function(){var r=["LT","EQ","GT"];return{div:t(function(r,t){return r/t|0}),rem:t(function(r,t){return r%t}),mod:t(function r(t,e){if(0===e)throw new Error("Cannot perform mod 0. Division by zero error.");var n=t%e,o=0===t?0:e>0?t>=0?n:n+e:-r(-t,-e);return o===e?0:o}),pi:Math.PI,e:Math.E,cos:Math.cos,sin:Math.sin,tan:Math.tan,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:t(Math.atan2),degrees:function(r){return r*Math.PI/180},turns:function(r){return 2*Math.PI*r},fromPolar:function(r){var t=r._0,e=r._1;return m.Tuple2(t*Math.cos(e),t*Math.sin(e))},toPolar:function(r){var t=r._0,e=r._1;return m.Tuple2(Math.sqrt(t*t+e*e),Math.atan2(e,t))},sqrt:Math.sqrt,logBase:t(function(r,t){return Math.log(t)/Math.log(r)}),negate:function(r){return-r},abs:function(r){return r<0?-r:r},min:t(function(r,t){return m.cmp(r,t)<0?r:t}),max:t(function(r,t){return m.cmp(r,t)>0?r:t}),clamp:e(function(r,t,e){return m.cmp(e,r)<0?r:m.cmp(e,t)>0?t:e}),compare:t(function(t,e){return{ctor:r[m.cmp(t,e)+1]}}),xor:t(function(r,t){return r!==t}),not:function(r){return!r},truncate:function(r){return 0|r},ceiling:Math.ceil,floor:Math.floor,round:Math.round,toFloat:function(r){return r},isNaN:isNaN,isInfinite:function(r){return r===1/0||r===-1/0}}}(),m=function(){function r(t,e,n,o){if(n>100)return o.push({x:t,y:e}),!0;if(t===e)return!0;if("object"!=typeof t){if("function"==typeof t)throw new Error('Trying to use `(==)` on functions. There is no way to know if functions are "the same" in the Elm sense. Read more about this at http://package.elm-lang.org/packages/elm-lang/core/latest/Basics#== which describes why it is this way and what the better version will look like.');return!1}if(null===t||null===e)return!1;if(t instanceof Date)return t.getTime()===e.getTime();if(!("ctor"in t)){for(var c in t)if(!r(t[c],e[c],n+1,o))return!1;return!0}if("RBNode_elm_builtin"!==t.ctor&&"RBEmpty_elm_builtin"!==t.ctor||(t=Ur(t),e=Ur(e)),"Set_elm_builtin"===t.ctor&&(t=Qe(t),e=Qe(e)),"::"===t.ctor){for(var u=t,i=e;"::"===u.ctor&&"::"===i.ctor;){if(!r(u._0,i._0,n+1,o))return!1;u=u._1,i=i._1}return u.ctor===i.ctor}if("_Array"===t.ctor){var a=p.toJSArray(t),_=p.toJSArray(e);if(a.length!==_.length)return!1;for(var l=0;l<a.length;l++)if(!r(a[l],_[l],n+1,o))return!1;return!0}if(!r(t.ctor,e.ctor,n+1,o))return!1;for(var c in t)if(!r(t[c],e[c],n+1,o))return!1;return!0}var e=-1,n=0,o=1;var c=0;var u={ctor:"[]"};function i(r,t){return{ctor:"::",_0:r,_1:t}}function a(r){return r.start.line==r.end.line?"on line "+r.start.line:"between lines "+r.start.line+" and "+r.end.line}function _(r){var t=typeof r;if("function"===t)return"<function>";if("boolean"===t)return r?"True":"False";if("number"===t)return r+"";if(r instanceof String)return"'"+l(r,!0)+"'";if("string"===t)return'"'+l(r,!1)+'"';if(null===r)return"null";if("object"===t&&"ctor"in r){var e=r.ctor.substring(0,5);if("_Tupl"===e){var n=[];for(var o in r)"ctor"!==o&&n.push(_(r[o]));return"("+n.join(",")+")"}if("_Task"===e)return"<task>";if("_Array"===r.ctor)return"Array.fromList "+_(vr(r));if("<decoder>"===r.ctor)return"<decoder>";if("_Process"===r.ctor)return"<process:"+r.id+">";if("::"===r.ctor){n="["+_(r._0);for(r=r._1;"::"===r.ctor;)n+=","+_(r._0),r=r._1;return n+"]"}if("[]"===r.ctor)return"[]";if("Set_elm_builtin"===r.ctor)return"Set.fromList "+_(Qe(r));if("RBNode_elm_builtin"===r.ctor||"RBEmpty_elm_builtin"===r.ctor)return"Dict.fromList "+_(Ur(r));n="";for(var c in r)if("ctor"!==c){var u=_(r[c]),i=u[0];n+=" "+("{"===i||"("===i||"<"===i||'"'===i||u.indexOf(" ")<0?u:"("+u+")")}return r.ctor+n}if("object"===t){if(r instanceof Date)return"<"+r.toString()+">";if(r.elm_web_socket)return"<websocket>";n=[];for(var o in r)n.push(o+" = "+_(r[o]));return 0===n.length?"{}":"{ "+n.join(", ")+" }"}return"<internal structure>"}function l(r,t){var e=r.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/\v/g,"\\v").replace(/\0/g,"\\0");return t?e.replace(/\'/g,"\\'"):e.replace(/\"/g,'\\"')}return{eq:function(t,e){for(var n,o=[],c=r(t,e,0,o);c&&(n=o.pop());)c=r(n.x,n.y,0,o);return c},cmp:function r(t,c){if("object"!=typeof t)return t===c?n:t<c?e:o;if(t instanceof String){var u=t.valueOf(),i=c.valueOf();return u===i?n:u<i?e:o}if("::"===t.ctor||"[]"===t.ctor){for(;"::"===t.ctor&&"::"===c.ctor;){if((a=r(t._0,c._0))!==n)return a;t=t._1,c=c._1}return t.ctor===c.ctor?n:"[]"===t.ctor?e:o}if("_Tuple"===t.ctor.slice(0,6)){var a,_=t.ctor.slice(6)-0;if(0===_)return n;if(_>=1){if((a=r(t._0,c._0))!==n)return a;if(_>=2){if((a=r(t._1,c._1))!==n)return a;if(_>=3){if((a=r(t._2,c._2))!==n)return a;if(_>=4){if((a=r(t._3,c._3))!==n)return a;if(_>=5){if((a=r(t._4,c._4))!==n)return a;if(_>=6){if((a=r(t._5,c._5))!==n)return a;if(_>=7)throw new Error("Comparison error: cannot compare tuples with more than 6 elements.")}}}}}}return n}throw new Error("Comparison error: comparison is only defined on ints, floats, times, chars, strings, lists of comparable values, and tuples of comparable values.")},Tuple0:{ctor:"_Tuple0"},Tuple2:function(r,t){return{ctor:"_Tuple2",_0:r,_1:t}},chr:function(r){return new String(r)},update:function(r,t){var e={};for(var n in r)e[n]=r[n];for(var n in t)e[n]=t[n];return e},guid:function(r){return c++},append:t(function(r,t){if("string"==typeof r)return r+t;if("[]"===r.ctor)return t;var e=i(r._0,u),n=e;for(r=r._1;"[]"!==r.ctor;)n._1=i(r._0,u),r=r._1,n=n._1;return n._1=t,e}),crash:function(r,t){return function(e){throw new Error("Ran into a `Debug.crash` in module `"+r+"` "+a(t)+"\nThe message provided by the code author is:\n\n    "+e)}},crashCase:function(r,t,e){return function(n){throw new Error("Ran into a `Debug.crash` in module `"+r+"`\n\nThis was caused by the `case` expression "+a(t)+".\nOne of the branches ended with a crash and the following value got through:\n\n    "+_(e)+"\n\nThe message provided by the code author is:\n\n    "+n)}},toString:_}}(),g=(t(function(r,t){var e=t;return _(r,e._0,e._1)}),e(function(r,t,e){return r({ctor:"_Tuple2",_0:t,_1:e})}),e(function(r,t,e){return _(r,e,t)})),v=t(function(r,t){return r}),b=function(r){return r};(C=C||{})["<|"]=t(function(r,t){return r(t)}),(C=C||{})["|>"]=t(function(r,t){return t(r)}),(C=C||{})[">>"]=e(function(r,t,e){return t(r(e))}),(C=C||{})["<<"]=e(function(r,t,e){return r(t(e))}),(C=C||{})["++"]=m.append;var y=m.toString,T=(h.isInfinite,h.isNaN,h.toFloat),w=h.ceiling,S=h.floor,k=(h.truncate,h.round);h.not,h.xor;(C=C||{})["||"]=h.or,(C=C||{})["&&"]=h.and;h.max,h.min;var x=h.compare;(C=C||{})[">="]=h.ge,(C=C||{})["<="]=h.le,(C=C||{})[">"]=h.gt,(C=C||{})["<"]=h.lt,(C=C||{})["/="]=h.neq,(C=C||{})["=="]=h.eq;h.e,h.pi,h.clamp,h.logBase,h.abs,h.negate,h.sqrt,h.atan2,h.atan,h.asin,h.acos,h.tan,h.sin,h.cos;(C=C||{})["^"]=h.exp,(C=C||{})["%"]=h.mod;var C,F=h.rem;(C=C||{})["//"]=h.div,(C=C||{})["/"]=h.floatDiv,(C=C||{})["*"]=h.mul,(C=C||{})["-"]=h.sub,(C=C||{})["+"]=h.add;h.toPolar,h.fromPolar,h.turns;var L=h.degrees,R=t(function(r,t){var e=t;return"Just"===e.ctor?e._0:r}),A={ctor:"Nothing"},M=t(function(r,t){var e=t;return"Just"===e.ctor?r(e._0):A}),P=function(r){return{ctor:"Just",_0:r}},E=t(function(r,t){var e=t;return"Just"===e.ctor?P(r(e._0)):A}),N=(e(function(r,t,e){var n={ctor:"_Tuple2",_0:t,_1:e};return"_Tuple2"===n.ctor&&"Just"===n._0.ctor&&"Just"===n._1.ctor?P(_(r,n._0._0,n._1._0)):A}),n(function(r,t,e,n){var o={ctor:"_Tuple3",_0:t,_1:e,_2:n};return"_Tuple3"===o.ctor&&"Just"===o._0.ctor&&"Just"===o._1.ctor&&"Just"===o._2.ctor?P(l(r,o._0._0,o._1._0,o._2._0)):A}),o(function(r,t,e,n,o){var c={ctor:"_Tuple4",_0:t,_1:e,_2:n,_3:o};return"_Tuple4"===c.ctor&&"Just"===c._0.ctor&&"Just"===c._1.ctor&&"Just"===c._2.ctor&&"Just"===c._3.ctor?P(s(r,c._0._0,c._1._0,c._2._0,c._3._0)):A}),c(function(r,t,e,n,o,c){var u={ctor:"_Tuple5",_0:t,_1:e,_2:n,_3:o,_4:c};return"_Tuple5"===u.ctor&&"Just"===u._0.ctor&&"Just"===u._1.ctor&&"Just"===u._2.ctor&&"Just"===u._3.ctor&&"Just"===u._4.ctor?P(f(r,u._0._0,u._1._0,u._2._0,u._3._0,u._4._0)):A}),function(){var r={ctor:"[]"};function u(r,t){return{ctor:"::",_0:r,_1:t}}function i(t){for(var e=r,n=t.length;n--;)e=u(t[n],e);return e}function a(r){for(var t=[];"[]"!==r.ctor;)t.push(r._0),r=r._1;return t}return{Nil:r,Cons:u,cons:t(u),toArray:a,fromArray:i,foldr:e(function(r,t,e){for(var n=a(e),o=t,c=n.length;c--;)o=_(r,n[c],o);return o}),map2:e(function(r,t,e){for(var n=[];"[]"!==t.ctor&&"[]"!==e.ctor;)n.push(_(r,t._0,e._0)),t=t._1,e=e._1;return i(n)}),map3:n(function(r,t,e,n){for(var o=[];"[]"!==t.ctor&&"[]"!==e.ctor&&"[]"!==n.ctor;)o.push(l(r,t._0,e._0,n._0)),t=t._1,e=e._1,n=n._1;return i(o)}),map4:o(function(r,t,e,n,o){for(var c=[];"[]"!==t.ctor&&"[]"!==e.ctor&&"[]"!==n.ctor&&"[]"!==o.ctor;)c.push(s(r,t._0,e._0,n._0,o._0)),t=t._1,e=e._1,n=n._1,o=o._1;return i(c)}),map5:c(function(r,t,e,n,o,c){for(var u=[];"[]"!==t.ctor&&"[]"!==e.ctor&&"[]"!==n.ctor&&"[]"!==o.ctor&&"[]"!==c.ctor;)u.push(f(r,t._0,e._0,n._0,o._0,c._0)),t=t._1,e=e._1,n=n._1,o=o._1,c=c._1;return i(u)}),sortBy:t(function(r,t){return i(a(t).sort(function(t,e){return m.cmp(r(t),r(e))}))}),sortWith:t(function(r,t){return i(a(t).sort(function(t,e){var n=r(t)(e).ctor;return"EQ"===n?0:"LT"===n?-1:1}))})}}()),B=N.sortWith,O=(N.sortBy,t(function(r,t){for(;;){if(m.cmp(r,0)<1)return t;var e=t;if("[]"===e.ctor)return t;r=r-1,t=e._1}})),z=N.map5,I=N.map4,q=N.map3,V=N.map2,D=t(function(r,t){for(;;){var e=t;if("[]"===e.ctor)return!1;if(r(e._0))return!0;r=r,t=e._1}}),G=(t(function(r,t){return!_(D,function(t){return!r(t)},t)}),N.foldr),H=e(function(r,t,e){for(;;){var n=e;if("[]"===n.ctor)return t;var o=r,c=_(r,n._0,t);r=o,t=c,e=n._1}}),J=function(r){return l(H,t(function(r,t){return t+1}),0,r)},U=t(function(r,t){return _(D,function(t){return m.eq(t,r)},t)}),W=function(r){return"[]"===r.ctor},j=function(r){var t=r;return"::"===t.ctor?P(t._1):A},Y=function(r){var t=r;return"::"===t.ctor?P(t._0):A},K=K||{};K["::"]=N.cons;var X=t(function(r,e){return l(G,t(function(t,e){return{ctor:"::",_0:r(t),_1:e}}),{ctor:"[]"},e)}),Z=t(function(r,e){var n=t(function(t,e){return r(t)?{ctor:"::",_0:t,_1:e}:e});return l(G,n,{ctor:"[]"},e)}),$=e(function(r,t,e){var n=r(t);return"Just"===n.ctor?{ctor:"::",_0:n._0,_1:e}:e}),Q=t(function(r,t){return l(G,$(r),{ctor:"[]"},t)}),rr=function(r){return l(H,t(function(r,t){return{ctor:"::",_0:r,_1:t}}),{ctor:"[]"},r)},tr=e(function(r,e,n){var o=t(function(t,e){var n=e;return"::"===n.ctor?{ctor:"::",_0:_(r,t,n._0),_1:e}:{ctor:"[]"}});return rr(l(H,o,{ctor:"::",_0:e,_1:{ctor:"[]"}},n))}),er=t(function(r,e){return"[]"===e.ctor?r:l(G,t(function(r,t){return{ctor:"::",_0:r,_1:t}}),e,r)}),nr=function(r){return l(G,er,{ctor:"[]"},r)},or=t(function(r,t){return nr(_(X,r,t))}),cr=(t(function(r,e){var n=t(function(t,e){var n=e,o=n._0,c=n._1;return r(t)?{ctor:"_Tuple2",_0:{ctor:"::",_0:t,_1:o},_1:c}:{ctor:"_Tuple2",_0:o,_1:{ctor:"::",_0:t,_1:c}}});return l(G,n,{ctor:"_Tuple2",_0:{ctor:"[]"},_1:{ctor:"[]"}},e)}),t(function(r,e){var n=e;if("[]"===n.ctor)return{ctor:"[]"};var o=t(function(t,e){return{ctor:"::",_0:r,_1:{ctor:"::",_0:t,_1:e}}}),c=l(G,o,{ctor:"[]"},n._1);return{ctor:"::",_0:n._0,_1:c}}),e(function(r,t,e){for(;;){if(m.cmp(r,0)<1)return e;var n=t;if("[]"===n.ctor)return e;r=r-1,t=n._1,e={ctor:"::",_0:n._0,_1:e}}})),ur=t(function(r,t){return rr(l(cr,r,t,{ctor:"[]"}))}),ir=e(function(r,t,e){if(m.cmp(t,0)<1)return{ctor:"[]"};var n={ctor:"_Tuple2",_0:t,_1:e};r:do{t:do{if("_Tuple2"!==n.ctor)break r;if("[]"===n._1.ctor)return e;if("::"!==n._1._1.ctor){if(1===n._0)break t;break r}switch(n._0){case 1:break t;case 2:return{ctor:"::",_0:n._1._0,_1:{ctor:"::",_0:n._1._1._0,_1:{ctor:"[]"}}};case 3:if("::"===n._1._1._1.ctor)return{ctor:"::",_0:n._1._0,_1:{ctor:"::",_0:n._1._1._0,_1:{ctor:"::",_0:n._1._1._1._0,_1:{ctor:"[]"}}}};break r;default:if("::"===n._1._1._1.ctor&&"::"===n._1._1._1._1.ctor){var o=n._1._1._1._0,c=n._1._1._0,u=n._1._0,i=n._1._1._1._1._0,a=n._1._1._1._1._1;return m.cmp(r,1e3)>0?{ctor:"::",_0:u,_1:{ctor:"::",_0:c,_1:{ctor:"::",_0:o,_1:{ctor:"::",_0:i,_1:_(ur,t-4,a)}}}}:{ctor:"::",_0:u,_1:{ctor:"::",_0:c,_1:{ctor:"::",_0:o,_1:{ctor:"::",_0:i,_1:l(ir,r+1,t-4,a)}}}}}break r}}while(0);return{ctor:"::",_0:n._1._0,_1:{ctor:"[]"}}}while(0);return e}),ar=t(function(r,t){return l(ir,0,r,t)}),_r=e(function(r,t,e){for(;;){if(m.cmp(t,0)<1)return r;r={ctor:"::",_0:e,_1:r},t=t-1,e=e}}),lr=(t(function(r,t){return l(_r,{ctor:"[]"},r,t)}),e(function(r,t,e){for(;;){if(!(m.cmp(r,t)<1))return e;var n={ctor:"::",_0:t,_1:e};r=r,t=t-1,e=n}})),sr=t(function(r,t){return l(lr,r,t,{ctor:"[]"})}),fr=t(function(r,t){return l(V,r,_(sr,0,J(t)-1),t)}),dr=(p.append,p.length,p.slice,p.set),pr=t(function(r,t){return m.cmp(0,r)<1&&m.cmp(r,p.length(t))<0?P(_(p.get,r,t)):A}),hr=(p.push,p.empty,t(function(r,e){var n=t(function(t,e){return r(t)?_(p.push,t,e):e});return l(p.foldl,n,p.empty,e)}),p.foldr,p.foldl),mr=p.indexedMap,gr=p.map,vr=p.toList,br=p.fromList,yr=p.initialize,Tr=t(function(r,t){return _(yr,r,v(t))}),wr=function(){return{crash:function(r){throw new Error(r)},log:t(function(r,t){var e=r+": "+m.toString(t),n=n||{};return n.stdout?n.stdout.write(e):console.log(e),t})}}(),Sr=function(){function r(r,t){for(var e="";r>0;)1&r&&(e+=t),r>>=1,t+=t;return e}function n(r){return Rr("could not convert string '"+r+"' to an Int")}function o(r){return Rr("could not convert string '"+r+"' to a Float")}return{isEmpty:function(r){return 0===r.length},cons:t(function(r,t){return r+t}),uncons:function(r){var t=r[0];return t?P(m.Tuple2(m.chr(t),r.slice(1))):A},append:t(function(r,t){return r+t}),concat:function(r){return N.toArray(r).join("")},length:function(r){return r.length},map:t(function(r,t){for(var e=t.split(""),n=e.length;n--;)e[n]=r(m.chr(e[n]));return e.join("")}),filter:t(function(r,t){return t.split("").map(m.chr).filter(r).join("")}),reverse:function(r){return r.split("").reverse().join("")},foldl:e(function(r,t,e){for(var n=e.length,o=0;o<n;++o)t=_(r,m.chr(e[o]),t);return t}),foldr:e(function(r,t,e){for(var n=e.length;n--;)t=_(r,m.chr(e[n]),t);return t}),split:t(function(r,t){return N.fromArray(t.split(r))}),join:t(function(r,t){return N.toArray(t).join(r)}),repeat:t(r),slice:e(function(r,t,e){return e.slice(r,t)}),left:t(function(r,t){return r<1?"":t.slice(0,r)}),right:t(function(r,t){return r<1?"":t.slice(-r)}),dropLeft:t(function(r,t){return r<1?t:t.slice(r)}),dropRight:t(function(r,t){return r<1?t:t.slice(0,-r)}),pad:e(function(t,e,n){var o=(t-n.length)/2;return r(Math.ceil(o),e)+n+r(0|o,e)}),padLeft:e(function(t,e,n){return r(t-n.length,e)+n}),padRight:e(function(t,e,n){return n+r(t-n.length,e)}),trim:function(r){return r.trim()},trimLeft:function(r){return r.replace(/^\s+/,"")},trimRight:function(r){return r.replace(/\s+$/,"")},words:function(r){return N.fromArray(r.trim().split(/\s+/g))},lines:function(r){return N.fromArray(r.split(/\r\n|\r|\n/g))},toUpper:function(r){return r.toUpperCase()},toLower:function(r){return r.toLowerCase()},any:t(function(r,t){for(var e=t.length;e--;)if(r(m.chr(t[e])))return!0;return!1}),all:t(function(r,t){for(var e=t.length;e--;)if(!r(m.chr(t[e])))return!1;return!0}),contains:t(function(r,t){return t.indexOf(r)>-1}),startsWith:t(function(r,t){return 0===t.indexOf(r)}),endsWith:t(function(r,t){return t.length>=r.length&&t.lastIndexOf(r)===t.length-r.length}),indexes:t(function(r,t){var e=r.length;if(e<1)return N.Nil;for(var n=0,o=[];(n=t.indexOf(r,n))>-1;)o.push(n),n+=e;return N.fromArray(o)}),toInt:function(r){var t=r.length;if(0===t)return n(r);if("0"===(o=r[0])&&"x"===r[1]){for(var e=2;e<t;++e)if(!("0"<=(o=r[e])&&o<="9"||"A"<=o&&o<="F"||"a"<=o&&o<="f"))return n(r);return Ar(parseInt(r,16))}if(o>"9"||o<"0"&&"-"!==o&&"+"!==o)return n(r);for(e=1;e<t;++e){var o;if((o=r[e])<"0"||"9"<o)return n(r)}return Ar(parseInt(r,10))},toFloat:function(r){if(0===r.length||/[\sxbo]/.test(r))return o(r);var t=+r;return t==t?Ar(t):o(r)},toList:function(r){return N.fromArray(r.split("").map(m.chr))},fromList:function(r){return N.toArray(r).join("")}}}(),kr={fromCode:function(r){return m.chr(String.fromCharCode(r))},toCode:function(r){return r.charCodeAt(0)},toUpper:function(r){return m.chr(r.toUpperCase())},toLower:function(r){return m.chr(r.toLowerCase())},toLocaleUpper:function(r){return m.chr(r.toLocaleUpperCase())},toLocaleLower:function(r){return m.chr(r.toLocaleLowerCase())}},xr=kr.toCode,Cr=e(function(r,t,e){var n=xr(e);return m.cmp(n,xr(r))>-1&&m.cmp(n,xr(t))<1}),Fr=(_(Cr,m.chr("A"),m.chr("Z")),_(Cr,m.chr("a"),m.chr("z")),_(Cr,m.chr("0"),m.chr("9")),_(Cr,m.chr("0"),m.chr("7")),function(r){var t=r;return"Ok"===t.ctor?P(t._0):A}),Lr=t(function(r,t){var e=t;return"Ok"===e.ctor?e._0:r}),Rr=function(r){return{ctor:"Err",_0:r}},Ar=(t(function(r,t){var e=t;return"Ok"===e.ctor?r(e._0):Rr(e._0)}),function(r){return{ctor:"Ok",_0:r}}),Mr=(t(function(r,t){var e=t;return"Ok"===e.ctor?Ar(r(e._0)):Rr(e._0)}),e(function(r,t,e){var n={ctor:"_Tuple2",_0:t,_1:e};return"Ok"===n._0.ctor?"Ok"===n._1.ctor?Ar(_(r,n._0._0,n._1._0)):Rr(n._1._0):Rr(n._0._0)}),n(function(r,t,e,n){var o={ctor:"_Tuple3",_0:t,_1:e,_2:n};return"Ok"===o._0.ctor?"Ok"===o._1.ctor?"Ok"===o._2.ctor?Ar(l(r,o._0._0,o._1._0,o._2._0)):Rr(o._2._0):Rr(o._1._0):Rr(o._0._0)}),o(function(r,t,e,n,o){var c={ctor:"_Tuple4",_0:t,_1:e,_2:n,_3:o};return"Ok"===c._0.ctor?"Ok"===c._1.ctor?"Ok"===c._2.ctor?"Ok"===c._3.ctor?Ar(s(r,c._0._0,c._1._0,c._2._0,c._3._0)):Rr(c._3._0):Rr(c._2._0):Rr(c._1._0):Rr(c._0._0)}),c(function(r,t,e,n,o,c){var u={ctor:"_Tuple5",_0:t,_1:e,_2:n,_3:o,_4:c};return"Ok"===u._0.ctor?"Ok"===u._1.ctor?"Ok"===u._2.ctor?"Ok"===u._3.ctor?"Ok"===u._4.ctor?Ar(f(r,u._0._0,u._1._0,u._2._0,u._3._0,u._4._0)):Rr(u._4._0):Rr(u._3._0):Rr(u._2._0):Rr(u._1._0):Rr(u._0._0)}),t(function(r,t){var e=t;return"Ok"===e.ctor?Ar(e._0):Rr(r(e._0))}),t(function(r,t){var e=t;return"Just"===e.ctor?Ar(e._0):Rr(r)}),Sr.fromList),Pr=Sr.toList,Er=Sr.toFloat,Nr=Sr.toInt,Br=(Sr.indexes,Sr.indexes,Sr.endsWith,Sr.startsWith),Or=(Sr.contains,Sr.all,Sr.any,Sr.toLower),zr=(Sr.toUpper,Sr.lines,Sr.words,Sr.trimRight,Sr.trimLeft,Sr.trim,Sr.padRight,Sr.padLeft,Sr.pad,Sr.dropRight,Sr.dropLeft),Ir=(Sr.right,Sr.left,Sr.slice),qr=(Sr.repeat,Sr.join),Vr=(Sr.split,Sr.foldr,Sr.foldl,Sr.reverse,Sr.filter,Sr.map,Sr.length),Dr=Sr.concat,Gr=(Sr.append,Sr.uncons,Sr.cons),Hr=(Sr.isEmpty,e(function(r,t,e){for(;;){var n=e;if("RBEmpty_elm_builtin"===n.ctor)return t;var o=r,c=l(r,n._1,n._2,l(Hr,r,t,n._4));r=o,t=c,e=n._3}})),Jr=function(r){return l(Hr,e(function(r,t,e){return{ctor:"::",_0:r,_1:e}}),{ctor:"[]"},r)},Ur=function(r){return l(Hr,e(function(r,t,e){return{ctor:"::",_0:{ctor:"_Tuple2",_0:r,_1:t},_1:e}}),{ctor:"[]"},r)},Wr=e(function(r,t,e){for(;;){var n=e;if("RBEmpty_elm_builtin"===n.ctor)return t;var o=r,c=l(r,n._1,n._2,l(Wr,r,t,n._3));r=o,t=c,e=n._4}}),jr=c(function(r,n,o,c,u,i){var a=e(function(t,e,c){for(;;){var u=c,i=u._1,a=u._0,_=a;if("[]"===_.ctor)return{ctor:"_Tuple2",_0:a,_1:l(o,t,e,i)};var f=_._1,d=_._0._1,p=_._0._0;if(!(m.cmp(p,t)<0))return m.cmp(p,t)>0?{ctor:"_Tuple2",_0:a,_1:l(o,t,e,i)}:{ctor:"_Tuple2",_0:f,_1:s(n,p,d,e,i)};t=t,e=e,c={ctor:"_Tuple2",_0:f,_1:l(r,p,d,i)}}}),_=l(Wr,a,{ctor:"_Tuple2",_0:Ur(c),_1:i},u),f=_._0,d=_._1;return l(H,t(function(t,e){var n=t;return l(r,n._0,n._1,e)}),d,f)}),Yr=n(function(r,t,e,n){return wr.crash(Dr({ctor:"::",_0:"Internal red-black tree invariant violated, expected ",_1:{ctor:"::",_0:r,_1:{ctor:"::",_0:" and got ",_1:{ctor:"::",_0:y(t),_1:{ctor:"::",_0:"/",_1:{ctor:"::",_0:e,_1:{ctor:"::",_0:"/",_1:{ctor:"::",_0:n,_1:{ctor:"::",_0:"\nPlease report this bug to <https://github.com/elm-lang/core/issues>",_1:{ctor:"[]"}}}}}}}}}}))}),Kr=function(r){var t=r;r:do{if("RBNode_elm_builtin"===t.ctor){if("BBlack"===t._0.ctor)return!0;break r}if("LBBlack"===t._0.ctor)return!0;break r}while(0);return!1},Xr=t(function(r,t){for(;;){var e=t;if("RBEmpty_elm_builtin"===e.ctor)return r;r=_(Xr,r+1,e._4),t=e._3}}),Zr=t(function(r,t){r:for(;;){var e=t;if("RBEmpty_elm_builtin"===e.ctor)return A;switch(_(x,r,e._1).ctor){case"LT":r=r,t=e._3;continue r;case"EQ":return P(e._2);default:r=r,t=e._4;continue r}}}),$r=t(function(r,t){return"Just"===_(Zr,r,t).ctor}),Qr=e(function(r,t,e){for(;;){var n=e;if("RBEmpty_elm_builtin"===n.ctor)return{ctor:"_Tuple2",_0:r,_1:t};r=n._1,t=n._2,e=n._4}}),rt={ctor:"NBlack"},tt={ctor:"BBlack"},et={ctor:"Black"},nt={ctor:"Red"},ot=function(r){switch(r.ctor){case"BBlack":return et;case"Black":return nt;case"Red":return rt;default:return wr.crash("Can't make a negative black node less black!")}},ct={ctor:"LBBlack"},ut={ctor:"LBlack"},it=function(r){return{ctor:"RBEmpty_elm_builtin",_0:r}},at=it(ut),_t=o(function(r,t,e,n,o){return{ctor:"RBNode_elm_builtin",_0:r,_1:t,_2:e,_3:n,_4:o}}),lt=function(r){var t=r;return"RBNode_elm_builtin"===t.ctor?f(_t,ot(t._0),t._1,t._2,t._3,t._4):it(ut)},st=function(r){return function(t){return function(e){return function(n){return function(o){return function(c){return function(u){return function(i){return function(a){return function(_){return function(l){return f(_t,ot(r),n,o,f(_t,et,t,e,i,a),f(_t,et,c,u,_,l))}}}}}}}}}}},ft=function(r){var t=r;return"RBEmpty_elm_builtin"===t.ctor?wr.crash("can't make a Leaf red"):f(_t,nt,t._1,t._2,t._3,t._4)},dt=o(function(r,t,e,n,o){var c=f(_t,r,t,e,n,o);return function(r){var t=r;if("RBNode_elm_builtin"===t.ctor){var e=t._0;return m.eq(e,et)||m.eq(e,tt)}return!0}(c)?function(r){var t=r;r:do{t:do{e:do{n:do{o:do{c:do{u:do{if("RBNode_elm_builtin"!==t.ctor)break r;if("RBNode_elm_builtin"===t._3.ctor)if("RBNode_elm_builtin"===t._4.ctor)switch(t._3._0.ctor){case"Red":switch(t._4._0.ctor){case"Red":if("RBNode_elm_builtin"===t._3._3.ctor&&"Red"===t._3._3._0.ctor)break u;if("RBNode_elm_builtin"===t._3._4.ctor&&"Red"===t._3._4._0.ctor)break c;if("RBNode_elm_builtin"===t._4._3.ctor&&"Red"===t._4._3._0.ctor)break o;if("RBNode_elm_builtin"===t._4._4.ctor&&"Red"===t._4._4._0.ctor)break n;break r;case"NBlack":if("RBNode_elm_builtin"===t._3._3.ctor&&"Red"===t._3._3._0.ctor)break u;if("RBNode_elm_builtin"===t._3._4.ctor&&"Red"===t._3._4._0.ctor)break c;if("BBlack"===t._0.ctor&&"RBNode_elm_builtin"===t._4._3.ctor&&"Black"===t._4._3._0.ctor&&"RBNode_elm_builtin"===t._4._4.ctor&&"Black"===t._4._4._0.ctor)break e;break r;default:if("RBNode_elm_builtin"===t._3._3.ctor&&"Red"===t._3._3._0.ctor)break u;if("RBNode_elm_builtin"===t._3._4.ctor&&"Red"===t._3._4._0.ctor)break c;break r}case"NBlack":switch(t._4._0.ctor){case"Red":if("RBNode_elm_builtin"===t._4._3.ctor&&"Red"===t._4._3._0.ctor)break o;if("RBNode_elm_builtin"===t._4._4.ctor&&"Red"===t._4._4._0.ctor)break n;if("BBlack"===t._0.ctor&&"RBNode_elm_builtin"===t._3._3.ctor&&"Black"===t._3._3._0.ctor&&"RBNode_elm_builtin"===t._3._4.ctor&&"Black"===t._3._4._0.ctor)break t;break r;case"NBlack":if("BBlack"===t._0.ctor){if("RBNode_elm_builtin"===t._4._3.ctor&&"Black"===t._4._3._0.ctor&&"RBNode_elm_builtin"===t._4._4.ctor&&"Black"===t._4._4._0.ctor)break e;if("RBNode_elm_builtin"===t._3._3.ctor&&"Black"===t._3._3._0.ctor&&"RBNode_elm_builtin"===t._3._4.ctor&&"Black"===t._3._4._0.ctor)break t;break r}break r;default:if("BBlack"===t._0.ctor&&"RBNode_elm_builtin"===t._3._3.ctor&&"Black"===t._3._3._0.ctor&&"RBNode_elm_builtin"===t._3._4.ctor&&"Black"===t._3._4._0.ctor)break t;break r}default:switch(t._4._0.ctor){case"Red":if("RBNode_elm_builtin"===t._4._3.ctor&&"Red"===t._4._3._0.ctor)break o;if("RBNode_elm_builtin"===t._4._4.ctor&&"Red"===t._4._4._0.ctor)break n;break r;case"NBlack":if("BBlack"===t._0.ctor&&"RBNode_elm_builtin"===t._4._3.ctor&&"Black"===t._4._3._0.ctor&&"RBNode_elm_builtin"===t._4._4.ctor&&"Black"===t._4._4._0.ctor)break e;break r;default:break r}}else switch(t._3._0.ctor){case"Red":if("RBNode_elm_builtin"===t._3._3.ctor&&"Red"===t._3._3._0.ctor)break u;if("RBNode_elm_builtin"===t._3._4.ctor&&"Red"===t._3._4._0.ctor)break c;break r;case"NBlack":if("BBlack"===t._0.ctor&&"RBNode_elm_builtin"===t._3._3.ctor&&"Black"===t._3._3._0.ctor&&"RBNode_elm_builtin"===t._3._4.ctor&&"Black"===t._3._4._0.ctor)break t;break r;default:break r}else{if("RBNode_elm_builtin"!==t._4.ctor)break r;switch(t._4._0.ctor){case"Red":if("RBNode_elm_builtin"===t._4._3.ctor&&"Red"===t._4._3._0.ctor)break o;if("RBNode_elm_builtin"===t._4._4.ctor&&"Red"===t._4._4._0.ctor)break n;break r;case"NBlack":if("BBlack"===t._0.ctor&&"RBNode_elm_builtin"===t._4._3.ctor&&"Black"===t._4._3._0.ctor&&"RBNode_elm_builtin"===t._4._4.ctor&&"Black"===t._4._4._0.ctor)break e;break r;default:break r}}}while(0);return st(t._0)(t._3._3._1)(t._3._3._2)(t._3._1)(t._3._2)(t._1)(t._2)(t._3._3._3)(t._3._3._4)(t._3._4)(t._4)}while(0);return st(t._0)(t._3._1)(t._3._2)(t._3._4._1)(t._3._4._2)(t._1)(t._2)(t._3._3)(t._3._4._3)(t._3._4._4)(t._4)}while(0);return st(t._0)(t._1)(t._2)(t._4._3._1)(t._4._3._2)(t._4._1)(t._4._2)(t._3)(t._4._3._3)(t._4._3._4)(t._4._4)}while(0);return st(t._0)(t._1)(t._2)(t._4._1)(t._4._2)(t._4._4._1)(t._4._4._2)(t._3)(t._4._3)(t._4._4._3)(t._4._4._4)}while(0);return f(_t,et,t._4._3._1,t._4._3._2,f(_t,et,t._1,t._2,t._3,t._4._3._3),f(dt,et,t._4._1,t._4._2,t._4._3._4,ft(t._4._4)))}while(0);return f(_t,et,t._3._4._1,t._3._4._2,f(dt,et,t._3._1,t._3._2,ft(t._3._3),t._3._4._3),f(_t,et,t._1,t._2,t._3._4._4,t._4))}while(0);return r}(c):c}),pt=o(function(r,t,e,n,o){return Kr(n)||Kr(o)?f(dt,function(r){switch(r.ctor){case"Black":return tt;case"Red":return et;case"NBlack":return nt;default:return wr.crash("Can't make a double black node more black!")}}(r),t,e,lt(n),lt(o)):f(_t,r,t,e,n,o)}),ht=o(function(r,t,e,n,o){var c=o;return"RBEmpty_elm_builtin"===c.ctor?l(mt,r,n,o):f(pt,r,t,e,n,f(ht,c._0,c._1,c._2,c._3,c._4))}),mt=e(function(r,t,e){var n={ctor:"_Tuple2",_0:t,_1:e};if("RBEmpty_elm_builtin"!==n._0.ctor){if("RBEmpty_elm_builtin"===n._1.ctor){var o=n._1._0,c=n._0._0,u={ctor:"_Tuple3",_0:r,_1:c,_2:o};return"_Tuple3"===u.ctor&&"Black"===u._0.ctor&&"Red"===u._1.ctor&&"LBlack"===u._2.ctor?f(_t,et,n._0._1,n._0._2,n._0._3,n._0._4):s(Yr,"Black/Red/LBlack",r,y(c),y(o))}var i=n._0._2,a=n._0._4,_=n._0._1,d=f(ht,n._0._0,_,i,n._0._3,a),p=l(Qr,_,i,a),h=p._0,m=p._1;return f(pt,r,h,m,d,e)}if("RBEmpty_elm_builtin"!==n._1.ctor){var g=n._1._0,v=n._0._0,b={ctor:"_Tuple3",_0:r,_1:v,_2:g};return"_Tuple3"===b.ctor&&"Black"===b._0.ctor&&"LBlack"===b._1.ctor&&"Red"===b._2.ctor?f(_t,et,n._1._1,n._1._2,n._1._3,n._1._4):s(Yr,"Black/LBlack/Red",r,y(v),y(g))}switch(r.ctor){case"Red":return it(ut);case"Black":return it(ct);default:return wr.crash("cannot have bblack or nblack nodes at this point")}}),gt=t(function(r,t){var e=t;if("RBEmpty_elm_builtin"===e.ctor)return it(ut);var n=e._1;return f(_t,e._0,n,_(r,n,e._2),_(gt,r,e._3),_(gt,r,e._4))}),vt={ctor:"Same"},bt={ctor:"Remove"},yt={ctor:"Insert"},Tt=e(function(r,t,e){var n,o=function(e){var n=e;if("RBEmpty_elm_builtin"===n.ctor){var c=t(A);return"Nothing"===c.ctor?{ctor:"_Tuple2",_0:vt,_1:at}:{ctor:"_Tuple2",_0:yt,_1:f(_t,nt,r,c._0,at,at)}}var u=n._2,i=n._4,a=n._3,s=n._1,d=n._0;switch(_(x,r,s).ctor){case"EQ":var p=t(P(u));return"Nothing"===p.ctor?{ctor:"_Tuple2",_0:bt,_1:l(mt,d,a,i)}:{ctor:"_Tuple2",_0:vt,_1:f(_t,d,s,p._0,a,i)};case"LT":var h=o(a),m=h._0,g=h._1;switch(m.ctor){case"Same":return{ctor:"_Tuple2",_0:vt,_1:f(_t,d,s,u,g,i)};case"Insert":return{ctor:"_Tuple2",_0:yt,_1:f(dt,d,s,u,g,i)};default:return{ctor:"_Tuple2",_0:bt,_1:f(pt,d,s,u,g,i)}}default:var v=o(i),b=(m=v._0,v._1);switch(m.ctor){case"Same":return{ctor:"_Tuple2",_0:vt,_1:f(_t,d,s,u,a,b)};case"Insert":return{ctor:"_Tuple2",_0:yt,_1:f(dt,d,s,u,a,b)};default:return{ctor:"_Tuple2",_0:bt,_1:f(pt,d,s,u,a,b)}}}},c=o(e),u=c._0,i=c._1;switch(u.ctor){case"Same":return i;case"Insert":return function(r){var t=r;return"RBNode_elm_builtin"===t.ctor&&"Red"===t._0.ctor?f(_t,et,t._1,t._2,t._3,t._4):r}(i);default:return"RBEmpty_elm_builtin"===(n=i).ctor?it(ut):f(_t,et,n._1,n._2,n._3,n._4)}}),wt=e(function(r,t,e){return l(Tt,r,v(P(t)),e)}),St=(t(function(r,t){return l(wt,r,t,at)}),t(function(r,t){return l(Wr,wt,t,r)})),kt=t(function(r,t){var n=e(function(t,e,n){return _(r,t,e)?l(wt,t,e,n):n});return l(Wr,n,at,t)}),xt=t(function(r,e){return _(kt,t(function(r,t){return _($r,r,e)}),r)}),Ct=t(function(r,t){var n=e(function(t,e,n){var o=n,c=o._1,u=o._0;return _(r,t,e)?{ctor:"_Tuple2",_0:l(wt,t,e,u),_1:c}:{ctor:"_Tuple2",_0:u,_1:l(wt,t,e,c)}});return l(Wr,n,{ctor:"_Tuple2",_0:at,_1:at},t)}),Ft=function(r){return l(H,t(function(r,t){var e=r;return l(wt,e._0,e._1,t)}),at,r)},Lt=t(function(r,t){return l(Tt,r,v(A),t)}),Rt=t(function(r,t){return l(Wr,e(function(r,t,e){return _(Lt,r,e)}),r,t)}),At=function(){function r(r,t){return{ctor:"<decoder>",tag:"map-many",func:r,decoders:t}}function _(r){return{tag:"ok",value:r}}function l(r,t){return{tag:"primitive",type:r,value:t}}function s(r,t){return{tag:"index",index:r,rest:t}}function f(r,t){return{tag:"field",field:r,rest:t}}function s(r,t){return{tag:"index",index:r,rest:t}}function d(r,t){var e=function r(t,e){switch(t.tag){case"bool":return"boolean"==typeof e?_(e):l("a Bool",e);case"int":return"number"!=typeof e?l("an Int",e):-2147483647<e&&e<2147483647&&(0|e)===e?_(e):!isFinite(e)||e%1?l("an Int",e):_(e);case"float":return"number"==typeof e?_(e):l("a Float",e);case"string":return"string"==typeof e?_(e):e instanceof String?_(e+""):l("a String",e);case"null":return null===e?_(t.value):l("null",e);case"value":return _(e);case"list":if(!(e instanceof Array))return l("a List",e);for(var n=N.Nil,o=e.length;o--;){var c=r(t.decoder,e[o]);if("ok"!==c.tag)return s(o,c);n=N.Cons(c.value,n)}return _(n);case"array":if(!(e instanceof Array))return l("an Array",e);for(var u=e.length,i=new Array(u),o=u;o--;){var c=r(t.decoder,e[o]);if("ok"!==c.tag)return s(o,c);i[o]=c.value}return _(p.fromJSArray(i));case"maybe":var c=r(t.decoder,e);return"ok"===c.tag?_(P(c.value)):_(A);case"field":var a=t.field;if("object"!=typeof e||null===e||!(a in e))return l("an object with a field named `"+a+"`",e);var c=r(t.decoder,e[a]);return"ok"===c.tag?c:f(a,c);case"index":var d=t.index;if(!(e instanceof Array))return l("an array",e);if(d>=e.length)return l("a longer array. Need index "+d+" but there are only "+e.length+" entries",e);var c=r(t.decoder,e[d]);return"ok"===c.tag?c:s(d,c);case"key-value":if("object"!=typeof e||null===e||e instanceof Array)return l("an object",e);var h=N.Nil;for(var g in e){var c=r(t.decoder,e[g]);if("ok"!==c.tag)return f(g,c);var v=m.Tuple2(g,c.value);h=N.Cons(v,h)}return _(h);case"map-many":for(var b=t.func,y=t.decoders,o=0;o<y.length;o++){var c=r(y[o],e);if("ok"!==c.tag)return c;b=b(c.value)}return _(b);case"andThen":var c=r(t.decoder,e);return"ok"!==c.tag?c:r(t.callback(c.value),e);case"oneOf":for(var T=[],w=t.decoders;"[]"!==w.ctor;){var c=r(w._0,e);if("ok"===c.tag)return c;T.push(c),w=w._1}return{tag:"oneOf",problems:T};case"fail":return{tag:"fail",msg:t.msg};case"succeed":return _(t.msg)}}(r,t);return"ok"===e.tag?Ar(e.value):Rr(function r(t){for(var e,n="_";t;)switch(t.tag){case"primitive":return"Expecting "+t.type+("_"===n?"":" at "+n)+" but instead got: "+(void 0===(e=t.value)?"undefined":JSON.stringify(e));case"index":n+="["+t.index+"]",t=t.rest;break;case"field":n+="."+t.field,t=t.rest;break;case"oneOf":for(var o=t.problems,c=0;c<o.length;c++)o[c]=r(o[c]);return"I ran into the following problems"+("_"===n?"":" at "+n)+":\n\n"+o.join("\n");case"fail":return"I ran into a `fail` decoder"+("_"===n?"":" at "+n)+": "+t.msg}}(e))}function h(r,t){if(r===t)return!0;if(r.tag!==t.tag)return!1;switch(r.tag){case"succeed":case"fail":return r.msg===t.msg;case"bool":case"int":case"float":case"string":case"value":return!0;case"null":return r.value===t.value;case"list":case"array":case"maybe":case"key-value":return h(r.decoder,t.decoder);case"field":return r.field===t.field&&h(r.decoder,t.decoder);case"index":return r.index===t.index&&h(r.decoder,t.decoder);case"map-many":return r.func===t.func&&g(r.decoders,t.decoders);case"andThen":return r.callback===t.callback&&h(r.decoder,t.decoder);case"oneOf":return g(r.decoders,t.decoders)}}function g(r,t){var e=r.length;if(e!==t.length)return!1;for(var n=0;n<e;n++)if(!h(r[n],t[n]))return!1;return!0}return{encode:t(function(r,t){return JSON.stringify(t,null,r)}),runOnString:t(function(r,t){var e;try{e=JSON.parse(t)}catch(r){return Rr("Given an invalid JSON: "+r.message)}return d(r,e)}),run:t(d),decodeNull:function(r){return{ctor:"<decoder>",tag:"null",value:r}},decodePrimitive:function(r){return{ctor:"<decoder>",tag:r}},decodeContainer:t(function(r,t){return{ctor:"<decoder>",tag:r,decoder:t}}),decodeField:t(function(r,t){return{ctor:"<decoder>",tag:"field",field:r,decoder:t}}),decodeIndex:t(function(r,t){return{ctor:"<decoder>",tag:"index",index:r,decoder:t}}),map1:t(function(t,e){return r(t,[e])}),map2:e(function(t,e,n){return r(t,[e,n])}),map3:n(function(t,e,n,o){return r(t,[e,n,o])}),map4:o(function(t,e,n,o,c){return r(t,[e,n,o,c])}),map5:c(function(t,e,n,o,c,u){return r(t,[e,n,o,c,u])}),map6:u(function(t,e,n,o,c,u,i){return r(t,[e,n,o,c,u,i])}),map7:i(function(t,e,n,o,c,u,i,a){return r(t,[e,n,o,c,u,i,a])}),map8:a(function(t,e,n,o,c,u,i,a,_){return r(t,[e,n,o,c,u,i,a,_])}),decodeKeyValuePairs:function(r){return{ctor:"<decoder>",tag:"key-value",decoder:r}},andThen:t(function(r,t){return{ctor:"<decoder>",tag:"andThen",decoder:t,callback:r}}),fail:function(r){return{ctor:"<decoder>",tag:"fail",msg:r}},succeed:function(r){return{ctor:"<decoder>",tag:"succeed",msg:r}},oneOf:function(r){return{ctor:"<decoder>",tag:"oneOf",decoders:r}},identity:function(r){return r},encodeNull:null,encodeArray:p.toJSArray,encodeList:N.toArray,encodeObject:function(r){for(var t={};"[]"!==r.ctor;){var e=r._0;t[e._0]=e._1,r=r._1}return t},equality:h}}(),Mt=At.encodeList,Pt=At.encodeArray,Et=At.encodeObject,Nt=(At.encodeNull,At.identity),Bt=At.identity,Ot=At.identity,zt=At.identity,It=At.encode,qt=At.decodeNull,Vt=At.decodePrimitive("value"),Dt=At.andThen,Gt=At.fail,Ht=At.succeed,Jt=At.run,Ut=At.runOnString,Wt=(At.map8,At.map7,At.map6,At.map5,At.map4,At.map3,At.map2),jt=At.map1,Yt=At.oneOf,Kt=At.decodeIndex,Xt=At.decodeField,Zt=t(function(r,t){return l(G,Xt,t,r)}),$t=At.decodeKeyValuePairs,Qt=function(r){return _(At.decodeContainer,"list",r)},re=At.decodePrimitive("float"),te=At.decodePrimitive("int"),ee=At.decodePrimitive("bool"),ne=At.decodePrimitive("string"),oe=(wr.crash,wr.log,t(function(r,t){var e=t;return{ctor:"_Tuple2",_0:e._0,_1:r(e._1)}}),t(function(r,t){var e=t;return{ctor:"_Tuple2",_0:r(e._0),_1:e._1}}),function(r){return r._1}),ce=function(r){return r._0},ue=function(){function r(r,t){return function(r){}}function n(r,t,e,n){var i,a={};var l=u(ie.nativeBinding(function(t){var o=r._0;i=n(s,o);var c=r._1,u=e(o);f(a,c,u),t(ie.succeed(o))}),function(r,n){return ie.nativeBinding(function(o){var c=_(t,r,n);n=c._0,i(n);var u=c._1,l=e(n);f(a,u,l),o(ie.succeed(n))})});function s(r){ie.rawSend(l,r)}var d=function(r,t){var e;for(var n in o){var u=o[n];u.isForeign&&((e=e||{})[n]="cmd"===u.tag?g(n):b(n,t)),r[n]=c(u,t)}return e}(a,s);return d?{ports:d}:{}}var o={};function c(r,t){var e={main:t,self:void 0},n=r.tag,o=r.onEffects,c=r.onSelfMsg;var i=u(r.init,function(r,t){if("self"===r.ctor)return l(c,e,r._0,t);var u=r._0;switch(n){case"cmd":return l(o,e,u.cmds,t);case"sub":return l(o,e,u.subs,t);case"fx":return s(o,e,u.cmds,u.subs,t)}});return e.self=i,i}function u(r,t){var e=ie.andThen;var n=_(e,function r(n){var o=ie.receive(function(r){return t(r,n)});return _(e,r,o)},r);return ie.rawSpawn(n)}function i(r){return function(t){return{type:"leaf",home:r,value:t}}}function a(r){return{type:"node",branches:r}}function f(r,t,e){var n={};for(var o in d(!0,t,n,null),d(!1,e,n,null),r){var c=o in n?n[o]:{cmds:N.Nil,subs:N.Nil};ie.rawSend(r[o],{ctor:"fx",_0:c})}}function d(r,t,e,n){switch(t.type){case"leaf":var c=t.home,u=function(r,t,e,n){return _(r?o[t].cmdMap:o[t].subMap,function(r){var t=e;for(;t;)r=t.tagger(r),t=t.rest;return r},n)}(r,c,n,t.value);return void(e[c]=function(r,t,e){if(e=e||{cmds:N.Nil,subs:N.Nil},r)return e.cmds=N.Cons(t,e.cmds),e;return e.subs=N.Cons(t,e.subs),e}(r,u,e[c]));case"node":for(var i=t.branches;"[]"!==i.ctor;)d(r,i._0,e,n),i=i._1;return;case"map":return void d(r,t.tree,e,{tagger:t.tagger,rest:n})}}function p(r){if(r in o)throw new Error("There can only be one port named `"+r+"`, but your program has multiple.")}var h=t(function(r,t){return t});function g(r){var t=[],n=o[r].converter,c=ie.succeed(null);return o[r].init=c,o[r].onEffects=e(function(r,e,o){for(;"[]"!==e.ctor;){for(var u=t,i=n(e._0),a=0;a<u.length;a++)u[a](i);e=e._1}return c}),{subscribe:function(r){t.push(r)},unsubscribe:function(r){var e=(t=t.slice()).indexOf(r);e>=0&&t.splice(e,1)}}}var v=t(function(r,t){return function(e){return r(t(e))}});function b(r,t){var n=[],c=N.Nil,u=o[r].converter,i=function(r,t,e){for(var o=s(r,t,e),c=0;c<n.length;c++)f(n[c]);return n=null,a=f,i=s,o},a=function(r){n.push(r)},l=ie.succeed(null);function s(r,t,e){return c=t,l}function f(r){for(var e=c;"[]"!==e.ctor;)t(e._0(r)),e=e._1}return o[r].init=l,o[r].onEffects=e(function(r,t,e){return i(r,t,e)}),{send:function(t){var e=_(Jt,u,t);if("Err"===e.ctor)throw new Error("Trying to send an unexpected type of value through port `"+r+"`:\n"+e._0);a(e._0)}}}return{sendToApp:t(function(r,t){return ie.nativeBinding(function(e){r.main(t),e(ie.succeed(m.Tuple0))})}),sendToSelf:t(function(r,t){return _(ie.send,r.self,{ctor:"self",_0:t})}),effectManagers:o,outgoingPort:function(r,t){return p(r),o[r]={tag:"cmd",cmdMap:h,converter:t,isForeign:!0},i(r)},incomingPort:function(r,t){return p(r),o[r]={tag:"sub",subMap:v,converter:t,isForeign:!0},i(r)},htmlToProgram:function(r){var e=a(N.Nil),n=m.Tuple2(m.Tuple0,e);return Vn({init:n,view:function(r){return main},update:t(function(r,t){return n}),subscriptions:function(r){return e}})},program:function(t){return function(e){return function(e,o){e.worker=function(e){if(void 0!==e)throw new Error("The `"+o+"` module does not need flags.\nCall "+o+".worker() with no arguments and you should be all set!");return n(t.init,t.update,t.subscriptions,r)}}}},programWithFlags:function(t){return function(e){return function(o,c){o.worker=function(o){if(void 0===e)throw new Error("Are you trying to sneak a Never value into Elm? Trickster!\nIt looks like "+c+".main is defined with `programWithFlags` but has type `Program Never`.\nUse `program` instead if you do not want flags.");var u=_(At.run,e,o);if("Err"===u.ctor)throw new Error(c+".worker(...) was called with an unexpected argument.\nI tried to convert it to an Elm value, but ran into this problem:\n\n"+u._0);return n(t.init(u._0),t.update,t.subscriptions,r)}}}},initialize:n,leaf:i,batch:a,map:t(function(r,t){return{type:"map",tagger:r,tree:t}})}}(),ie=function(){var r=1e4;function e(r){return{ctor:"_Task_succeed",value:r}}function n(r){return{ctor:"_Task_nativeBinding",callback:r,cancel:null}}function o(r){var t={ctor:"_Process",id:m.guid(),root:r,stack:null,mailbox:[]};return _(t),t}function c(r,t){r.mailbox.push(t),_(r)}function u(t,e){for(;t<r;){var n=e.root.ctor;if("_Task_succeed"!==n)if("_Task_fail"!==n)if("_Task_andThen"!==n)if("_Task_onError"!==n){if("_Task_nativeBinding"===n){e.root.cancel=e.root.callback(function(r){e.root=r,_(e)});break}if("_Task_receive"!==n)throw new Error(n);var o=e.mailbox;if(0===o.length)break;e.root=e.root.callback(o.shift()),++t}else e.stack={ctor:"_Task_onError",callback:e.root.callback,rest:e.stack},e.root=e.root.task,++t;else e.stack={ctor:"_Task_andThen",callback:e.root.callback,rest:e.stack},e.root=e.root.task,++t;else{for(;e.stack&&"_Task_andThen"===e.stack.ctor;)e.stack=e.stack.rest;if(null===e.stack)break;e.root=e.stack.callback(e.root.value),e.stack=e.stack.rest,++t}else{for(;e.stack&&"_Task_onError"===e.stack.ctor;)e.stack=e.stack.rest;if(null===e.stack)break;e.root=e.stack.callback(e.root.value),e.stack=e.stack.rest,++t}}return t<r?t+1:(_(e),t)}var i=!1,a=[];function _(r){a.push(r),i||(setTimeout(l,0),i=!0)}function l(){for(var t,e=0;e<r&&(t=a.shift());)t.root&&(e=u(e,t));t?setTimeout(l,0):i=!1}return{succeed:e,fail:function(r){return{ctor:"_Task_fail",value:r}},nativeBinding:n,andThen:t(function(r,t){return{ctor:"_Task_andThen",callback:r,task:t}}),onError:t(function(r,t){return{ctor:"_Task_onError",callback:r,task:t}}),receive:function(r){return{ctor:"_Task_receive",callback:r}},spawn:function(r){return n(function(t){t(e(o(r)))})},kill:function(r){return n(function(t){var n=r.root;"_Task_nativeBinding"===n.ctor&&n.cancel&&n.cancel(),r.root=null,t(e(m.Tuple0))})},sleep:function(r){return n(function(t){var n=setTimeout(function(){t(e(m.Tuple0))},r);return function(){clearTimeout(n)}})},send:t(function(r,t){return n(function(n){c(r,t),n(e(m.Tuple0))})}),rawSpawn:o,rawSend:c}}(),ae=ue.batch,_e=ae({ctor:"[]"}),le=le||{};le["!"]=t(function(r,t){return{ctor:"_Tuple2",_0:r,_1:ae(t)}});ue.map;var se,fe,de=ue.batch,pe=de({ctor:"[]"}),he=(ue.map,ie.succeed,ue.sendToSelf),me=ue.sendToApp,ge=(ue.programWithFlags,ue.program,Ht),ve=(Dt(b),t(function(r,e){return l(Wt,t(function(r,t){return r(t)}),e,r)})),be=e(function(r,t,e){return _(Dt,function(n){var o=_(Jt,r,n);if("Ok"===o.ctor){var c=_(Jt,Yt({ctor:"::",_0:t,_1:{ctor:"::",_0:qt(e),_1:{ctor:"[]"}}}),o._0);return"Ok"===c.ctor?Ht(c._0):Gt(c._0)}var u=_(Jt,$t(Vt),n);return"Ok"===u.ctor?Ht(e):Gt(u._0)},Vt)}),ye=(n(function(r,t,e,n){return _(ve,l(be,_(Zt,r,Vt),t,e),n)}),n(function(r,t,e,n){return _(ve,l(be,_(Xt,r,Vt),t,e),n)}),e(function(r,t,e){return _(ve,_(Zt,r,t),e)}),e(function(r,t,e){return _(ve,_(Xt,r,t),e)})),Te=function(){var r=Float64Array;var o={};o._temp1=new r(3),o._temp2=new r(3),o._temp3=new r(3),r==Array?(o.x=[1,0,0],o.y=[0,1,0],o.z=[0,0,1],o.$=function(r,t,e){return[r,t,e]}):(o.x=new r([1,0,0]),o.y=new r([0,1,0]),o.z=new r([0,0,1]),o.$=function(t,e,n){return new r([t,e,n])}),o.u=o.x,o.v=o.y,o.getX=function(r){return r[0]},o.getY=function(r){return r[1]},o.getZ=function(r){return r[2]},o.setX=function(t,e){return new r([t,e[1],e[2]])},o.setY=function(t,e){return new r([e[0],t,e[2]])},o.setZ=function(t,e){return new r([e[0],e[1],t])},o.toTuple3=function(r){return{ctor:"_Tuple3",_0:r[0],_1:r[1],_2:r[2]}},o.fromTuple3=function(t){return new r([t._0,t._1,t._2])},o.toRecord3=function(r){return{_:{},x:r[0],y:r[1],z:r[2]}},o.fromRecord3=function(t){return new r([t.x,t.y,t.z])},o.add=function(t,e,n){return null==n&&(n=new r(3)),n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n},o.sub=function(t,e,n){return null==n&&(n=new r(3)),n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n},o.neg=function(t,e){return null==e&&(e=new r(3)),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},o.direction=function(t,e,n){return null==n&&(n=new r(3)),o.normalize(o.sub(t,e,n),n)},o.length=function(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2])},o.lengthSquared=function(r){return r[0]*r[0]+r[1]*r[1]+r[2]*r[2]},o.distance=function(r,t){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2];return Math.sqrt(e*e+n*n+o*o)},o.distanceSquared=function(r,t){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2];return e*e+n*n+o*o},o.normalize=function(t,e){null==e&&(e=new r(3));var n=1/o.length(t);return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e},o.scale=function(t,e,n){return null==n&&(n=new r(3)),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n},o.dot=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]},o.cross=function(t,e,n){return null==n&&(n=new r(3)),n[0]=t[1]*e[2]-t[2]*e[1],n[1]=t[2]*e[0]-t[0]*e[2],n[2]=t[0]*e[1]-t[1]*e[0],n},o.mul4x4=function(t,e,n){var c,u=o._temp1;return null==n&&(n=new r(3)),u[0]=t[3],u[1]=t[7],u[2]=t[11],c=o.dot(e,u)+t[15],u[0]=t[0],u[1]=t[4],u[2]=t[8],n[0]=(o.dot(e,u)+t[12])/c,u[0]=t[1],u[1]=t[5],u[2]=t[9],n[1]=(o.dot(e,u)+t[13])/c,u[0]=t[2],u[1]=t[6],u[2]=t[10],n[2]=(o.dot(e,u)+t[14])/c,n};var u={};return u._temp1=new r(16),u._temp2=new r(16),r==Array?(u.I=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],u.$=function(r,t,e,n,o,c,u,i,a,_,l,s,f,d,p,h){return[r,t,e,n,o,c,u,i,a,_,l,s,f,d,p,h]}):(u.I=new r([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),u.$=function(t,e,n,o,c,u,i,a,_,l,s,f,d,p,h,m){return new r([t,e,n,o,c,u,i,a,_,l,s,f,d,p,h,m])}),u.identity=u.I,u.fromList=function(r){var t=N.toArray(r);return 16===t.length?P(u.$(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])):A},u.fromRecord=function(t){return new r([t.m11,t.m21,t.m31,t.m41,t.m12,t.m22,t.m32,t.m42,t.m13,t.m23,t.m33,t.m43,t.m14,t.m24,t.m34,t.m44])},u.toRecord=function(r){return{m11:r[0],m21:r[1],m31:r[2],m41:r[3],m12:r[4],m22:r[5],m32:r[6],m42:r[7],m13:r[8],m23:r[9],m33:r[10],m43:r[11],m14:r[12],m24:r[13],m34:r[14],m44:r[15]}},u.topLeft3x3=function(t,e){return null==e&&(e=new r(9)),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},u.inverse=function(t,e){null==e&&(e=new r(16)),e[0]=t[5]*t[10]*t[15]-t[5]*t[11]*t[14]-t[9]*t[6]*t[15]+t[9]*t[7]*t[14]+t[13]*t[6]*t[11]-t[13]*t[7]*t[10],e[4]=-t[4]*t[10]*t[15]+t[4]*t[11]*t[14]+t[8]*t[6]*t[15]-t[8]*t[7]*t[14]-t[12]*t[6]*t[11]+t[12]*t[7]*t[10],e[8]=t[4]*t[9]*t[15]-t[4]*t[11]*t[13]-t[8]*t[5]*t[15]+t[8]*t[7]*t[13]+t[12]*t[5]*t[11]-t[12]*t[7]*t[9],e[12]=-t[4]*t[9]*t[14]+t[4]*t[10]*t[13]+t[8]*t[5]*t[14]-t[8]*t[6]*t[13]-t[12]*t[5]*t[10]+t[12]*t[6]*t[9],e[1]=-t[1]*t[10]*t[15]+t[1]*t[11]*t[14]+t[9]*t[2]*t[15]-t[9]*t[3]*t[14]-t[13]*t[2]*t[11]+t[13]*t[3]*t[10],e[5]=t[0]*t[10]*t[15]-t[0]*t[11]*t[14]-t[8]*t[2]*t[15]+t[8]*t[3]*t[14]+t[12]*t[2]*t[11]-t[12]*t[3]*t[10],e[9]=-t[0]*t[9]*t[15]+t[0]*t[11]*t[13]+t[8]*t[1]*t[15]-t[8]*t[3]*t[13]-t[12]*t[1]*t[11]+t[12]*t[3]*t[9],e[13]=t[0]*t[9]*t[14]-t[0]*t[10]*t[13]-t[8]*t[1]*t[14]+t[8]*t[2]*t[13]+t[12]*t[1]*t[10]-t[12]*t[2]*t[9],e[2]=t[1]*t[6]*t[15]-t[1]*t[7]*t[14]-t[5]*t[2]*t[15]+t[5]*t[3]*t[14]+t[13]*t[2]*t[7]-t[13]*t[3]*t[6],e[6]=-t[0]*t[6]*t[15]+t[0]*t[7]*t[14]+t[4]*t[2]*t[15]-t[4]*t[3]*t[14]-t[12]*t[2]*t[7]+t[12]*t[3]*t[6],e[10]=t[0]*t[5]*t[15]-t[0]*t[7]*t[13]-t[4]*t[1]*t[15]+t[4]*t[3]*t[13]+t[12]*t[1]*t[7]-t[12]*t[3]*t[5],e[14]=-t[0]*t[5]*t[14]+t[0]*t[6]*t[13]+t[4]*t[1]*t[14]-t[4]*t[2]*t[13]-t[12]*t[1]*t[6]+t[12]*t[2]*t[5],e[3]=-t[1]*t[6]*t[11]+t[1]*t[7]*t[10]+t[5]*t[2]*t[11]-t[5]*t[3]*t[10]-t[9]*t[2]*t[7]+t[9]*t[3]*t[6],e[7]=t[0]*t[6]*t[11]-t[0]*t[7]*t[10]-t[4]*t[2]*t[11]+t[4]*t[3]*t[10]+t[8]*t[2]*t[7]-t[8]*t[3]*t[6],e[11]=-t[0]*t[5]*t[11]+t[0]*t[7]*t[9]+t[4]*t[1]*t[11]-t[4]*t[3]*t[9]-t[8]*t[1]*t[7]+t[8]*t[3]*t[5],e[15]=t[0]*t[5]*t[10]-t[0]*t[6]*t[9]-t[4]*t[1]*t[10]+t[4]*t[2]*t[9]+t[8]*t[1]*t[6]-t[8]*t[2]*t[5];var n=t[0]*e[0]+t[1]*e[4]+t[2]*e[8]+t[3]*e[12];if(0===n)return A;n=1/n;for(var o=0;o<16;o+=1)e[o]=e[o]*n;return P(e)},u.inverseOrthonormal=function(t,e){null==e&&(e=new r(16)),u.transpose(t,e);var n=[t[12],t[13],t[14]];return e[3]=e[7]=e[11]=0,e[12]=-o.dot([e[0],e[4],e[8]],n),e[13]=-o.dot([e[1],e[5],e[9]],n),e[14]=-o.dot([e[2],e[6],e[10]],n),e},u.inverseTo3x3=function(t,e){null==e&&(e=new r(9));var n=t[10]*t[5]-t[6]*t[9],o=-t[10]*t[1]+t[2]*t[9],c=t[6]*t[1]-t[2]*t[5],u=-t[10]*t[4]+t[6]*t[8],i=t[10]*t[0]-t[2]*t[8],a=-t[6]*t[0]+t[2]*t[4],_=t[9]*t[4]-t[5]*t[8],l=-t[9]*t[0]+t[1]*t[8],s=t[5]*t[0]-t[1]*t[4],f=t[0]*n+t[1]*u+t[2]*_;if(0==f)throw"matrix not invertible";var d=1/f;return e[0]=d*n,e[1]=d*o,e[2]=d*c,e[3]=d*u,e[4]=d*i,e[5]=d*a,e[6]=d*_,e[7]=d*l,e[8]=d*s,e},u.makeFrustum=function(t,e,n,o,c,u,i){null==i&&(i=new r(16));return i[0]=2*c/(e-t),i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*c/(o-n),i[6]=0,i[7]=0,i[8]=(e+t)/(e-t),i[9]=(o+n)/(o-n),i[10]=-(u+c)/(u-c),i[11]=-1,i[12]=0,i[13]=0,i[14]=-2*u*c/(u-c),i[15]=0,i},u.makePerspective=function(r,t,e,n,o){var c=e*Math.tan(r*Math.PI/360),i=-c,a=i*t,_=c*t;return u.makeFrustum(a,_,i,c,e,n,o)},u.makeOrtho=function(t,e,n,o,c,u,i){null==i&&(i=new r(16));return i[0]=2/(e-t),i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2/(o-n),i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=-2/(u-c),i[11]=0,i[12]=-(e+t)/(e-t),i[13]=-(o+n)/(o-n),i[14]=-(u+c)/(u-c),i[15]=1,i},u.makeOrtho2D=function(r,t,e,n,o){return u.makeOrtho(r,t,e,n,-1,1,o)},u.mul=function(t,e,n){null==n&&(n=new r(16));var o=t[0],c=t[1],u=t[2],i=t[3],a=t[4],_=t[5],l=t[6],s=t[7],f=t[8],d=t[9],p=t[10],h=t[11],m=t[12],g=t[13],v=t[14],b=t[15],y=e[0],T=e[1],w=e[2],S=e[3],k=e[4],x=e[5],C=e[6],F=e[7],L=e[8],R=e[9],A=e[10],M=e[11],P=e[12],E=e[13],N=e[14],B=e[15];return n[0]=o*y+a*T+f*w+m*S,n[1]=c*y+_*T+d*w+g*S,n[2]=u*y+l*T+p*w+v*S,n[3]=i*y+s*T+h*w+b*S,n[4]=o*k+a*x+f*C+m*F,n[5]=c*k+_*x+d*C+g*F,n[6]=u*k+l*x+p*C+v*F,n[7]=i*k+s*x+h*C+b*F,n[8]=o*L+a*R+f*A+m*M,n[9]=c*L+_*R+d*A+g*M,n[10]=u*L+l*R+p*A+v*M,n[11]=i*L+s*R+h*A+b*M,n[12]=o*P+a*E+f*N+m*B,n[13]=c*P+_*E+d*N+g*B,n[14]=u*P+l*E+p*N+v*B,n[15]=i*P+s*E+h*N+b*B,n},u.mulAffine=function(t,e,n){null==n&&(n=new r(16));var o=t[0],c=t[1],u=t[2],i=t[4],a=t[5],_=t[6],l=t[8],s=t[9],f=t[10],d=t[12],p=t[13],h=t[14],m=e[0],g=e[1],v=e[2],b=e[4],y=e[5],T=e[6],w=e[8],S=e[9],k=e[10],x=e[12],C=e[13],F=e[14];return n[0]=o*m+i*g+l*v,n[1]=c*m+a*g+s*v,n[2]=u*m+_*g+f*v,n[3]=0,n[4]=o*b+i*y+l*T,n[5]=c*b+a*y+s*T,n[6]=u*b+_*y+f*T,n[7]=0,n[8]=o*w+i*S+l*k,n[9]=c*w+a*S+s*k,n[10]=u*w+_*S+f*k,n[11]=0,n[12]=o*x+i*C+l*F+d,n[13]=c*x+a*C+s*F+p,n[14]=u*x+_*C+f*F+h,n[15]=1,n},u.makeRotate=function(t,e,n){null==n&&(n=new r(16));var c=(e=o.normalize(e,o._temp1))[0],u=e[1],i=e[2],a=Math.cos(t),_=1-a,l=Math.sin(t);return n[0]=c*c*_+a,n[1]=u*c*_+i*l,n[2]=i*c*_-u*l,n[3]=0,n[4]=c*u*_-i*l,n[5]=u*u*_+a,n[6]=u*i*_+c*l,n[7]=0,n[8]=c*i*_+u*l,n[9]=u*i*_-c*l,n[10]=i*i*_+a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},u.rotate=function(t,e,n,o){null==o&&(o=new r(16));var c=e[0],u=e[1],i=e[2],a=Math.sqrt(c*c+u*u+i*i),_=c,l=u,s=i;if(1!=a){var f=1/a;_*=f,l*=f,s*=f}var d=Math.cos(t),p=1-d,h=Math.sin(t),m=_*h,g=l*h,v=s*h,b=_*l*p,y=_*s*p,T=l*s*p,w=n[0],S=n[1],k=n[2],x=n[3],C=n[4],F=n[5],L=n[6],R=n[7],A=n[8],M=n[9],P=n[10],E=n[11],N=_*_*p+d,B=b+v,O=y-g,z=b-v,I=l*l*p+d,q=T+m,V=y+g,D=T-m,G=s*s*p+d;return o[0]=w*N+C*B+A*O,o[1]=S*N+F*B+M*O,o[2]=k*N+L*B+P*O,o[3]=x*N+R*B+E*O,o[4]=w*z+C*I+A*q,o[5]=S*z+F*I+M*q,o[6]=k*z+L*I+P*q,o[7]=x*z+R*I+E*q,o[8]=w*V+C*D+A*G,o[9]=S*V+F*D+M*G,o[10]=k*V+L*D+P*G,o[11]=x*V+R*D+E*G,o!=n&&(o[12]=n[12],o[13]=n[13],o[14]=n[14],o[15]=n[15]),o},u.makeScale3=function(t,e,n,o){return null==o&&(o=new r(16)),o[0]=t,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=e,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=n,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},u.makeScale1=function(r,t){return u.makeScale3(r,r,r,t)},u.makeScale=function(r,t){return u.makeScale3(r[0],r[1],r[2],t)},u.scale3=function(t,e,n,o,c){return c==o?(o[0]*=t,o[1]*=t,o[2]*=t,o[3]*=t,o[4]*=e,o[5]*=e,o[6]*=e,o[7]*=e,o[8]*=n,o[9]*=n,o[10]*=n,o[11]*=n,o):(null==c&&(c=new r(16)),c[0]=o[0]*t,c[1]=o[1]*t,c[2]=o[2]*t,c[3]=o[3]*t,c[4]=o[4]*e,c[5]=o[5]*e,c[6]=o[6]*e,c[7]=o[7]*e,c[8]=o[8]*n,c[9]=o[9]*n,c[10]=o[10]*n,c[11]=o[11]*n,c[12]=o[12],c[13]=o[13],c[14]=o[14],c[15]=o[15],c)},u.scale1=function(t,e,n){return n==e?(e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e[4]*=t,e[5]*=t,e[6]*=t,e[7]*=t,e[8]*=t,e[9]*=t,e[10]*=t,e[11]*=t,e):(null==n&&(n=new r(16)),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11]*t,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n)},u.scale=function(t,e,n){var o=t[0],c=t[1],u=t[2];return n==e?(e[0]*=o,e[1]*=o,e[2]*=o,e[3]*=o,e[4]*=c,e[5]*=c,e[6]*=c,e[7]*=c,e[8]*=u,e[9]*=u,e[10]*=u,e[11]*=u,e):(null==n&&(n=new r(16)),n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3]*o,n[4]=e[4]*c,n[5]=e[5]*c,n[6]=e[6]*c,n[7]=e[7]*c,n[8]=e[8]*u,n[9]=e[9]*u,n[10]=e[10]*u,n[11]=e[11]*u,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n)},u.makeTranslate3=function(t,e,n,o){return null==o&&(o=new r(16)),o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=t,o[13]=e,o[14]=n,o[15]=1,o},u.makeTranslate1=function(r,t){return u.makeTranslate3(r,r,r,t)},u.makeTranslate=function(r,t){return u.makeTranslate3(r[0],r[1],r[2],t)},u.translate3Self=function(r,t,e,n){return n[12]+=n[0]*r+n[4]*t+n[8]*e,n[13]+=n[1]*r+n[5]*t+n[9]*e,n[14]+=n[2]*r+n[6]*t+n[10]*e,n[15]+=n[3]*r+n[7]*t+n[11]*e,n},u.translate3=function(t,e,n,o,c){if(c==o)return o[12]+=o[0]*t+o[4]*e+o[8]*n,o[13]+=o[1]*t+o[5]*e+o[9]*n,o[14]+=o[2]*t+o[6]*e+o[10]*n,o[15]+=o[3]*t+o[7]*e+o[11]*n,o;null==c&&(c=new r(16));var u=o[0],i=o[1],a=o[2],_=o[3],l=o[4],s=o[5],f=o[6],d=o[7],p=o[8],h=o[9],m=o[10],g=o[11];return c[0]=u,c[1]=i,c[2]=a,c[3]=_,c[4]=l,c[5]=s,c[6]=f,c[7]=d,c[8]=p,c[9]=h,c[10]=m,c[11]=g,c[12]=u*t+l*e+p*n+o[12],c[13]=i*t+s*e+h*n+o[13],c[14]=a*t+f*e+m*n+o[14],c[15]=_*t+d*e+g*n+o[15],c},u.translate1=function(r,t,e){return u.translate3(r,r,r,t,e)},u.translateSelf=function(r,t){var e=r[0],n=r[1],o=r[2];return t[12]+=t[0]*e+t[4]*n+t[8]*o,t[13]+=t[1]*e+t[5]*n+t[9]*o,t[14]+=t[2]*e+t[6]*n+t[10]*o,t[15]+=t[3]*e+t[7]*n+t[11]*o,t},u.translate=function(t,e,n){var o=t[0],c=t[1],u=t[2];if(n==e)return e[12]+=e[0]*o+e[4]*c+e[8]*u,e[13]+=e[1]*o+e[5]*c+e[9]*u,e[14]+=e[2]*o+e[6]*c+e[10]*u,e[15]+=e[3]*o+e[7]*c+e[11]*u,e;null==n&&(n=new r(16));var i=e[0],a=e[1],_=e[2],l=e[3],s=e[4],f=e[5],d=e[6],p=e[7],h=e[8],m=e[9],g=e[10],v=e[11];return n[0]=i,n[1]=a,n[2]=_,n[3]=l,n[4]=s,n[5]=f,n[6]=d,n[7]=p,n[8]=h,n[9]=m,n[10]=g,n[11]=v,n[12]=i*o+s*c+h*u+e[12],n[13]=a*o+f*c+m*u+e[13],n[14]=_*o+d*c+g*u+e[14],n[15]=l*o+p*c+v*u+e[15],n},u.makeLookAt=function(t,e,n,c){var i=o.direction(t,e,o._temp1),a=o.normalize(o.cross(n,i,o._temp2),o._temp2),_=o.normalize(o.cross(i,a,o._temp3),o._temp3),l=u._temp1,s=u._temp2;return l[0]=a[0],l[1]=_[0],l[2]=i[0],l[3]=0,l[4]=a[1],l[5]=_[1],l[6]=i[1],l[7]=0,l[8]=a[2],l[9]=_[2],l[10]=i[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=-t[0],s[13]=-t[1],s[14]=-t[2],s[15]=1,null==c&&(c=new r(16)),u.mul(l,s,c)},u.transposeSelf=function(r){var t=r[1];return r[1]=r[4],r[4]=t,t=r[2],r[2]=r[8],r[8]=t,t=r[3],r[3]=r[12],r[12]=t,t=r[6],r[6]=r[9],r[9]=t,t=r[7],r[7]=r[13],r[13]=t,t=r[11],r[11]=r[14],r[14]=t,r},u.transpose=function(t,e){if(t==e){var n=0;return n=t[1],t[1]=t[4],t[4]=n,n=t[2],t[2]=t[8],t[8]=n,n=t[3],t[3]=t[12],t[12]=n,n=t[6],t[6]=t[9],t[9]=n,n=t[7],t[7]=t[13],t[13]=n,n=t[11],t[11]=t[14],t[14]=n,t}return null==e&&(e=new r(16)),e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15],e},u.transformPoint=function(t,e,n){null==n&&(n=new r(3));var o=e[0],c=e[1],u=e[2];n[0]=t[0]*o+t[4]*c+t[8]*u+t[12],n[1]=t[1]*o+t[5]*c+t[9]*u+t[13],n[2]=t[2]*o+t[6]*c+t[10]*u+t[14];var i=t[3]*o+t[7]*c+t[11]*u+t[15];return 1!=i&&(n[0]/=i,n[1]/=i,n[2]/=i),n},u.transformLine=function(t,e,n){null==n&&(n=new r(3));var o=e[0],c=e[1],u=e[2];n[0]=t[0]*o+t[4]*c+t[8]*u,n[1]=t[1]*o+t[5]*c+t[9]*u,n[2]=t[2]*o+t[6]*c+t[10]*u;var i=t[3]*o+t[7]*c+t[11]*u;return 1!=i&&(n[0]/=i,n[1]/=i,n[2]/=i),n},u.transformPointAffine=function(t,e,n){null==n&&(n=new r(3));var o=e[0],c=e[1],u=e[2];return n[0]=t[0]*o+t[4]*c+t[8]*u+t[12],n[1]=t[1]*o+t[5]*c+t[9]*u+t[13],n[2]=t[2]*o+t[6]*c+t[10]*u+t[14],n},u.transformLineAffine=function(t,e,n){null==n&&(n=new r(3));var o=e[0],c=e[1],u=e[2];return n[0]=t[0]*o+t[4]*c+t[8]*u,n[1]=t[1]*o+t[5]*c+t[9]*u,n[2]=t[2]*o+t[6]*c+t[10]*u,n},u.makeBasis=function(t,e,n){var o=new r(16);return o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=0,o[4]=e[0],o[5]=e[1],o[6]=e[2],o[7]=0,o[8]=n[0],o[9]=n[1],o[10]=n[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},{vec3:e(o.$),v3getX:o.getX,v3getY:o.getY,v3getZ:o.getZ,v3setX:t(o.setX),v3setY:t(o.setY),v3setZ:t(o.setZ),toTuple3:o.toTuple3,toRecord3:o.toRecord3,fromTuple3:o.fromTuple3,fromRecord3:o.fromRecord3,v3add:t(o.add),v3sub:t(o.sub),v3neg:o.neg,v3direction:t(o.direction),v3length:o.length,v3lengthSquared:o.lengthSquared,v3distance:t(o.distance),v3distanceSquared:t(o.distanceSquared),v3normalize:o.normalize,v3scale:t(o.scale),v3dot:t(o.dot),v3cross:t(o.cross),v3mul4x4:t(o.mul4x4),m4x4fromList:u.fromList,m4x4fromRecord:u.fromRecord,m4x4toRecord:u.toRecord,m4x4identity:u.identity,m4x4topLeft3x3:u.topLeft3x3,m4x4inverse:u.inverse,m4x4inverseOrthonormal:u.inverseOrthonormal,m4x4inverseTo3x3:u.inverseTo3x3,m4x4makeFrustum:c(u.makeFrustum),m4x4makePerspective:n(u.makePerspective),m4x4makeOrtho:c(u.makeOrtho),m4x4makeOrtho2D:n(u.makeOrtho2D),m4x4mul:t(u.mul),m4x4mulAffine:t(u.mulAffine),m4x4makeRotate:t(u.makeRotate),m4x4rotate:e(u.rotate),m4x4makeScale3:e(u.makeScale3),m4x4makeScale1:u.makeScale1,m4x4makeScale:u.makeScale,m4x4scale3:n(u.scale3),m4x4scale:t(u.scale),m4x4makeTranslate3:e(u.makeTranslate3),m4x4makeTranslate:u.makeTranslate,m4x4translate3:n(u.translate3),m4x4translate:t(u.translate),m4x4makeLookAt:e(u.makeLookAt),m4x4transpose:u.transpose,m4x4transformPoint:t(u.transformPoint),m4x4makeBasis:e(u.makeBasis)}}(),we=Te.v3cross,Se=(Te.v3dot,Te.v3scale),ke=Te.v3normalize,xe=(Te.v3distanceSquared,Te.v3distance,Te.v3lengthSquared,Te.v3length,Te.v3direction),Ce=(Te.v3neg,Te.v3sub,Te.v3add),Fe=(Te.fromRecord3,Te.fromTuple3),Le=(Te.toRecord3,Te.toTuple3,Te.v3setZ,Te.v3setY,Te.v3setX,Te.v3getZ),Re=Te.v3getY,Ae=Te.v3getX,Me=(l(Te.vec3,0,0,1),l(Te.vec3,0,1,0)),Pe=l(Te.vec3,1,0,0),Ee=Te.vec3,Ne=Te.m4x4fromRecord,Be=(Te.m4x4toRecord,Te.m4x4fromList,Te.m4x4makeBasis,Te.m4x4transpose),Oe=Te.m4x4makeLookAt,ze=(Te.m4x4translate,Te.m4x4translate3,Te.m4x4makeTranslate),Ie=(Te.m4x4makeTranslate3,Te.m4x4scale,Te.m4x4scale3,Te.m4x4makeScale,Te.m4x4makeScale3,Te.m4x4rotate,Te.m4x4makeRotate),qe=(Te.m4x4mulAffine,Te.m4x4mul),Ve=(Te.m4x4makeOrtho2D,Te.m4x4makeOrtho,Te.m4x4makePerspective),De=(Te.m4x4makeFrustum,Te.m4x4inverseOrthonormal,Te.m4x4inverse,Te.m4x4identity),Ge=Te.v3mul4x4,He=(se=Float32Array,fe={},se==Array?fe.$=function(r,t){return[r,t]}:fe.$=function(r,t){return new se([r,t])},fe.getX=function(r){return r[0]},fe.getY=function(r){return r[1]},fe.setX=function(r,t){return new se([r,t[1]])},fe.setY=function(r,t){return new se([t[0],r])},fe.toTuple=function(r){return{ctor:"_Tuple2",_0:r[0],_1:r[1]}},fe.fromTuple=function(r){return new se([r._0,r._1])},fe.toRecord=function(r){return{_:{},x:r[0],y:r[1]}},fe.fromRecord=function(r){return new se([r.x,r.y])},fe.add=function(r,t){var e=new se(2);return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e},fe.sub=function(r,t){var e=new se(2);return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e},fe.neg=function(r){var t=new se(2);return t[0]=-r[0],t[1]=-r[1],t},fe.direction=function(r,t){var e=new se(2);e[0]=r[0]-t[0],e[1]=r[1]-t[1];var n=1/fe.length(e);return e[0]=e[0]*n,e[1]=e[1]*n,e},fe.length=function(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])},fe.lengthSquared=function(r){return r[0]*r[0]+r[1]*r[1]},fe.distance=function(r,t){var e=r[0]-t[0],n=r[1]-t[1];return Math.sqrt(e*e+n*n)},fe.distanceSquared=function(r,t){var e=r[0]-t[0],n=r[1]-t[1];return e*e+n*n},fe.normalize=function(r){var t=new se(2),e=1/fe.length(r);return t[0]=r[0]*e,t[1]=r[1]*e,t},fe.scale=function(r,t){var e=new se(2);return e[0]=t[0]*r,e[1]=t[1]*r,e},fe.dot=function(r,t){return r[0]*t[0]+r[1]*t[1]},{vec2:t(fe.$),getX:fe.getX,getY:fe.getY,setX:t(fe.setX),setY:t(fe.setY),toTuple:fe.toTuple,toRecord:fe.toRecord,fromTuple:fe.fromTuple,fromRecord:fe.fromRecord,add:t(fe.add),sub:t(fe.sub),neg:fe.neg,direction:t(fe.direction),length:fe.length,lengthSquared:fe.lengthSquared,distance:t(fe.distance),distanceSquared:t(fe.distanceSquared),normalize:fe.normalize,scale:t(fe.scale),dot:t(fe.dot)}),Je=He.getY,Ue=He.getX,We=He.vec2,je=function(){var r=Float32Array,e={};return r==Array?e.$=function(r,t,e,n){return[r,t,e,n]}:e.$=function(t,e,n,o){return new r([t,e,n,o])},e.getX=function(r){return r[0]},e.getY=function(r){return r[1]},e.getZ=function(r){return r[2]},e.getW=function(r){return r[3]},e.setX=function(t,e){return new r([t,e[1],e[2],e[3]])},e.setY=function(t,e){return new r([e[0],t,e[2],e[3]])},e.setZ=function(t,e){return new r([e[0],e[1],t,e[3]])},e.setW=function(t,e){return new r([e[0],e[1],e[2],t])},e.toTuple=function(r){return{ctor:"_Tuple4",_0:r[0],_1:r[1],_2:r[2],_3:r[3]}},e.fromTuple=function(t){return new r([t._0,t._1,t._2,t._3])},e.toRecord=function(r){return{_:{},x:r[0],y:r[1],z:r[2],w:r[3]}},e.fromRecord=function(t){return new r([t.x,t.y,t.z,t.w])},e.add=function(t,e){var n=new r(4);return n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n[3]=t[3]+e[3],n},e.sub=function(t,e){var n=new r(4);return n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n[3]=t[3]-e[3],n},e.neg=function(t){var e=new r(4);return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},e.direction=function(t,n){var o=new r(4);o[0]=t[0]-n[0],o[1]=t[1]-n[1],o[2]=t[2]-n[2],o[3]=t[3]-n[3];var c=1/e.length(o);return o[0]=o[0]*c,o[1]=o[1]*c,o[2]=o[2]*c,o[3]=o[3]*c,o},e.length=function(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]+r[3]*r[3])},e.lengthSquared=function(r){return r[0]*r[0]+r[1]*r[1]+r[2]*r[2]+r[3]*r[3]},e.distance=function(r,t){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2],c=r[3]-t[3];return Math.sqrt(e*e+n*n+o*o+c*c)},e.distanceSquared=function(r,t){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2],c=r[3]-t[3];return e*e+n*n+o*o+c*c},e.normalize=function(t){var n=new r(4),o=1/e.length(t);return n[0]=t[0]*o,n[1]=t[1]*o,n[2]=t[2]*o,n[3]=t[3]*o,n},e.scale=function(t,e){var n=new r(4);return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n},e.dot=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]*t[3]},{vec4:n(e.$),getX:e.getX,getY:e.getY,getZ:e.getZ,getW:e.getW,setX:t(e.setX),setY:t(e.setY),setZ:t(e.setZ),setW:t(e.setW),toTuple:e.toTuple,toRecord:e.toRecord,fromTuple:e.fromTuple,fromRecord:e.fromRecord,add:t(e.add),sub:t(e.sub),neg:e.neg,direction:t(e.direction),length:e.length,lengthSquared:e.lengthSquared,distance:t(e.distance),distanceSquared:t(e.distanceSquared),normalize:e.normalize,scale:t(e.scale),dot:t(e.dot)}}(),Ye=(je.dot,je.scale,je.normalize,je.distanceSquared,je.distance,je.lengthSquared,je.length,je.direction,je.neg,je.sub,je.add,je.fromRecord,je.fromTuple,je.toRecord,je.toTuple,je.setW,je.setZ,je.setY,je.setX,je.getW),Ke=je.getZ,Xe=je.getY,Ze=je.getX,$e=je.vec4,Qe=(e(function(r,t,n){var o=n;return l(Hr,e(function(t,e,n){return _(r,t,n)}),t,o._0)}),e(function(r,t,n){var o=n;return l(Wr,e(function(t,e,n){return _(r,t,n)}),t,o._0)}),function(r){return Jr(r._0)}),rn=t(function(r,t){return _($r,r,t._0)}),tn=function(r){return{ctor:"Set_elm_builtin",_0:r}},en=tn(at),nn=t(function(r,t){return tn(l(wt,r,{ctor:"_Tuple0"},t._0))}),on=(t(function(r,t){return e=_(X,r,Qe(t)),l(H,nn,en,e);var e}),t(function(r,t){return tn(_(Lt,r,t._0))}),t(function(r,t){var e=t;return tn(_(St,r._0,e._0))}),t(function(r,t){var e=t;return tn(_(xt,r._0,e._0))}),t(function(r,t){var e=t;return tn(_(Rt,r._0,e._0))}),t(function(r,e){var n=e;return tn(_(kt,t(function(t,e){return r(t)}),n._0))}),t(function(r,e){var n=e,o=_(Ct,t(function(t,e){return r(t)}),n._0),c=o._0,u=o._1;return{ctor:"_Tuple2",_0:tn(c),_1:tn(u)}}),e(function(r,t,e){var n=m.cmp(J(e),0)>0,o=m.cmp(r,0)>0&&m.cmp(t,0)>0,c=_(O,t,e),u=_(ar,r,e);return o&&n?{ctor:"::",_0:u,_1:l(on,r,t,c)}:{ctor:"[]"}})),cn=(t(function(r,t){return l(on,r,r,t)}),e(function(r,t,e){var n=m.cmp(r,0)>0&&m.cmp(t,0)>0,o=_(O,t,e),c=_(ar,r,e),u=m.eq(r,J(c));return n&&u?{ctor:"::",_0:c,_1:l(cn,r,t,o)}:{ctor:"[]"}})),un=(t(function(r,t){return l(cn,r,r,t)}),z(o(function(r,t,e,n,o){return{ctor:"_Tuple5",_0:r,_1:t,_2:e,_3:n,_4:o}})),I(n(function(r,t,e,n){return{ctor:"_Tuple4",_0:r,_1:t,_2:e,_3:n}})),q(e(function(r,t,e){return{ctor:"_Tuple3",_0:r,_1:t,_2:e}})),V(t(function(r,t){return{ctor:"_Tuple2",_0:r,_1:t}})),t(function(r,t){for(;;){var e={ctor:"_Tuple2",_0:r,_1:t};if("[]"===e._0.ctor)return!0;if("[]"===e._1.ctor)return!1;var n=e._1._1;if(m.eq(e._0._0,e._1._0))r=e._0._1,t=n;else r=r,t=n}}),t(function(r,t){var e={ctor:"_Tuple2",_0:r,_1:t};return"[]"===e._0.ctor||"[]"!==e._1.ctor&&(m.eq(e._0._0,e._1._0)&&_(un,e._0._1,e._1._1))})),an=(t(function(r,t){return _(un,rr(r),rr(t))}),e(function(r,t,e){for(;;){var n=e;if("[]"===n.ctor)return!1;var o=n._1;if(m.eq(n._0,r))return _(un,t,o);r=r,t=t,e=o}})),_n=(t(function(r,t){var e=r;return"[]"===e.ctor||l(an,e._0,e._1,t)}),function(r){var t=r;if("[]"===t.ctor)return{ctor:"[]"};var e=t._1,n=t._0;return{ctor:"::",_0:{ctor:"_Tuple2",_0:n,_1:e},_1:_(X,function(r){var t=r;return{ctor:"_Tuple2",_0:t._0,_1:{ctor:"::",_0:n,_1:t._1}}},_n(e))}}),ln=t(function(r,t){var e=t;if("::"===e.ctor){var n=e._0;return{ctor:"::",_0:{ctor:"::",_0:r,_1:n},_1:{ctor:"::",_0:n,_1:e._1}}}return{ctor:"[]"}}),sn=(_(G,ln,{ctor:"::",_0:{ctor:"[]"},_1:{ctor:"[]"}}),_(G,t(function(r,e){return{ctor:"::",_0:{ctor:"[]"},_1:_(X,t(function(r,t){return{ctor:"::",_0:r,_1:t}})(r),e)}}),{ctor:"::",_0:{ctor:"[]"},_1:{ctor:"[]"}}),n(function(r,t,e,n){for(;;){var o=n;if("[]"===o.ctor)return rr(W(t)?r:rr({ctor:"::",_0:t,_1:r}));if("[]"===o._1.ctor)return rr({ctor:"::",_0:rr({ctor:"::",_0:o._0,_1:t}),_1:r});var c=o._1,u=o._0;if(_(e,u,o._1._0)){r=r,t={ctor:"::",_0:u,_1:t},e=e,n=c}else{r={ctor:"::",_0:rr({ctor:"::",_0:u,_1:t}),_1:r},t={ctor:"[]"},e=e,n=c}}})),fn=(t(function(r,t){return s(sn,{ctor:"[]"},{ctor:"[]"},r,t)}),t(function(r,e){var n=t(function(r,t){var e=t;return"Nothing"===e.ctor?A:"[]"===e._0.ctor?A:m.eq(r,e._0._0)?P(e._0._1):A});return l(H,n,P(e),r)}),t(function(r,t){return{ctor:"_Tuple2",_0:_(ar,r,t),_1:_(O,r,t)}})),dn=e(function(r,t,e){for(;;){var n={ctor:"_Tuple2",_0:r,_1:t};if("_Tuple2"!==n.ctor||"::"!==n._0.ctor||"::"!==n._1.ctor)return rr(e);var o=_(fn,n._0._0,t),c=o._0,u=o._1;r=n._0._1,t=u,e={ctor:"::",_0:c,_1:e}}}),pn=(t(function(r,t){return l(dn,r,t,{ctor:"[]"})}),t(function(r,t){var e=r(t);return"Nothing"===e.ctor?{ctor:"[]"}:{ctor:"::",_0:e._0._0,_1:_(pn,r,e._0._1)}})),hn=(e(function(r,e,n){return l(G,t(function(t,e){var n=e,o=_(r,n._0,t);return{ctor:"_Tuple2",_0:o._0,_1:{ctor:"::",_0:o._1,_1:n._1}}}),{ctor:"_Tuple2",_0:e,_1:{ctor:"[]"}},n)}),e(function(r,e,n){var o=l(H,t(function(t,e){var n=e,o=_(r,n._0,t);return{ctor:"_Tuple2",_0:o._0,_1:{ctor:"::",_0:o._1,_1:n._1}}}),{ctor:"_Tuple2",_0:e,_1:{ctor:"[]"}},n),c=o._0,u=o._1;return{ctor:"_Tuple2",_0:c,_1:rr(u)}}),t(function(r,t){var e=t;if("[]"===e.ctor)return{ctor:"[]"};if("[]"===e._1.ctor)return{ctor:"::",_0:e._0,_1:{ctor:"[]"}};var n=_(hn,r,e._1);return"::"===n.ctor?{ctor:"::",_0:_(r,e._0,n._0),_1:n}:{ctor:"[]"}})),mn=e(function(r,t,e){var n=e;if("[]"===n.ctor)return{ctor:"::",_0:t,_1:{ctor:"[]"}};var o=l(mn,r,t,n._1);return"::"===o.ctor?{ctor:"::",_0:_(r,n._0,o._0),_1:o}:{ctor:"[]"}}),gn=(t(function(r,t){var e=t;return"[]"===e.ctor?{ctor:"[]"}:l(tr,r,e._0,e._1)}),e(function(r,e,n){var o=t(function(t,e){var n=e,o=n._0;return{ctor:"_Tuple2",_0:o-1,_1:l(r,o,t,n._1)}});return oe(l(G,o,{ctor:"_Tuple2",_0:J(n)-1,_1:e},n))}),e(function(r,e,n){var o=t(function(t,e){var n=e,o=n._0;return{ctor:"_Tuple2",_0:o+1,_1:l(r,o,t,n._1)}});return oe(l(H,o,{ctor:"_Tuple2",_0:0,_1:e},n))}),t(function(r,e){var n=t(function(t,e){return P("Nothing"===(n=e).ctor?t:_(r,t,n._0));var n});return l(G,n,A,e)}),t(function(r,e){var n=t(function(t,e){return P("Nothing"===(n=e).ctor?t:_(r,n._0,t));var n});return l(H,n,A,e)}),t(function(r,e){return l(H,t(function(r,t){return{ctor:"::",_0:r,_1:t}}),e,r)})),vn=(e(function(r,t,e){r:for(;;){var n={ctor:"_Tuple2",_0:t,_1:e};if("::"===n._0.ctor){if("::"===n._1.ctor){r={ctor:"::",_0:n._1._0,_1:{ctor:"::",_0:n._0._0,_1:r}},t=n._0._1,e=n._1._1;continue r}return _(gn,r,t)}return _(gn,r,e)}})({ctor:"[]"}),function(r){var e=r;if("[]"===e.ctor)return{ctor:"::",_0:{ctor:"[]"},_1:{ctor:"[]"}};return _(or,function(r){var e=r;return _(X,t(function(r,t){return{ctor:"::",_0:r,_1:t}})(e._0),vn(e._1))},_n(e))}),bn=(t(function(r,t){return _(U,r,vn(t))}),t(function(r,t){return _(Z,function(t){return!r(t)},t)}),t(function(r,t){if(m.cmp(r,0)<0)return t;var e=j(_(O,r,t)),n=_(ar,r,t),o=e;return"Nothing"===o.ctor?t:_(er,n,o._0)}),t(function(r,e){var n=t(function(t,e){var n=t,o=e,c=_(r,n._0,o._0);return"EQ"===c.ctor?_(x,n._1,o._1):c}),o=_(fr,t(function(r,t){return{ctor:"_Tuple2",_0:t,_1:r}}),e);return _(X,ce,_(B,n,o))}),t(function(r,t){var e=t;if("[]"===e.ctor)return{ctor:"[]"};var n=e._1,o=e._0;return m.eq(r,o)?n:{ctor:"::",_0:o,_1:_(bn,r,n)}})),yn=(e(function(r,e,n){return _(fr,t(function(t,n){return r(t)?e(n):n}),n)}),e(function(r,t,e){if(m.cmp(r,0)<0)return e;var n=_(O,r,e),o=_(ar,r,e),c=n;return"::"===c.ctor?_(C["++"],o,{ctor:"::",_0:t(c._0),_1:c._1}):e})),Tn=(t(function(r,t){return _(yn,r,v(t))}),e(function(r,t,e){return _(X,function(e){return r(e)?t(e):e},e)})),wn=(e(function(r,t,e){return l(Tn,r,v(t),e)}),e(function(r,t,e){for(;;){var n=e;if("[]"===n.ctor)return A;if(t(n._0))return P(r);r=r+1,t=t,e=n._1}})(0)),Sn=(t(function(r,t){return _(E,function(r){return _(fn,r,t)},_(wn,r,t))}),function(r){return wn(t(function(r,t){return m.eq(r,t)})(r))}),kn=(t(function(r,t){for(;;){var e=t;if("[]"===e.ctor)return A;var n=e._0;if(r(n))return P(n);r=r,t=e._1}}),t(function(r,e){return l(H,t(function(t,e){return{ctor:"::",_0:r(t),_1:e}}),{ctor:"[]"},e)}),or),xn=(e(function(r,t,e){return _(kn,function(t){return _(kn,function(e){return{ctor:"::",_0:_(r,t,e),_1:{ctor:"[]"}}},e)},t)}),n(function(r,t,e,n){return _(kn,function(t){return _(kn,function(e){return _(kn,function(n){return{ctor:"::",_0:l(r,t,e,n),_1:{ctor:"[]"}}},n)},e)},t)}),o(function(r,t,e,n,o){return _(kn,function(t){return _(kn,function(e){return _(kn,function(n){return _(kn,function(o){return{ctor:"::",_0:s(r,t,e,n,o),_1:{ctor:"[]"}}},o)},n)},e)},t)}),t(function(r,e){return l(V,t(function(r,t){return r(t)}),e,r)}),n(function(r,t,e,n){for(;;){var o=e;if("[]"===o.ctor)return rr(n);var c=o._1,u=o._0,i=r(u);if(_(rn,i,t))r=r,t=t,e=c,n=n;else r=r,t=_(nn,i,t),e=c,n={ctor:"::",_0:u,_1:n}}})),Cn=t(function(r,t){return s(xn,r,en,t,{ctor:"[]"})}),Fn=(t(function(r,t){return m.eq(J(t),J(_(Cn,r,t)))}),t(function(r,t){for(;;){var e=t;if("[]"===e.ctor)return{ctor:"[]"};if(!r(e._0))return t;r=r,t=e._1}})),Ln=function(r){return t(function(t,e){for(;;){var n=e;if("[]"===n.ctor)return rr(t);var o=n._0;if(!r(o))return rr(t);t={ctor:"::",_0:o,_1:t},e=n._1}})({ctor:"[]"})},Rn=t(function(r,t){return{ctor:"_Tuple2",_0:_(Ln,r,t),_1:_(Fn,r,t)}}),An=t(function(r,t){var e=t;if("[]"===e.ctor)return{ctor:"[]"};var n=e._0,o=_(Rn,r(n),e._1),c=o._0,u=o._1;return{ctor:"::",_0:{ctor:"::",_0:n,_1:c},_1:_(An,r,u)}}),Mn=(An(t(function(r,t){return m.eq(r,t)})),t(function(r,e){var n=t(function(t,e){var n=e,o=n._1,c=r(t);return m.cmp(c,o)<0?{ctor:"_Tuple2",_0:t,_1:c}:{ctor:"_Tuple2",_0:n._0,_1:o}}),o=e;if("::"===o.ctor){if("[]"===o._1.ctor)return P(o._0);var c=o._0;return P(ce(l(H,n,{ctor:"_Tuple2",_0:c,_1:r(c)},o._1)))}return A}),t(function(r,e){var n=t(function(t,e){var n=e,o=n._1,c=r(t);return m.cmp(c,o)>0?{ctor:"_Tuple2",_0:t,_1:c}:{ctor:"_Tuple2",_0:n._0,_1:o}}),o=e;if("::"===o.ctor){if("[]"===o._1.ctor)return P(o._0);var c=o._0;return P(ce(l(H,n,{ctor:"_Tuple2",_0:c,_1:r(c)},o._1)))}return A}),function(r){var t=r;return"[]"===t.ctor?A:P({ctor:"_Tuple2",_0:t._0,_1:t._1})}),Pn=(e(function(r,t,e){for(;;){if(m.eq(r,t)||m.cmp(r,0)<0)return e;if(!(m.cmp(r,t)>0)){var n=_(fn,r,e),o=n._0,c=n._1,u=_(fn,t-r,c),i=u._0,a=u._1,l={ctor:"_Tuple2",_0:Mn(i),_1:Mn(a)};return"_Tuple2"===l.ctor&&"Just"===l._0.ctor&&"_Tuple2"===l._0._0.ctor&&"Just"===l._1.ctor&&"_Tuple2"===l._1._0.ctor?nr({ctor:"::",_0:o,_1:{ctor:"::",_0:{ctor:"::",_0:l._1._0._0,_1:l._0._0._1},_1:{ctor:"::",_0:{ctor:"::",_0:l._0._0._0,_1:l._1._0._1},_1:{ctor:"[]"}}}}):e}var s=r;r=t,t=s,e=e}}),e(function(r,t,e){for(;;){if(!(m.cmp(t,0)>0))return r;r=_(gn,e,r),t=t-1,e=e}})),En=(t(function(r,t){var e=J(t);return m.eq(e,0)||m.eq(e,r)?t:m.cmp(e,r)<0?rr(_(gn,_(ar,_(F,r,e),t),l(Pn,{ctor:"[]"},r/e|0,t))):_(ar,r,t)}),t(function(r,e){return _(t(function(r,t){for(;;){if(m.cmp(r,0)<0)return t;var n=r-1,o={ctor:"::",_0:e(r),_1:t};r=n,t=o}}),r-1,{ctor:"[]"})}),t(function(r,t){var e=r(t);return"Just"===e.ctor?{ctor:"::",_0:t,_1:_(En,r,e._0)}:{ctor:"::",_0:t,_1:{ctor:"[]"}}})),Nn=t(function(r,t){return m.cmp(r,0)<0?A:Y(_(O,r,t))}),Bn=Bn||{};Bn["!!"]=g(Nn);var On,zn,In=function(){function r(){return m.guid()}function t(r,t){for(;"[]"!==t.ctor;)r(t._0),t=t._1}function n(r){for(var t=0;"[]"!==r.ctor;)t++,r=r._1;return t}var c="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:function(r){setTimeout(r,1e3/60)};function u(r,t,e){var n=r.createShader(e);if(r.shaderSource(n,t),r.compileShader(n),!r.getShaderParameter(n,r.COMPILE_STATUS))throw r.getShaderInfoLog(n);return n}function i(r,t){switch(t){case r.FLOAT:return{size:1,type:Float32Array,baseType:r.FLOAT};case r.FLOAT_VEC2:return{size:2,type:Float32Array,baseType:r.FLOAT};case r.FLOAT_VEC3:return{size:3,type:Float32Array,baseType:r.FLOAT};case r.FLOAT_VEC4:return{size:4,type:Float32Array,baseType:r.FLOAT};case r.INT:return{size:1,type:Int32Array,baseType:r.INT};case r.INT_VEC2:return{size:2,type:Int32Array,baseType:r.INT};case r.INT_VEC3:return{size:3,type:Int32Array,baseType:r.INT};case r.INT_VEC4:return{size:4,type:Int32Array,baseType:r.INT}}}function a(r,e,o,c){for(var u=[],a=0;a<c;a++)u.push("_"+a);var _=i(r,e.type);if(void 0===_)throw new Error("No info available for: "+e.type);var l=0,s=new _.type(n(o)*_.size*c);t(function(r){!function(r,t,e,n,o){if(1===c)for(var i=0;i<t;i++)r[e++]=1===t?n[o]:n[o][i];else u.forEach(function(c){for(var u=0;u<t;u++)r[e++]=1===t?n[c][o]:n[c][o][u]})}(s,_.size,l,r,e.name),l+=_.size*c},o);var f=r.createBuffer();return e.name,r.bindBuffer(r.ARRAY_BUFFER,f),r.bufferData(r.ARRAY_BUFFER,s,r.STATIC_DRAW),f}function _(r,e,o){var c=r.createBuffer(),u=0===e.indexSize?function(r){for(var t=new Uint16Array(r),e=0;e<r;e++)t[e]=e;return t}(e.elemSize*n(o._0)):function(r,e){var o,c=new Uint16Array(n(r)*e),u=0;return t(function(r){if(1===e)c[u++]=r;else for(o=0;o<e;o++)c[u++]=r["_"+o.toString()]},r),c}(o._1,e.indexSize);return r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,c),r.bufferData(r.ELEMENT_ARRAY_BUFFER,u,r.STATIC_DRAW),{numIndices:u.length,indexBuffer:c,buffers:{}}}function l(r,t){return r+"#"+t}function s(e,n){var o=n.model,c=o.cache.gl;if(!c)return e;return c.viewport(0,0,c.drawingBufferWidth,c.drawingBufferHeight),c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT|c.STENCIL_BUFFER_BIT),t(function(e){if("[]"!==e.buffer._0.ctor){var n,s,f,d;e.vert.id&&e.frag.id&&(n=l(e.vert.id,e.frag.id),s=o.cache.programs[n]),s||(e.vert.id?f=o.cache.shaders[e.vert.id]:e.vert.id=r(),f||(f=u(c,e.vert.src,c.VERTEX_SHADER),o.cache.shaders[e.vert.id]=f),e.frag.id?d=o.cache.shaders[e.frag.id]:e.frag.id=r(),d||(d=u(c,e.frag.src,c.FRAGMENT_SHADER),o.cache.shaders[e.frag.id]=d),s=function(r,t,e){var n=r.createProgram();if(r.attachShader(n,t),r.attachShader(n,e),r.linkProgram(n),!r.getProgramParameter(n,r.LINK_STATUS))throw r.getProgramInfoLog(n);return n}(c,f,d),n=l(e.vert.id,e.frag.id),o.cache.programs[n]=s),c.useProgram(s),n=n||l(e.vert.id,e.frag.id);var p=o.cache.uniformSetters[n];p||(p=function(r,t,e){var n=0;function o(e,o){var c=r.getUniformLocation(e,o.name);switch(o.type){case r.INT:return function(t){r.uniform1i(c,t)};case r.FLOAT:return function(t){r.uniform1f(c,t)};case r.FLOAT_VEC2:return function(t){r.uniform2fv(c,new Float32Array(t))};case r.FLOAT_VEC3:return function(t){r.uniform3fv(c,new Float32Array(t))};case r.FLOAT_VEC4:return function(t){r.uniform4fv(c,new Float32Array(t))};case r.FLOAT_MAT4:return function(t){r.uniformMatrix4fv(c,!1,new Float32Array(t))};case r.SAMPLER_2D:var u=n++;return function(e){r.activeTexture(r.TEXTURE0+u);var n=t.cache.textures[e.id];n||(n=e.createTexture(r),t.cache.textures[e.id]=n),r.bindTexture(r.TEXTURE_2D,n),r.uniform1i(c,u)};case r.BOOL:return function(t){r.uniform1i(c,t)};default:return o.type,function(){}}}for(var c={},u=r.getProgramParameter(e,r.ACTIVE_UNIFORMS),i=0;i<u;i++){var a=r.getActiveUniform(e,i);c[a.name]=o(e,a)}return c}(c,o,s),o.cache.uniformSetters[n]=p),function(r,t){Object.keys(t).forEach(function(e){var n=r[e];n&&n(t[e])})}(p,e.uniforms);var h=function(r,t){switch(t){case"Triangles":return{mode:r.TRIANGLES,elemSize:3,indexSize:0};case"LineStrip":return{mode:r.LINE_STRIP,elemSize:1,indexSize:0};case"LineLoop":return{mode:r.LINE_LOOP,elemSize:1,indexSize:0};case"Points":return{mode:r.POINTS,elemSize:1,indexSize:0};case"Lines":return{mode:r.LINES,elemSize:2,indexSize:0};case"TriangleStrip":return{mode:r.TRIANGLE_STRIP,elemSize:1,indexSize:0};case"TriangleFan":return{mode:r.TRIANGLE_FAN,elemSize:1,indexSize:0};case"IndexedTriangles":return{mode:r.TRIANGLES,elemSize:1,indexSize:3}}}(c,e.buffer.ctor),m=o.cache.buffers[e.buffer.guid];m||(m=_(c,h,e.buffer),o.cache.buffers[e.buffer.guid]=m),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,m.indexBuffer);for(var g=c.getProgramParameter(s,c.ACTIVE_ATTRIBUTES),v=0;v<g;v++){var b=c.getActiveAttrib(s,v),y=c.getAttribLocation(s,b.name);c.enableVertexAttribArray(y),void 0===m.buffers[b.name]&&(m.buffers[b.name]=a(c,b,e.buffer._0,h.elemSize));var T=m.buffers[b.name],w=i(c,b.type);c.bindBuffer(c.ARRAY_BUFFER,T),c.vertexAttribPointer(y,w.size,w.baseType,!1,0,0)}t(function(r){!function(r,t){switch(t.ctor){case"Blend":r.enable(r.BLEND),r.blendEquationSeparate(t._0,t._3),r.blendFuncSeparate(t._1,t._2,t._4,t._5),r.blendColor(t._6,t._7,t._8,t._9);break;case"DepthTest":r.enable(r.DEPTH_TEST),r.depthFunc(t._0),r.depthMask(t._1),r.depthRange(t._2,t._3);break;case"StencilTest":r.enable(r.STENCIL_TEST),r.stencilFuncSeparate(r.FRONT,t._3,t._0,t._1),r.stencilOpSeparate(r.FRONT,t._4,t._5,t._6),r.stencilMaskSeparate(r.FRONT,t._2),r.stencilFuncSeparate(r.BACK,t._7,t._0,t._1),r.stencilOpSeparate(r.BACK,t._8,t._9,t._10),r.stencilMaskSeparate(r.BACK,t._2);break;case"Scissor":r.enable(r.SCISSOR_TEST),r.scissor(t._0,t._1,t._2,t._3);break;case"ColorMask":r.colorMask(t._0,t._1,t._2,t._3);break;case"CullFace":r.enable(r.CULL_FACE),r.cullFace(t._0);break;case"PolygonOffset":r.enable(r.POLYGON_OFFSET_FILL),r.polygonOffset(t._0,t._1);break;case"SampleCoverage":r.enable(r.SAMPLE_COVERAGE),r.sampleCoverage(t._0,t._1);break;case"SampleAlphaToCoverage":r.enable(r.SAMPLE_ALPHA_TO_COVERAGE)}}(c,r)},e.settings),c.drawElements(h.mode,m.numIndices,c.UNSIGNED_SHORT,0),t(function(r){!function(r,t){switch(t.ctor){case"Blend":r.disable(r.BLEND);break;case"DepthTest":r.disable(r.DEPTH_TEST);break;case"StencilTest":r.disable(r.STENCIL_TEST);break;case"Scissor":r.disable(r.SCISSOR_TEST);break;case"ColorMask":r.colorMask(!0,!0,!0,!0);break;case"CullFace":r.disable(r.CULL_FACE);break;case"PolygonOffset":r.disable(r.POLYGON_OFFSET_FILL);break;case"SampleCoverage":r.disable(r.SAMPLE_COVERAGE);break;case"SampleAlphaToCoverage":r.disable(r.SAMPLE_ALPHA_TO_COVERAGE)}}(c,r)},e.settings)}},o.entities),e}var f={render:function(r){var e={alpha:!1,depth:!1,stencil:!1,antialias:!1,premultipliedAlpha:!1},n=[];t(function(r){var t=r._0;switch(r.ctor){case"Alpha":e.alpha=!0,e.premultipliedAlpha=t;break;case"Antialias":e.antialias=!0;break;case"Depth":e.depth=!0,n.push(function(r){r.clearDepth(t)});break;case"ClearColor":n.push(function(t){t.clearColor(r._0,r._1,r._2,r._3)});break;case"Stencil":e.stencil=!0,n.push(function(r){r.clearStencil(t)})}},r.options);var o=document.createElement("canvas"),u=o.getContext&&(o.getContext("webgl",e)||o.getContext("experimental-webgl",e));u?n.forEach(function(r){r(u)}):(o=document.createElement("div")).innerHTML='<a href="http://get.webgl.org/">Enable WebGL</a> to see this content!';return r.cache.gl=u,r.cache.shaders=[],r.cache.programs={},r.cache.uniformSetters={},r.cache.buffers=[],r.cache.textures=[],c(function(){s(o,{model:r})}),o},diff:function(r,t){return t.model.cache=r.model.cache,{applyPatch:s,data:t}}};return{unsafeCoerceGLSL:function(r){return{src:r}},entity:o(function(t,e,n,o,c){return o.guid||(o.guid=r()),{ctor:"Entity",vert:e,frag:n,buffer:o,uniforms:c,settings:t}}),toHtml:e(function(r,t,e){var n={entities:e,cache:{},options:r};return qn.custom(t,n,f)})}}(),qn=function(){var r="STYLE",o="EVENT",c="ATTR",u="ATTR_NS",i="undefined"!=typeof document?document:{};function a(r,t,e){return{type:"thunk",func:r,args:t,thunk:e,node:void 0}}function s(t){for(var e,n={};"[]"!==t.ctor;){var i=t._0,a=i.key;if(a===c||a===u||a===o){var _=n[a]||{};_[i.realKey]=i.value,n[a]=_}else if(a===r){for(var l=n[a]||{},s=i.value;"[]"!==s.ctor;){var f=s._0;l[f._0]=f._1,s=s._1}n[a]=l}else if("namespace"===a)e=i.value;else if("className"===a){var d=n[a];n[a]=void 0===d?i.value:d+" "+i.value}else n[a]=i.value;t=t._1}return{facts:n,namespace:e}}function f(r,t,e){return{key:o,realKey:r,value:{options:t,decoder:e}}}function d(r,t){return(r.options===t.options||r.options.stopPropagation===t.options.stopPropagation&&r.options.preventDefault===t.options.preventDefault)&&At.equality(r.decoder,t.decoder)}function p(r,t){switch(r.type){case"thunk":return r.node||(r.node=r.thunk()),p(r.node,t);case"tagger":for(var e=r.node,n=r.tagger;"tagger"===e.type;)"object"!=typeof n?n=[n,e.tagger]:n.push(e.tagger),e=e.node;var o={tagger:n,parent:t};return(a=p(e,o)).elm_event_node_ref=o,a;case"text":return i.createTextNode(r.text);case"node":h(a=r.namespace?i.createElementNS(r.namespace,r.tag):i.createElement(r.tag),t,r.facts);for(var c=r.children,u=0;u<c.length;u++)a.appendChild(p(c[u],t));return a;case"keyed-node":h(a=r.namespace?i.createElementNS(r.namespace,r.tag):i.createElement(r.tag),t,r.facts);for(c=r.children,u=0;u<c.length;u++)a.appendChild(p(c[u]._1,t));return a;case"custom":var a;return h(a=r.impl.render(r.model),t,r.facts),a}}function h(t,e,n){for(var i in n){var a=n[i];switch(i){case r:g(t,a);break;case o:v(t,e,a);break;case c:y(t,a);break;case u:T(t,a);break;case"value":t[i]!==a&&(t[i]=a);break;default:t[i]=a}}}function g(r,t){var e=r.style;for(var n in t)e[n]=t[n]}function v(r,t,e){var n=r.elm_handlers||{};for(var o in e){var c=n[o],u=e[o];if(void 0===u)r.removeEventListener(o,c),n[o]=void 0;else if(void 0===c){c=b(t,u);r.addEventListener(o,c),n[o]=c}else c.info=u}r.elm_handlers=n}function b(r,t){function e(t){var n=e.info,o=_(At.run,n.decoder,t);if("Ok"===o.ctor){var c=n.options;c.stopPropagation&&t.stopPropagation(),c.preventDefault&&t.preventDefault();for(var u=o._0,i=r;i;){var a=i.tagger;if("function"==typeof a)u=a(u);else for(var l=a.length;l--;)u=a[l](u);i=i.parent}}}return e.info=t,e}function y(r,t){for(var e in t){var n=t[e];void 0===n?r.removeAttribute(e):r.setAttribute(e,n)}}function T(r,t){for(var e in t){var n=t[e],o=n.namespace,c=n.value;void 0===c?r.removeAttributeNS(o,e):r.setAttributeNS(o,e,c)}}function w(r,t){var e=[];return k(r,t,e,0),e}function S(r,t,e){return{index:t,type:r,data:e,domNode:void 0,eventNode:void 0}}function k(r,t,e,n){if(r!==t){var o=r.type,c=t.type;if(o===c)switch(c){case"thunk":for(var u=r.args,i=t.args,a=u.length,_=r.func===t.func&&a===i.length;_&&a--;)_=u[a]===i[a];if(_)return void(t.node=r.node);t.node=t.thunk();var l=[];return k(r.node,t.node,l,0),void(l.length>0&&e.push(S("p-thunk",n,l)));case"tagger":for(var s=r.tagger,f=t.tagger,d=!1,p=r.node;"tagger"===p.type;)d=!0,"object"!=typeof s?s=[s,p.tagger]:s.push(p.tagger),p=p.node;for(var h=t.node;"tagger"===h.type;)d=!0,"object"!=typeof f?f=[f,h.tagger]:f.push(h.tagger),h=h.node;return d&&s.length!==f.length?void e.push(S("p-redraw",n,t)):((d?function(r,t){for(var e=0;e<r.length;e++)if(r[e]!==t[e])return!1;return!0}(s,f):s===f)||e.push(S("p-tagger",n,f)),void k(p,h,e,n+1));case"text":return r.text!==t.text?void e.push(S("p-text",n,t.text)):void 0;case"node":return r.tag!==t.tag||r.namespace!==t.namespace?void e.push(S("p-redraw",n,t)):(void 0!==(m=x(r.facts,t.facts))&&e.push(S("p-facts",n,m)),void function(r,t,e,n){var o=r.children,c=t.children,u=o.length,i=c.length;u>i?e.push(S("p-remove-last",n,u-i)):u<i&&e.push(S("p-append",n,c.slice(u)));for(var a=n,_=u<i?u:i,l=0;l<_;l++){a++;var s=o[l];k(s,c[l],e,a),a+=s.descendantsCount||0}}(r,t,e,n));case"keyed-node":return r.tag!==t.tag||r.namespace!==t.namespace?void e.push(S("p-redraw",n,t)):(void 0!==(m=x(r.facts,t.facts))&&e.push(S("p-facts",n,m)),void function(r,t,e,n){var o,c=[],u={},i=[],a=r.children,_=t.children,l=a.length,s=_.length,f=0,d=0,p=n;for(;f<l&&d<s;){var h=a[f],m=_[d],g=h._0,v=m._0,b=h._1,y=m._1;if(g!==v){var T=f+1<l,w=d+1<s;if(T)var x=a[f+1],C=x._0,R=x._1,A=v===C;if(w)var M=_[d+1],P=M._0,E=M._1,N=g===P;if(T&&w&&N&&A)k(b,E,c,++p),F(u,c,g,y,d,i),p+=b.descendantsCount||0,L(u,c,g,R,++p),p+=R.descendantsCount||0,f+=2,d+=2;else if(w&&N)p++,F(u,c,v,y,d,i),k(b,E,c,p),p+=b.descendantsCount||0,f+=1,d+=2;else if(T&&A)L(u,c,g,b,++p),p+=b.descendantsCount||0,k(R,y,c,++p),p+=R.descendantsCount||0,f+=2,d+=1;else{if(!T||!w||C!==P)break;L(u,c,g,b,++p),F(u,c,v,y,d,i),p+=b.descendantsCount||0,k(R,E,c,++p),p+=R.descendantsCount||0,f+=2,d+=2}}else k(b,y,c,++p),p+=b.descendantsCount||0,f++,d++}for(;f<l;){p++;var h=a[f],b=h._1;L(u,c,h._0,b,p),p+=b.descendantsCount||0,f++}for(;d<s;){o=o||[];var m=_[d];F(u,c,m._0,m._1,void 0,o),d++}(c.length>0||i.length>0||void 0!==o)&&e.push(S("p-reorder",n,{patches:c,inserts:i,endInserts:o}))}(r,t,e,n));case"custom":if(r.impl!==t.impl)return void e.push(S("p-redraw",n,t));var m;void 0!==(m=x(r.facts,t.facts))&&e.push(S("p-facts",n,m));var g=t.impl.diff(r,t);return g?void e.push(S("p-custom",n,g)):void 0}else e.push(S("p-redraw",n,t))}}function x(t,e,n){var i;for(var a in t)if(a!==r&&a!==o&&a!==c&&a!==u)if(a in e){var _=t[a],l=e[a];_===l&&"value"!==a||n===o&&d(_,l)||((i=i||{})[a]=l)}else(i=i||{})[a]=void 0===n?"string"==typeof t[a]?"":null:n===r?"":n===o||n===c?void 0:{namespace:t[a].namespace,value:void 0};else{var s=x(t[a],e[a]||{},a);s&&((i=i||{})[a]=s)}for(var f in e)f in t||((i=i||{})[f]=e[f]);return i}var C="_elmW6BL";function F(r,t,e,n,o,c){var u=r[e];if(void 0===u)return u={tag:"insert",vnode:n,index:o,data:void 0},c.push({index:o,entry:u}),void(r[e]=u);if("remove"===u.tag){c.push({index:o,entry:u}),u.tag="move";var i=[];return k(u.vnode,n,i,u.index),u.index=o,void(u.data.data={patches:i,entry:u})}F(r,t,e+C,n,o,c)}function L(r,t,e,n,o){var c=r[e];if(void 0===c){var u=S("p-remove",o,void 0);return t.push(u),void(r[e]={tag:"remove",vnode:n,index:o,data:u})}if("insert"!==c.tag)L(r,t,e+C,n,o);else{c.tag="move";var i=[];k(n,c.vnode,i,o);u=S("p-remove",o,{patches:i,entry:c});t.push(u)}}function R(r,t,e,n){!function r(t,e,n,o,c,u,i){var a=n[o];var _=a.index;for(;_===c;){var l=a.type;if("p-thunk"===l)R(t,e.node,a.data,i);else if("p-reorder"===l){a.domNode=t,a.eventNode=i;var s=a.data.patches;s.length>0&&r(t,e,s,0,c,u,i)}else if("p-remove"===l){a.domNode=t,a.eventNode=i;var f=a.data;if(void 0!==f){f.entry.data=t;var s=f.patches;s.length>0&&r(t,e,s,0,c,u,i)}}else a.domNode=t,a.eventNode=i;if(!(a=n[++o])||(_=a.index)>u)return o}switch(e.type){case"tagger":for(var d=e.node;"tagger"===d.type;)d=d.node;return r(t,d,n,o,c+1,u,t.elm_event_node_ref);case"node":for(var p=e.children,h=t.childNodes,m=0;m<p.length;m++){c++;var g=p[m],v=c+(g.descendantsCount||0);if(c<=_&&_<=v&&(o=r(h[m],g,n,o,c,v,i),!(a=n[o])||(_=a.index)>u))return o;c=v}return o;case"keyed-node":for(var p=e.children,h=t.childNodes,m=0;m<p.length;m++){c++;var g=p[m]._1,v=c+(g.descendantsCount||0);if(c<=_&&_<=v&&(o=r(h[m],g,n,o,c,v,i),!(a=n[o])||(_=a.index)>u))return o;c=v}return o;case"text":case"thunk":throw new Error("should never traverse `text` or `thunk` nodes like this")}}(r,t,e,0,0,t.descendantsCount,n)}function A(r,t,e,n){return 0===e.length?r:(R(r,t,e,n),M(r,e))}function M(r,t){for(var e=0;e<t.length;e++){var n=t[e],o=n.domNode,c=P(o,n);o===r&&(r=c)}return r}function P(r,t){switch(t.type){case"p-redraw":return function(r,t,e){var n=r.parentNode,o=p(t,e);void 0===o.elm_event_node_ref&&(o.elm_event_node_ref=r.elm_event_node_ref);n&&o!==r&&n.replaceChild(o,r);return o}(r,t.data,t.eventNode);case"p-facts":return h(r,t.eventNode,t.data),r;case"p-text":return r.replaceData(0,r.length,t.data),r;case"p-thunk":return M(r,t.data);case"p-tagger":return void 0!==r.elm_event_node_ref?r.elm_event_node_ref.tagger=t.data:r.elm_event_node_ref={tagger:t.data,parent:t.eventNode},r;case"p-remove-last":for(var e=t.data;e--;)r.removeChild(r.lastChild);return r;case"p-append":var n=t.data;for(e=0;e<n.length;e++)r.appendChild(p(n[e],t.eventNode));return r;case"p-remove":var o=t.data;if(void 0===o)return r.parentNode.removeChild(r),r;var c=o.entry;return void 0!==c.index&&r.parentNode.removeChild(r),c.data=M(r,o.patches),r;case"p-reorder":return function(r,t){var e=t.data,n=function(r,t){if(void 0===r)return;for(var e=i.createDocumentFragment(),n=0;n<r.length;n++){var o=r[n],c=o.entry;e.appendChild("move"===c.tag?c.data:p(c.vnode,t.eventNode))}return e}(e.endInserts,t);r=M(r,e.patches);for(var o=e.inserts,c=0;c<o.length;c++){var u=o[c],a=u.entry,_="move"===a.tag?a.data:p(a.vnode,t.eventNode);r.insertBefore(_,r.childNodes[u.index])}void 0!==n&&r.appendChild(n);return r}(r,t);case"p-custom":var u=t.data;return u.applyPatch(r,u.data);default:throw new Error("Ran into an unknown patch!")}}var E=B(function(r,t){return function(r,e,n){if(void 0===e)return r;var o="The `"+t+"` module does not need flags.\nInitialize it with no arguments and you should be all set!";O(o,n)}}),N=B(function(r,t){return function(e,n,o){if(void 0===r){var c="Are you trying to sneak a Never value into Elm? Trickster!\nIt looks like "+t+".main is defined with `programWithFlags` but has type `Program Never`.\nUse `program` instead if you do not want flags.";O(c,o)}var u=_(At.run,r,n);if("Ok"===u.ctor)return e(u._0);var c="Trying to initialize the `"+t+"` module with an unexpected flag.\nI tried to convert it to an Elm value, but ran into this problem:\n\n"+u._0;O(c,o)}});function B(r){return t(function(t,e){return function(n){return function(o,c,u){var i=r(n,c);void 0===u?function(r,t,e,n){t.embed=function(t,e){for(;t.lastChild;)t.removeChild(t.lastChild);return ue.initialize(n(r.init,e,t),r.update,r.subscriptions,z(t,r.view))},t.fullscreen=function(t){return ue.initialize(n(r.init,t,document.body),r.update,r.subscriptions,z(document.body,r.view))}}(e,o,0,i):function(r,t,e,n){t.fullscreen=function(t){var o={doc:void 0};return ue.initialize(n(r.init,t,document.body),r.update(V(o)),r.subscriptions,D(e,document.body,o,r.view,r.viewIn,r.viewOut))},t.embed=function(t,o){var c={doc:void 0};return ue.initialize(n(r.init,o,t),r.update(V(c)),r.subscriptions,D(e,t,c,r.view,r.viewIn,r.viewOut))}}(_(t,u,e),o,c,i)}}})}function O(r,t){throw t&&(t.innerHTML='<div style="padding-left:1em;"><h2 style="font-weight:normal;"><b>Oops!</b> Something went wrong when starting your Elm program.</h2><pre style="padding-left:1em;">'+r+"</pre></div>"),new Error(r)}function z(r,t){return function(e,n){var o={tagger:e,parent:void 0},c=t(n),u=p(c,o);return r.appendChild(u),q(u,t,c,o)}}var I="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:function(r){setTimeout(r,1e3/60)};function q(r,t,e,n){var o,c="NO_REQUEST",u=e;function i(){switch(c){case"NO_REQUEST":throw new Error("Unexpected draw callback.\nPlease report this to <https://github.com/elm-lang/virtual-dom/issues>.");case"PENDING_REQUEST":I(i),c="EXTRA_REQUEST";var e=t(o),a=w(u,e);return r=A(r,u,a,n),void(u=e);case"EXTRA_REQUEST":return void(c="NO_REQUEST")}}return function(r){"NO_REQUEST"===c&&I(i),c="PENDING_REQUEST",o=r}}function V(r){return ie.nativeBinding(function(t){var e=r.doc;if(e){var n=e.getElementsByClassName("debugger-sidebar-messages")[0];n&&(n.scrollTop=n.scrollHeight)}t(ie.succeed(m.Tuple0))})}function D(r,t,e,n,o,c){return function(u,a){var _={tagger:u,parent:void 0},l={tagger:u,parent:void 0},s=n(a),f=p(s,_);t.appendChild(f);var d=q(f,n,s,_),h=o(a)._1,m=p(h,l);t.appendChild(m);var g=q(m,function(r,t,e){var n,o=function(r){return function(t){if("keydown"!==t.type||!t.metaKey||82!==t.which){for(var e="scroll"===t.type||"wheel"===t.type,n=t.target;null!==n;){if("elm-overlay-message-details"===n.className&&e)return;if(n===r&&!e)return;n=n.parentNode}t.stopPropagation(),t.preventDefault()}}}(t),c="Normal",u=r.tagger,i=function(){};return function(t){var a=e(t),_=a._0.ctor;return r.tagger="Normal"===_?u:i,c!==_&&(G("removeEventListener",o,c),G("addEventListener",o,_),"Normal"===c&&(n=document.body.style.overflow,document.body.style.overflow="hidden"),"Normal"===_&&(document.body.style.overflow=n),c=_),a._1}}(_,m,o),h,l),v=function(r,t,e,n,o,c){var u,a;return function(r){if(r.isDebuggerOpen){if(!c.doc)return u=t(r),void(a=function(r,t,e,n){var o=screen.width-900,c=screen.height-360,u=window.open("","","width=900,height=360,left="+o+",top="+c);i=u.document,t.doc=i,i.title="Debugger - "+r,i.body.style.margin="0",i.body.style.padding="0";var a=p(e,n);function _(){t.doc=void 0,u.close()}return i.body.appendChild(a),i.addEventListener("keydown",function(r){r.metaKey&&82===r.which&&window.location.reload(),38===r.which&&(n.tagger({ctor:"Up"}),r.preventDefault()),40===r.which&&(n.tagger({ctor:"Down"}),r.preventDefault())}),window.addEventListener("unload",_),u.addEventListener("unload",function(){t.doc=void 0,window.removeEventListener("unload",_),n.tagger({ctor:"Close"})}),i=document,a}(o,c,u,e));i=c.doc;var n=t(r),_=w(u,n);a=A(a,u,_,e),u=n,i=document}}}(0,c,l,0,r,e);return function(r){d(r),g(r),v(r)}}}function G(r,t,e){switch(e){case"Normal":return;case"Pause":return H(r,t,J);case"Message":return H(r,t,U)}}function H(r,t,e){for(var n=0;n<e.length;n++)document.body[r](e[n],t,!0)}var J=["click","dblclick","mousemove","mouseup","mousedown","mouseenter","mouseleave","touchstart","touchend","touchcancel","touchmove","pointerdown","pointerup","pointerover","pointerout","pointerenter","pointerleave","pointermove","pointercancel","dragstart","drag","dragend","dragenter","dragover","dragleave","drop","keyup","keydown","keypress","input","change","focus","blur"],U=J.concat("wheel","scroll");return{node:function(r){return t(function(t,e){return function(r,t,e){for(var n=s(t),o=n.namespace,c=n.facts,u=[],i=0;"[]"!==e.ctor;){var a=e._0;i+=a.descendantsCount||0,u.push(a),e=e._1}return i+=u.length,{type:"node",tag:r,facts:c,children:u,namespace:o,descendantsCount:i}}(r,t,e)})},text:function(r){return{type:"text",text:r}},custom:function(r,t,e){return{type:"custom",facts:s(r).facts,model:t,impl:e}},map:t(function(r,t){return{type:"tagger",tagger:r,node:t,descendantsCount:1+(t.descendantsCount||0)}}),on:e(f),style:function(t){return{key:r,value:t}},property:t(function(r,t){return{key:r,value:t}}),attribute:t(function(r,t){return{key:c,realKey:r,value:t}}),attributeNS:e(function(r,t,e){return{key:u,realKey:t,value:{value:e,namespace:r}}}),mapProperty:t(function(r,t){return t.key!==o?t:f(t.realKey,t.value.options,_(jt,r,t.value.decoder))}),lazy:t(function(r,t){return a(r,[t],function(){return r(t)})}),lazy2:e(function(r,t,e){return a(r,[t,e],function(){return _(r,t,e)})}),lazy3:n(function(r,t,e,n){return a(r,[t,e,n],function(){return l(r,t,e,n)})}),keyedNode:e(function(r,t,e){for(var n=s(t),o=n.namespace,c=n.facts,u=[],i=0;"[]"!==e.ctor;){var a=e._0;i+=a._1.descendantsCount||0,u.push(a),e=e._1}return{type:"keyed-node",tag:r,facts:c,children:u,namespace:o,descendantsCount:i+=u.length}}),program:E,programWithFlags:N,staticProgram:function(r){var e=m.Tuple2(m.Tuple0,_e);return _(E,On,{init:e,view:function(){return r},update:t(function(){return e}),subscriptions:function(){return pe}})()}}}(),Vn=function(r){return _(qn.program,On,r)},Dn=(qn.keyedNode,qn.lazy3,qn.lazy2,qn.lazy,{stopPropagation:!1,preventDefault:!1}),Gn=qn.on,Hn=t(function(r,t){return l(Gn,r,Dn,t)}),Jn=qn.style,Un=(qn.mapProperty,qn.attributeNS),Wn=qn.attribute,jn=qn.property,Yn=qn.map,Kn=qn.text,Xn=qn.node,Zn=(t(function(r,t){return{stopPropagation:r,preventDefault:t}}),Vn),$n=Yn,Qn=Kn,ro=Xn,to=(ro("body"),ro("section"),ro("nav"),ro("article"),ro("aside"),ro("h1"),ro("h2"),ro("h3"),ro("h4"),ro("h5"),ro("h6"),ro("header"),ro("footer"),ro("address"),ro("main"),ro("p"),ro("hr"),ro("pre"),ro("blockquote"),ro("ol"),ro("ul"),ro("li"),ro("dl"),ro("dt"),ro("dd"),ro("figure"),ro("figcaption"),ro("div")),eo=(ro("a"),ro("em"),ro("strong"),ro("small"),ro("s"),ro("cite"),ro("q"),ro("dfn"),ro("abbr"),ro("time"),ro("code"),ro("var"),ro("samp"),ro("kbd"),ro("sub"),ro("sup"),ro("i"),ro("b"),ro("u"),ro("mark"),ro("ruby"),ro("rt"),ro("rp"),ro("bdi"),ro("bdo"),ro("span")),no=ro("br"),oo=(ro("wbr"),ro("ins"),ro("del"),ro("img"),ro("iframe"),ro("embed"),ro("object"),ro("param"),ro("video"),ro("audio"),ro("source"),ro("track"),ro("canvas"),ro("math"),ro("table"),ro("caption"),ro("colgroup"),ro("col"),ro("tbody"),ro("thead"),ro("tfoot"),ro("tr"),ro("td"),ro("th"),ro("form"),ro("fieldset"),ro("legend"),ro("label"),ro("input")),co=(ro("button"),ro("select"),ro("datalist"),ro("optgroup"),ro("option"),ro("textarea"),ro("keygen"),ro("output"),ro("progress"),ro("meter"),ro("details"),ro("summary"),ro("menuitem"),ro("menu"),t(function(r,t){return{ctor:"SampleCoverage",_0:r,_1:t}}),t(function(r,t){return{ctor:"PolygonOffset",_0:r,_1:t}}),n(function(r,t,e,n){return{ctor:"ColorMask",_0:r,_1:t,_2:e,_3:n}}),n(function(r,t,e,n){return{ctor:"Scissor",_0:r,_1:t,_2:e,_3:n}}),n(function(r,t,e,n){return{ctor:"DepthTest",_0:r,_1:t,_2:e,_3:n}})),uo={ctor:"SampleAlphaToCoverage"},io=function(r){return{ctor:"FaceMode",_0:r}},ao=(io(1028),io(1029),io(1032),s(co,513,(zn={write:!0,near:0,far:1}).write,zn.near,zn.far)),_o=(e(function(r,t,e){return{write:r,near:t,far:e}}),e(function(r,t,e){return l(In.toHtml,r,t,e)})),lo=In.entity,so=(lo({ctor:"::",_0:ao,_1:{ctor:"[]"}}),In.unsafeCoerceGLSL,t(function(r,t){return{ctor:"IndexedTriangles",_0:r,_1:t}}),function(r){return{ctor:"Points",_0:r}}),fo=function(r){return{ctor:"Lines",_0:r}},po=function(r){return{ctor:"Triangles",_0:r}},ho=n(function(r,t,e,n){return{ctor:"ClearColor",_0:r,_1:t,_2:e,_3:n}}),mo={ctor:"Antialias"},go=function(r){return{ctor:"Depth",_0:r}},vo=function(r){return{ctor:"Alpha",_0:r}},bo=(_o({ctor:"::",_0:vo(!0),_1:{ctor:"::",_0:mo,_1:{ctor:"::",_0:go(1),_1:{ctor:"[]"}}}}),function(r){var e=r;return _(t(function(r,t){var n,o=r,c=t;return(n=o._0,function(r){return function(t){return function(e){return function(o){return function(c){return function(u){return function(i){return function(a){return function(_){return{ctor:"Blend",_0:n,_1:r,_2:t,_3:e,_4:o,_5:c,_6:u,_7:i,_8:a,_9:_}}}}}}}}}})(o._1)(o._2)(c._0)(c._1)(c._2)(e.r)(e.g)(e.b)(e.a)}),e.color,e.alpha)}),yo=function(r){return{ctor:"Factor",_0:r}},To=yo(0),wo=yo(1),So=yo(768),ko=yo(769),xo=yo(774),Co=yo(775),Fo=yo(770),Lo=yo(771),Ro=yo(772),Ao=yo(773),Mo=yo(776),Po=yo(32769),Eo=yo(32770),No=yo(32771),Bo=yo(32772),Oo=e(function(r,t,e){return{ctor:"Blender",_0:r,_1:t,_2:e}}),zo=t(function(r,t){var e=t;return l(Oo,32774,r._0,e._0)}),Io=(t(function(r,t){return bo({r:0,g:0,b:0,a:0,color:_(zo,r,t),alpha:_(zo,r,t)})}),t(function(r,t){var e=t;return l(Oo,32778,r._0,e._0)})),qo=(t(function(r,t){return bo({r:0,g:0,b:0,a:0,color:_(Io,r,t),alpha:_(Io,r,t)})}),t(function(r,t){var e=t;return l(Oo,32779,r._0,e._0)})),Vo=(t(function(r,t){return bo({r:0,g:0,b:0,a:0,color:_(qo,r,t),alpha:_(qo,r,t)})}),ie.onError),Do=ie.andThen,Go=t(function(r,t){var e=t;return ie.spawn(_(Do,me(r),e._0))}),Ho=ie.fail,Jo=(t(function(r,t){return _(Vo,function(t){return Ho(r(t))},t)}),ie.succeed),Uo=t(function(r,t){return _(Do,function(t){return Jo(r(t))},t)}),Wo=e(function(r,t,e){return _(Do,function(t){return _(Do,function(e){return Jo(_(r,t,e))},e)},t)}),jo=(n(function(r,t,e,n){return _(Do,function(t){return _(Do,function(e){return _(Do,function(n){return Jo(l(r,t,e,n))},n)},e)},t)}),o(function(r,t,e,n,o){return _(Do,function(t){return _(Do,function(e){return _(Do,function(n){return _(Do,function(o){return Jo(s(r,t,e,n,o))},o)},n)},e)},t)}),c(function(r,t,e,n,o,c){return _(Do,function(t){return _(Do,function(e){return _(Do,function(n){return _(Do,function(o){return _(Do,function(c){return Jo(f(r,t,e,n,o,c))},c)},o)},n)},e)},t)}),function(r){var e=r;return"[]"===e.ctor?Jo({ctor:"[]"}):l(Wo,t(function(r,t){return{ctor:"::",_0:r,_1:t}}),e._0,jo(e._1))}),Yo=e(function(r,t,e){return _(Uo,function(r){return{ctor:"_Tuple0"}},jo(_(X,Go(r),t)))}),Ko=Jo({ctor:"_Tuple0"}),Xo=e(function(r,t,e){return Jo({ctor:"_Tuple0"})}),Zo=ue.leaf("Task"),$o=function(r){return{ctor:"Perform",_0:r}},Qo=t(function(r,t){return Zo($o(_(Uo,r,t)))}),rc=(t(function(r,t){return Zo($o(_(Vo,function(t){return Jo(r(Rr(t)))},_(Do,function(t){return Jo(r(Ar(t)))},t))))}),t(function(r,t){return $o(_(Uo,r,t._0))}));ue.effectManagers.Task={pkg:"elm-lang/core",init:Ko,onEffects:Yo,onSelfMsg:Xo,tag:"cmd",cmdMap:rc};var tc=function(){return{create:function(){return ie.nativeBinding(function(r){var t=requestAnimationFrame(function(){r(ie.succeed(Date.now()))});return function(){cancelAnimationFrame(t)}})}}}(),ec=function(){return{now:ie.nativeBinding(function(r){r(ie.succeed(Date.now()))}),setInterval_:t(function(r,t){return ie.nativeBinding(function(e){var n=setInterval(function(){ie.rawSpawn(t)},r);return function(){clearInterval(n)}})})}}(),nc=ec.setInterval_,oc=e(function(r,t,e){var n=t;if("[]"===n.ctor)return Jo(e);var o=n._0,c=ie.spawn(_(nc,o,_(he,r,o)));return _(Do,function(t){return l(oc,r,n._1,l(wt,o,t,e))},c)}),cc=t(function(r,t){var e=r,n=e._1,o=e._0,c=_(Zr,o,t);return"Nothing"===c.ctor?l(wt,o,{ctor:"::",_0:n,_1:{ctor:"[]"}},t):l(wt,o,{ctor:"::",_0:n,_1:c._0},t)}),uc=ec.now,ic=e(function(r,t,e){var n=_(Zr,t,e.taggers);if("Nothing"===n.ctor)return Jo(e);return _(Do,function(r){return Jo(e)},_(Do,function(t){return jo(_(X,function(e){return _(me,r,e(t))},n._0))},uc))}),ac=ue.leaf("Time"),_c=t(function(r,t){return{taggers:r,processes:t}}),lc=Jo(_(_c,at,at)),sc=e(function(r,t,o){var c=o,u=e(function(r,t,e){var n=e;return{ctor:"_Tuple3",_0:n._0,_1:n._1,_2:_(Do,function(r){return n._2},ie.kill(t))}}),i=n(function(r,t,e,n){var o=n;return{ctor:"_Tuple3",_0:o._0,_1:l(wt,r,e,o._1),_2:o._2}}),a=e(function(r,t,e){var n=e;return{ctor:"_Tuple3",_0:{ctor:"::",_0:r,_1:n._0},_1:n._1,_2:n._2}}),s=l(H,cc,at,t),f=d(jr,a,i,u,s,c.processes,{ctor:"_Tuple3",_0:{ctor:"[]"},_1:at,_2:Jo({ctor:"_Tuple0"})}),p=f._0,h=f._1,m=f._2;return _(Do,function(r){return Jo(_(_c,s,r))},_(Do,function(t){return l(oc,r,p,h)},m))}),fc=t(function(r,t){return{ctor:"Every",_0:r,_1:t}}),dc=(t(function(r,t){return ac(_(fc,r,t))}),t(function(r,t){var e=t;return _(fc,e._0,function(t){return r(e._1(t))})}));ue.effectManagers.Time={pkg:"elm-lang/core",init:lc,onEffects:sc,onSelfMsg:ic,tag:"sub",subMap:dc};var pc=ie.kill,hc=(ie.sleep,ie.spawn),mc=tc.create({ctor:"_Tuple0"}),gc=ue.leaf("AnimationFrame"),vc=e(function(r,t,e){return{subs:r,request:t,oldTime:e}}),bc=Jo(l(vc,{ctor:"[]"},A,0)),yc=e(function(r,t,e){var n=e,o=n.request,c=n.oldTime,u={ctor:"_Tuple2",_0:o,_1:t};return"Nothing"===u._0.ctor?"[]"===u._1.ctor?Jo(l(vc,{ctor:"[]"},A,c)):_(Do,function(r){return _(Do,function(e){return Jo(l(vc,t,P(r),e))},uc)},hc(_(Do,he(r),mc))):"[]"===u._1.ctor?_(Do,function(r){return Jo(l(vc,{ctor:"[]"},A,c))},pc(u._0._0)):Jo(l(vc,t,o,c))}),Tc=e(function(r,t,e){var n=e,o=n.subs,c=t-n.oldTime,u=function(e){var n=e;return"Time"===n.ctor?_(me,r,n._0(t)):_(me,r,n._0(c))};return _(Do,function(r){return _(Do,function(e){return Jo(l(vc,o,P(r),t))},jo(_(X,u,o)))},hc(_(Do,he(r),mc)))}),wc=function(r){return{ctor:"Diff",_0:r}},Sc=function(r){return{ctor:"Time",_0:r}},kc=t(function(r,t){var e=t;return"Time"===e.ctor?Sc(function(t){return r(e._0(t))}):wc(function(t){return r(e._0(t))})});ue.effectManagers.AnimationFrame={pkg:"elm-lang/animation-frame",init:bc,onEffects:yc,onSelfMsg:Tc,tag:"sub",subMap:kc};var xc=function(){var r={addEventListener:function(){},removeEventListener:function(){}},n=c("undefined"!=typeof document?document:r),o=c("undefined"!=typeof window?window:r);function c(r){return function(t,e,n){return ie.nativeBinding(function(o){function c(r){var t=_(Jt,e,r);"Ok"===t.ctor&&ie.rawSpawn(n(t._0))}return r.addEventListener(t,c),function(){r.removeEventListener(t,c)}})}}var u="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:function(r){r()};function i(r,t){return ie.nativeBinding(function(e){u(function(){var n=document.getElementById(r);e(null!==n?ie.succeed(t(n)):ie.fail({ctor:"NotFound",_0:r}))})})}return{onDocument:e(n),onWindow:e(o),focus:function(r){return i(r,function(r){return r.focus(),m.Tuple0})},blur:function(r){return i(r,function(r){return r.blur(),m.Tuple0})},getScrollTop:function(r){return i(r,function(r){return r.scrollTop})},setScrollTop:t(function(r,t){return i(r,function(r){return r.scrollTop=t,m.Tuple0})}),getScrollLeft:function(r){return i(r,function(r){return r.scrollLeft})},setScrollLeft:t(function(r,t){return i(r,function(r){return r.scrollLeft=t,m.Tuple0})}),toBottom:function(r){return i(r,function(r){return r.scrollTop=r.scrollHeight,m.Tuple0})},toRight:function(r){return i(r,function(r){return r.scrollLeft=r.scrollWidth,m.Tuple0})},height:t(function(r,t){return i(t,function(t){switch(r.ctor){case"Content":return t.scrollHeight;case"VisibleContent":return t.clientHeight;case"VisibleContentWithBorders":return t.offsetHeight;case"VisibleContentWithBordersAndMargins":var e=t.getBoundingClientRect();return e.bottom-e.top}})}),width:t(function(r,t){return i(t,function(t){switch(r.ctor){case"Content":return t.scrollWidth;case"VisibleContent":return t.clientWidth;case"VisibleContentWithBorders":return t.offsetWidth;case"VisibleContentWithBordersAndMargins":var e=t.getBoundingClientRect();return e.right-e.left}})})}}(),Cc=xc.onWindow,Fc=xc.onDocument,Lc=Wn,Rc=function(r){return _(Lc,"height",y(r))},Ac=jn,Mc=t(function(r,t){return _(Ac,r,zt(t))}),Pc=function(r){return _(Mc,"className",r)},Ec=function(r){return _(Mc,"type",r)},Nc=function(r){return _(Mc,"value",r)},Bc=function(r){return _(Mc,"max",r)},Oc=function(r){return _(Mc,"min",r)},zc=function(r){return _(Mc,"step",r)},Ic=(t(function(r,t){return _(Ac,r,Nt(t))}),Jn),qc=_(Xt,"keyCode",te),Vc=(_(Zt,{ctor:"::",_0:"target",_1:{ctor:"::",_0:"checked",_1:{ctor:"[]"}}},ee),_(Zt,{ctor:"::",_0:"target",_1:{ctor:"::",_0:"value",_1:{ctor:"[]"}}},ne)),Dc=Dn,Gc=Hn,Hc=(m.update(Dc,{preventDefault:!0}),function(r){return _(Gc,"input",_(jt,r,Vc))}),Jc=function(r){return _(Gc,"click",Ht(r))},Uc=(t(function(r,t){return{stopPropagation:r,preventDefault:t}}),Uc||{});Uc["&>"]=t(function(r,t){return _(Do,function(r){return t},r)});var Wc=e(function(r,t,e){var n=t,o=_(Zr,n.category,e);if("Nothing"===o.ctor)return Jo(e);return _(Uc["&>"],jo(_(X,function(t){return _(me,r,t(n.position))},o._0.taggers)),Jo(e))}),jc=Jo(at),Yc=t(function(r,t){var e=t;return"Nothing"===e.ctor?P({ctor:"::",_0:r,_1:{ctor:"[]"}}):P({ctor:"::",_0:r,_1:e._0})}),Kc=t(function(r,t){for(;;){var e=r;if("[]"===e.ctor)return t;r=e._1,t=l(Tt,e._0._0,Yc(e._0._1),t)}}),Xc=ue.leaf("Mouse"),Zc=t(function(r,t){return{x:r,y:t}}),$c=l(Wt,Zc,_(Xt,"pageX",te),_(Xt,"pageY",te)),Qc=t(function(r,t){return{taggers:r,pid:t}}),ru=t(function(r,t){return{category:r,position:t}}),tu=e(function(r,t,o){var c=e(function(t,e,n){var o=l(Fc,t,$c,function(e){return _(he,r,_(ru,t,e))});return _(Do,function(r){return _(Do,function(n){return Jo(l(wt,t,_(Qc,e,n),r))},hc(o))},n)}),u=n(function(r,t,e,n){var o=t;return _(Do,function(t){return Jo(l(wt,r,_(Qc,e,o.pid),t))},n)}),i=e(function(r,t,e){var n=t;return _(Uc["&>"],pc(n.pid),e)});return d(jr,i,u,c,o,_(Kc,t,at),Jo(at))}),eu=t(function(r,t){return{ctor:"MySub",_0:r,_1:t}}),nu=function(r){return Xc(_(eu,"mousemove",r))},ou=function(r){return Xc(_(eu,"mousedown",r))},cu=function(r){return Xc(_(eu,"mouseup",r))},uu=t(function(r,t){var e=t;return _(eu,e._0,function(t){return r(e._1(t))})});ue.effectManagers.Mouse={pkg:"elm-lang/mouse",init:jc,onEffects:tu,onSelfMsg:Wc,tag:"sub",subMap:uu};var iu=Kn,au=_(jn,"namespace",zt("http://www.w3.org/2000/svg")),_u=e(function(r,t,e){return l(Xn,r,{ctor:"::",_0:au,_1:t},e)}),lu=_u("svg"),su=(_u("foreignObject"),_u("animate"),_u("animateColor"),_u("animateMotion"),_u("animateTransform"),_u("mpath"),_u("set"),_u("a"),_u("defs"),_u("g")),fu=(_u("marker"),_u("mask"),_u("pattern"),_u("switch"),_u("symbol"),_u("desc"),_u("metadata"),_u("title"),_u("feBlend"),_u("feColorMatrix"),_u("feComponentTransfer"),_u("feComposite"),_u("feConvolveMatrix"),_u("feDiffuseLighting"),_u("feDisplacementMap"),_u("feFlood"),_u("feFuncA"),_u("feFuncB"),_u("feFuncG"),_u("feFuncR"),_u("feGaussianBlur"),_u("feImage"),_u("feMerge"),_u("feMergeNode"),_u("feMorphology"),_u("feOffset"),_u("feSpecularLighting"),_u("feTile"),_u("feTurbulence"),_u("font"),_u("linearGradient"),_u("radialGradient"),_u("stop"),_u("circle")),du=(_u("ellipse"),_u("image"),_u("line"),_u("path")),pu=(_u("polygon"),_u("polyline"),_u("rect")),hu=(_u("use"),_u("feDistantLight"),_u("fePointLight"),_u("feSpotLight"),_u("altGlyph"),_u("altGlyphDef"),_u("altGlyphItem"),_u("glyph"),_u("glyphRef"),_u("textPath"),_u("text")),mu=(_u("tref"),_u("tspan"),_u("clipPath"),_u("colorProfile"),_u("cursor"),_u("filter"),_u("script"),_u("style"),_u("view"),Wn("writing-mode"),Wn("word-spacing"),Wn("visibility"),Wn("unicode-bidi"),Wn("text-rendering"),Wn("text-decoration"),Wn("text-anchor")),gu=Wn("stroke"),vu=Wn("stroke-width"),bu=(Wn("stroke-opacity"),Wn("stroke-miterlimit"),Wn("stroke-linejoin"),Wn("stroke-linecap")),yu=(Wn("stroke-dashoffset"),Wn("stroke-dasharray"),Wn("stop-opacity"),Wn("stop-color"),Wn("shape-rendering"),Wn("pointer-events"),Wn("overflow"),Wn("opacity"),Wn("mask"),Wn("marker-start"),Wn("marker-mid"),Wn("marker-end"),Wn("lighting-color"),Wn("letter-spacing"),Wn("kerning"),Wn("image-rendering"),Wn("glyph-orientation-vertical"),Wn("glyph-orientation-horizontal"),Wn("font-weight"),Wn("font-variant"),Wn("font-style"),Wn("font-stretch"),Wn("font-size")),Tu=(Wn("font-size-adjust"),Wn("font-family"),Wn("flood-opacity"),Wn("flood-color"),Wn("filter"),Wn("fill")),wu=(Wn("fill-rule"),Wn("fill-opacity"),Wn("enable-background"),Wn("dominant-baseline"),Wn("display"),Wn("direction"),Wn("cursor"),Wn("color"),Wn("color-rendering"),Wn("color-profile"),Wn("color-interpolation"),Wn("color-interpolation-filters"),Wn("clip"),Wn("clip-rule"),Wn("clip-path"),Wn("baseline-shift"),Wn("alignment-baseline")),Su=(Wn("zoomAndPan"),Wn("z"),Wn("yChannelSelector"),Wn("y2"),Wn("y1"),Wn("y")),ku=(_(Un,"http://www.w3.org/XML/1998/namespace","xml:space"),_(Un,"http://www.w3.org/XML/1998/namespace","xml:lang"),_(Un,"http://www.w3.org/XML/1998/namespace","xml:base"),_(Un,"http://www.w3.org/1999/xlink","xlink:type"),_(Un,"http://www.w3.org/1999/xlink","xlink:title"),_(Un,"http://www.w3.org/1999/xlink","xlink:show"),_(Un,"http://www.w3.org/1999/xlink","xlink:role"),_(Un,"http://www.w3.org/1999/xlink","xlink:href"),_(Un,"http://www.w3.org/1999/xlink","xlink:arcrole"),_(Un,"http://www.w3.org/1999/xlink","xlink:actuate"),Wn("xChannelSelector"),Wn("x2"),Wn("x1"),Wn("x-height"),Wn("x")),xu=(Wn("widths"),Wn("width")),Cu=(Wn("viewTarget"),Wn("viewBox"),Wn("vert-origin-y"),Wn("vert-origin-x"),Wn("vert-adv-y"),Wn("version"),Wn("values"),Wn("v-mathematical"),Wn("v-ideographic"),Wn("v-hanging"),Wn("v-alphabetic"),Wn("units-per-em"),Wn("unicode-range"),Wn("unicode"),Wn("underline-thickness"),Wn("underline-position"),Wn("u2"),Wn("u1"),Wn("type"),Wn("transform")),Fu=(Wn("to"),Wn("title"),Wn("textLength"),Wn("targetY"),Wn("targetX"),Wn("target"),Wn("tableValues"),Wn("systemLanguage"),Wn("surfaceScale"),Wn("style")),Lu=(Wn("string"),Wn("strikethrough-thickness"),Wn("strikethrough-position"),Wn("stitchTiles"),Wn("stemv"),Wn("stemh"),Wn("stdDeviation"),Wn("startOffset"),Wn("spreadMethod"),Wn("speed"),Wn("specularExponent"),Wn("specularConstant"),Wn("spacing"),Wn("slope"),Wn("seed"),Wn("scale"),Wn("ry"),Wn("rx"),Wn("rotate"),Wn("result"),Wn("restart"),Wn("requiredFeatures"),Wn("requiredExtensions"),Wn("repeatDur"),Wn("repeatCount"),Wn("rendering-intent"),Wn("refY"),Wn("refX"),Wn("radius"),Wn("r")),Ru=(Wn("primitiveUnits"),Wn("preserveAspectRatio"),Wn("preserveAlpha"),Wn("pointsAtZ"),Wn("pointsAtY"),Wn("pointsAtX"),Wn("points"),Wn("point-order"),Wn("patternUnits"),Wn("patternTransform"),Wn("patternContentUnits"),Wn("pathLength"),Wn("path"),Wn("panose-1"),Wn("overline-thickness"),Wn("overline-position"),Wn("origin"),Wn("orientation"),Wn("orient"),Wn("order"),Wn("operator"),Wn("offset"),Wn("numOctaves"),Wn("name"),Wn("mode"),Wn("min"),Wn("method"),Wn("media"),Wn("max"),Wn("mathematical"),Wn("maskUnits"),Wn("maskContentUnits"),Wn("markerWidth"),Wn("markerUnits"),Wn("markerHeight"),Wn("local"),Wn("limitingConeAngle"),Wn("lengthAdjust"),Wn("lang"),Wn("keyTimes"),Wn("keySplines"),Wn("keyPoints"),Wn("kernelUnitLength"),Wn("kernelMatrix"),Wn("k4"),Wn("k3"),Wn("k2"),Wn("k1"),Wn("k"),Wn("intercept"),Wn("in2"),Wn("in"),Wn("ideographic"),Wn("id"),Wn("horiz-origin-y"),Wn("horiz-origin-x"),Wn("horiz-adv-x"),Wn("height")),Au=(Wn("hanging"),Wn("gradientUnits"),Wn("gradientTransform"),Wn("glyphRef"),Wn("glyph-name"),Wn("g2"),Wn("g1"),Wn("fy"),Wn("fx"),Wn("from"),Wn("format"),Wn("filterUnits"),Wn("filterRes"),Wn("externalResourcesRequired"),Wn("exponent"),Wn("end"),Wn("elevation"),Wn("edgeMode"),Wn("dy"),Wn("dx"),Wn("dur"),Wn("divisor"),Wn("diffuseConstant"),Wn("descent"),Wn("decelerate"),Wn("d")),Mu=Wn("cy"),Pu=Wn("cx"),Eu=(Wn("contentStyleType"),Wn("contentScriptType"),Wn("clipPathUnits"),Wn("class")),Nu=(Wn("cap-height"),Wn("calcMode"),Wn("by"),Wn("bias"),Wn("begin"),Wn("bbox"),Wn("baseProfile"),Wn("baseFrequency"),Wn("azimuth"),Wn("autoReverse"),Wn("attributeType"),Wn("attributeName"),Wn("ascent"),Wn("arabic-form"),Wn("amplitude"),Wn("allowReorder"),Wn("alphabetic"),Wn("additive"),Wn("accumulate"),Wn("accelerate"),Wn("accent-height"),{size:ie.nativeBinding(function(r){r(ie.succeed({width:window.innerWidth,height:window.innerHeight}))})}),Bu=Bu||{};Bu["&>"]=t(function(r,t){return _(Do,function(r){return t},r)});var Ou=e(function(r,t,e){var n=e;if("Nothing"===n.ctor)return Jo(e);return _(Bu["&>"],jo(_(X,function(e){return _(me,r,e._0(t))},n._0.subs)),Jo(e))}),zu=Jo(A),Iu=Nu.size,qu=(_(Uo,function(r){return r.width},Iu),_(Uo,function(r){return r.height},Iu),e(function(r,t,e){var n={ctor:"_Tuple2",_0:e,_1:t};return"Nothing"===n._0.ctor?"[]"===n._1.ctor?Jo(A):_(Do,function(r){return Jo(P({subs:t,pid:r}))},hc(l(Cc,"resize",Ht({ctor:"_Tuple0"}),function(t){return _(Do,he(r),Iu)}))):"[]"===n._1.ctor?_(Bu["&>"],pc(n._0._0.pid),Jo(A)):Jo(P({subs:t,pid:n._0._0.pid}))})),Vu=ue.leaf("Window"),Du=t(function(r,t){return{width:r,height:t}}),Gu=function(r){return{ctor:"MySub",_0:r}},Hu=function(r){return Vu(Gu(r))},Ju=t(function(r,t){var e=t;return Gu(function(t){return r(e._0(t))})});ue.effectManagers.Window={pkg:"elm-lang/window",init:zu,onEffects:qu,onSelfMsg:Ou,tag:"sub",subMap:Ju};n(function(r,t,e,n){return{theta:r,size:t,origin:e,paused:n}});var Uu,Wu,ju,Yu,Ku=l(Ee,1,0,1),Xu=l(Ee,0,0,1),Zu=l(Ee,0,1,0),$u=l(Ee,1,0,0),Qu={src:"\n        precision mediump float;\n        uniform float shade;\n        varying vec3 vcolor;\n        void main () {\n            gl_FragColor = shade * vec4(vcolor, 1.0);\n        }\n    "},ri={src:"\n        attribute vec3 position;\n        attribute vec3 color;\n        uniform mat4 cameraTranslate;\n        uniform mat4 cameraRotate;\n        uniform mat4 perspective;\n        uniform mat4 camera;\n        uniform mat4 rotation;\n        varying vec3 vcolor;\n        void main () {\n            gl_Position = perspective * camera * rotation * cameraTranslate * cameraRotate  *  vec4(position, 1.0);\n            vcolor = color;\n        }\n    "},ti=e(function(r,t,e){var n=function(){var n={ctor:"_Tuple2",_0:_(pr,t-1,r),_1:_(pr,t+1,r)};r:do{if("_Tuple2"===n.ctor){if("Nothing"===n._0.ctor){if("Just"===n._1.ctor)return{ctor:"_Tuple2",_0:e,_1:n._1._0};break r}return"Just"===n._1.ctor?{ctor:"_Tuple2",_0:n._0._0,_1:n._1._0}:{ctor:"_Tuple2",_0:n._0._0,_1:e}}break r}while(0);return{ctor:"_Tuple2",_0:e,_1:e}}(),o=n._0,c=n._1,u={ctor:"_Tuple2",_0:_(xe,e,o),_1:_(xe,c,e)},i=u._1,a={ctor:"_Tuple2",_0:ke(_(we,o,u._0)),_1:ke(_(we,c,i))},l=a._0;return{index:t,position:e,sumNormal:ke(_(Ce,l,a._1)),prevPosition:o,prevNormal:l,prevSumNormal:A}}),ei=e(function(r,t,e){var n=_(pr,t-1,r);return m.update(e,{prevSumNormal:_(E,function(r){return r.sumNormal},n)})}),ni=function(r){return l(Ee,Ae(r)/10,Re(r)/10,Le(r)/100)},oi=t(function(r,t){var e=r.step,n=r.rho,o=r.beta,c=r.sigma,u={ctor:"_Tuple3",_0:Ae(t),_1:Re(t),_2:Le(t)},i=u._0,a=u._1,_=u._2;return l(Ee,i+c*(a-i)*e,a+(i*(n-_)-a)*e,_+(i*a-o*_)*e)}),ci=e(function(r,t,e){return f(lo,t,ri,Qu,e,{rotation:(n=r).rotation,perspective:n.perspective,camera:n.camera,shade:.8,cameraTranslate:n.cameraTranslate,cameraRotate:n.cameraRotate,size:n.size,origin:n.origin,paused:n.paused});var n}),ui=(c(function(r,t,e,n,o,c){return{sigma:r,beta:t,rho:e,step:n,numVertices:o,thickness:c}}),c(function(r,t,e,n,o,c){return{index:r,position:t,prevPosition:e,prevNormal:n,prevSumNormal:o,sumNormal:c}}),t(function(r,t){return{position:r,color:t}})),ii=t(function(r,t){var e,n=t,o=n.position,c=o,u=_(Ce,c,_(Se,r,n.sumNormal)),i=n.prevPosition,a="Just"===(e=n.prevSumNormal).ctor?_(Ce,i,_(Se,r,e._0)):_(Ce,i,_(Se,r,n.prevNormal));return 0===_(C["%"],n.index,2)?{ctor:"_Tuple2",_0:{ctor:"_Tuple3",_0:_(ui,i,$u),_1:_(ui,a,$u),_2:_(ui,c,$u)},_1:{ctor:"_Tuple3",_0:_(ui,c,Ku),_1:_(ui,a,Ku),_2:_(ui,u,Ku)}}:{ctor:"_Tuple2",_0:{ctor:"_Tuple3",_0:_(ui,a,Xu),_1:_(ui,i,Xu),_2:_(ui,u,Xu)},_1:{ctor:"_Tuple3",_0:_(ui,u,Zu),_1:_(ui,i,Zu),_2:_(ui,c,Zu)}}}),ai=function(r){var e,n=l(G,t(function(t,e){var n=e;return"[]"===n.ctor?{ctor:"::",_0:l(Ee,.1,0,0),_1:{ctor:"[]"}}:{ctor:"::",_0:_(oi,r,n._0),_1:e}}),{ctor:"[]"},_(sr,1,r.numVertices)),o=br(_(X,ni,n)),c=_(mr,ti(o),o),u=_(mr,ei(c),c);return po((e=_(gr,ii(r.thickness),u),l(hr,t(function(r,t){var e=r;return _(C["++"],t,_(C["++"],{ctor:"::",_0:e._0,_1:{ctor:"[]"}},{ctor:"::",_0:e._1,_1:{ctor:"[]"}}))}),{ctor:"[]"},e)))},_i=function(r){return{ctor:"Configure",_0:r}},li=(e(function(r,t,e){return _(to,{ctor:"[]"},{ctor:"::",_0:_(oo,{ctor:"::",_0:Ec("range"),_1:{ctor:"::",_0:Oc("10"),_1:{ctor:"::",_0:Bc("10000"),_1:{ctor:"::",_0:zc("30"),_1:{ctor:"::",_0:Hc(function(t){return _i(m.update(e,{numVertices:_(Lr,r,Nr(t))}))}),_1:{ctor:"[]"}}}}}},{ctor:"[]"}),_1:{ctor:"::",_0:Qn(_(C["++"],"vertices : ",y(r))),_1:{ctor:"::",_0:_(no,{ctor:"[]"},{ctor:"[]"}),_1:{ctor:"::",_0:_(oo,{ctor:"::",_0:Ec("range"),_1:{ctor:"::",_0:Oc("0"),_1:{ctor:"::",_0:Bc("1"),_1:{ctor:"::",_0:zc("0.01"),_1:{ctor:"::",_0:Hc(function(r){return{ctor:"Rotate",_0:_(Lr,t,Er(r))}}),_1:{ctor:"[]"}}}}}},{ctor:"[]"}),_1:{ctor:"::",_0:Qn(_(C["++"],"theta : ",y(t))),_1:{ctor:"::",_0:_(no,{ctor:"[]"},{ctor:"[]"}),_1:{ctor:"::",_0:_(oo,{ctor:"::",_0:Ec("range"),_1:{ctor:"::",_0:Oc("0"),_1:{ctor:"::",_0:Bc("100"),_1:{ctor:"::",_0:zc("0.1"),_1:{ctor:"::",_0:Hc(function(r){return _i(m.update(e,{sigma:_(Lr,e.sigma,Er(r))}))}),_1:{ctor:"[]"}}}}}},{ctor:"[]"}),_1:{ctor:"::",_0:Qn(_(C["++"],"sigma : ",y(e.sigma))),_1:{ctor:"::",_0:_(no,{ctor:"[]"},{ctor:"[]"}),_1:{ctor:"::",_0:_(oo,{ctor:"::",_0:Ec("range"),_1:{ctor:"::",_0:Oc("0"),_1:{ctor:"::",_0:Bc("15"),_1:{ctor:"::",_0:zc("0.01"),_1:{ctor:"::",_0:Hc(function(r){return _i(m.update(e,{beta:_(Lr,e.beta,Er(r))}))}),_1:{ctor:"[]"}}}}}},{ctor:"[]"}),_1:{ctor:"::",_0:Qn(_(C["++"],"beta : ",y(e.beta))),_1:{ctor:"::",_0:_(no,{ctor:"[]"},{ctor:"[]"}),_1:{ctor:"::",_0:_(oo,{ctor:"::",_0:Ec("range"),_1:{ctor:"::",_0:Oc("0"),_1:{ctor:"::",_0:Bc("100"),_1:{ctor:"::",_0:zc("0.5"),_1:{ctor:"::",_0:Hc(function(r){return _i(m.update(e,{rho:_(Lr,e.rho,Er(r))}))}),_1:{ctor:"[]"}}}}}},{ctor:"[]"}),_1:{ctor:"::",_0:Qn(_(C["++"],"rho : ",y(e.rho))),_1:{ctor:"::",_0:_(no,{ctor:"[]"},{ctor:"[]"}),_1:{ctor:"::",_0:_(oo,{ctor:"::",_0:Ec("range"),_1:{ctor:"::",_0:Oc("0"),_1:{ctor:"::",_0:Bc("1"),_1:{ctor:"::",_0:zc("0.001"),_1:{ctor:"::",_0:Hc(function(r){return _i(m.update(e,{step:_(Lr,e.step,Er(r))}))}),_1:{ctor:"[]"}}}}}},{ctor:"[]"}),_1:{ctor:"::",_0:Qn(_(C["++"],"step : ",y(e.step))),_1:{ctor:"[]"}}}}}}}}}}}}}}}}}})}),{pos:{x:0,y:0},down:!1,dragFrom:A}),si=t(function(r,t){return m.update(t,{pos:r,down:!0,dragFrom:(e=t.dragFrom,"Just"===e.ctor?P(e._0):P(r))});var e}),fi=t(function(r,t){return m.update(t,{down:!1,dragFrom:A})}),di=t(function(r,t){return m.update(t,{pos:r})}),pi=(e(function(r,t,e){return{pos:r,down:t,dragFrom:e}}),o(function(r,t,e,n,o){return{min:r,max:t,step:e,roundBy:n,$default:o}}),e(function(r,t,e){return{focus:r,shape:t,cells:e}}),function(r){return{ctor:"NestPos",_0:r}}),hi=function(r){return{ctor:"Focus",_0:r}},mi={ctor:"Collapsed"},gi={ctor:"Expanded"},vi={ctor:"TurnedOff"},bi={ctor:"TurnedOn"},yi={ctor:"NotSelected"},Ti={ctor:"Selected"},wi={ctor:"Stay"},Si=function(r){return{ctor:"ChoiceItem",_0:r}},ki=o(function(r,t,e,n,o){return{ctor:"Choice",_0:r,_1:t,_2:e,_3:n,_4:o}}),xi=e(function(r,t,e){return{ctor:"Nested",_0:r,_1:t,_2:e}}),Ci=t(function(r,t){return{ctor:"Button",_0:r,_1:t}}),Fi=e(function(r,t,e){return{ctor:"Toggle",_0:r,_1:t,_2:e}}),Li=n(function(r,t,e,n){return{ctor:"Knob",_0:r,_1:t,_2:e,_3:n}}),Ri=e(function(r,t,e){return{ctor:"TuneAndApply",_0:r,_1:t,_2:e}}),Ai=t(function(r,t){return{ctor:"ToggleOffAndSendToUser",_0:r,_1:t}}),Mi=t(function(r,t){return{ctor:"ToggleOnAndSendToUser",_0:r,_1:t}}),Pi=t(function(r,t){return{ctor:"SelectAndSendToUser",_0:r,_1:t}}),Ei=function(r){return{ctor:"SendToUser",_0:r}},Ni=function(r){return{ctor:"Select",_0:r}},Bi=function(r){return{ctor:"CollapseChoice",_0:r}},Oi=function(r){return{ctor:"ExpandChoice",_0:r}},zi=function(r){return{ctor:"CollapseNested",_0:r}},Ii=function(r){return{ctor:"ExpandNested",_0:r}},qi=function(r){return{ctor:"ToggleOff",_0:r}},Vi=t(function(r,t){return{ctor:"Tune",_0:r,_1:t}}),Di=function(r){return{ctor:"FocusOn",_0:r}},Gi=function(r){return{ctor:"TrackMouse",_0:r}},Hi={ctor:"NoOp"},Ji=e(function(r,t,e){return _(su,{ctor:"::",_0:Eu("gui-arrow"),_1:{ctor:"::",_0:Cu("rotate(-180.000000) translate(-30, -12)"),_1:{ctor:"[]"}}},{ctor:"::",_0:_(du,{ctor:"::",_0:ku(y(r)),_1:{ctor:"::",_0:Su(y(t)),_1:{ctor:"::",_0:Au("m 0 20 l 20 -20 l 20 20"),_1:{ctor:"::",_0:gu(e),_1:{ctor:"::",_0:Tu("none"),_1:{ctor:"::",_0:vu("2"),_1:{ctor:"::",_0:bu("round"),_1:{ctor:"[]"}}}}}}}},{ctor:"[]"}),_1:{ctor:"[]"}})}),Ui=e(function(r,t,e){return _(su,{ctor:"::",_0:Eu("gui-arrow"),_1:{ctor:"::",_0:Cu("rotate(-180.000000) translate(-30, -12)"),_1:{ctor:"[]"}}},{ctor:"::",_0:_(du,{ctor:"::",_0:ku(y(r)),_1:{ctor:"::",_0:Su(y(t)),_1:{ctor:"::",_0:Au("m 0 0 l 20 20 l 20 -20"),_1:{ctor:"::",_0:gu(e),_1:{ctor:"::",_0:Tu("none"),_1:{ctor:"::",_0:vu("2"),_1:{ctor:"::",_0:bu("round"),_1:{ctor:"[]"}}}}}}}},{ctor:"[]"}),_1:{ctor:"[]"}})}),Wi=t(function(r,t){return{ctor:"::",_0:xu("5"),_1:{ctor:"::",_0:Ru("5"),_1:{ctor:"::",_0:ku(y(-2.5)),_1:{ctor:"::",_0:Su(y(-2.5)),_1:{ctor:"::",_0:Tu(r),_1:{ctor:"::",_0:gu("none"),_1:{ctor:"::",_0:Cu(_(C["++"],"rotate(",_(C["++"],y(t),") translate(0,-15)"))),_1:{ctor:"[]"}}}}}}}}}),ji=e(function(r,t,e){return{ctor:"::",_0:Pu(y(r)),_1:{ctor:"::",_0:Mu(y(t)),_1:{ctor:"::",_0:Lu("15"),_1:{ctor:"::",_0:gu(e),_1:{ctor:"::",_0:Tu("none"),_1:{ctor:"::",_0:vu("2"),_1:{ctor:"[]"}}}}}}}}),Yi=e(function(r,t,e){return{ctor:"::",_0:Tu(e),_1:{ctor:"::",_0:ku(y(r)),_1:{ctor:"::",_0:Su(y(t)),_1:{ctor:"::",_0:yu("12"),_1:{ctor:"::",_0:Fu("font-family: sans-serif;"),_1:{ctor:"::",_0:mu("middle"),_1:{ctor:"::",_0:wu("central"),_1:{ctor:"[]"}}}}}}}}}),Ki=n(function(r,t,e,n){var o=function(r){var t=r;switch(t.ctor){case"Ghost":case"Knob":case"Toggle":case"Button":case"Nested":case"Choice":default:return t._0}},c=function(){var r,t=n;switch(t.ctor){case"Ghost":return _(su,{ctor:"::",_0:Eu("gui-ghost"),_1:{ctor:"[]"}},{ctor:"[]"});case"Knob":var c=t._2,u=t._1.roundBy,i=t._1.min,a=t._1.max,s=360*((t._1.$default-i)/(a-i)),f=360*((c-i)/(a-i)),d=T(k(c*T(u)))/T(u);return _(su,{ctor:"::",_0:Eu("gui-knob"),_1:{ctor:"[]"}},{ctor:"::",_0:_(hu,l(Yi,35,70/3,"aqua"),{ctor:"::",_0:iu(y(d)),_1:{ctor:"[]"}}),_1:{ctor:"::",_0:_(su,{ctor:"::",_0:Cu(_(C["++"],"translate(",_(C["++"],y(35),_(C["++"],",",_(C["++"],y(70/3),")"))))),_1:{ctor:"[]"}},{ctor:"::",_0:_(fu,l(ji,0,0,"aqua"),{ctor:"[]"}),_1:{ctor:"::",_0:_(pu,_(Wi,"rgba(0,255,0,0.4)",s),{ctor:"[]"}),_1:{ctor:"::",_0:_(pu,_(Wi,"aqua",f),{ctor:"[]"}),_1:{ctor:"[]"}}}}),_1:{ctor:"[]"}}});case"Toggle":var p=t._1;return _(su,{ctor:"::",_0:Eu("gui-toggle"),_1:{ctor:"[]"}},{ctor:"::",_0:_(hu,l(Yi,35,70/3,"aqua"),{ctor:"::",_0:iu(m.eq(p,bi)?"on":"off"),_1:{ctor:"[]"}}),_1:{ctor:"::",_0:_(fu,l(ji,35,70/3,m.eq(p,bi)?"green":"red"),{ctor:"[]"}),_1:{ctor:"[]"}}});case"Choice":return _(su,{ctor:"::",_0:Eu("gui-choice"),_1:{ctor:"[]"}},{ctor:"::",_0:_(hu,l(Yi,35,35,"aqua"),{ctor:"::",_0:iu(_(R,"",_(E,o,_(pr,t._2,br(t._4.cells))))),_1:{ctor:"[]"}}),_1:{ctor:"::",_0:_(su,{ctor:"::",_0:Cu(_(C["++"],"translate(",_(C["++"],y(25),",10)"))),_1:{ctor:"[]"}},{ctor:"::",_0:m.eq(t._1,gi)?l(Ji,35,10,"aqua"):l(Ui,35,10,"aqua"),_1:{ctor:"[]"}}),_1:{ctor:"[]"}}});case"Nested":return _(su,{ctor:"::",_0:Eu("gui-nested"),_1:{ctor:"[]"}},{ctor:"::",_0:_(su,{ctor:"::",_0:Cu(_(C["++"],"translate(",_(C["++"],y(25),",10)"))),_1:{ctor:"[]"}},{ctor:"::",_0:m.eq(t._1,gi)?l(Ji,35,10,"aqua"):l(Ui,35,10,"aqua"),_1:{ctor:"[]"}}),_1:{ctor:"[]"}});case"ChoiceItem":return _(su,{ctor:"::",_0:Eu("gui-choice-item"),_1:{ctor:"[]"}},{ctor:"::",_0:_(su,{ctor:"::",_0:Cu(_(C["++"],"translate(",_(C["++"],y(25),",10)"))),_1:{ctor:"[]"}},{ctor:"::",_0:(r=e,"Just"===r.ctor&&"Selected"===r._0.ctor?l(Ji,35,10,"green"):l(Ji,35,10,"darkgray")),_1:{ctor:"[]"}}),_1:{ctor:"[]"}});default:return _(su,{ctor:"[]"},{ctor:"::",_0:_(fu,l(ji,35,70/3,"darkgray"),{ctor:"[]"}),_1:{ctor:"[]"}})}}();return _(lu,{ctor:"::",_0:xu(y(70)),_1:{ctor:"::",_0:Ru(y(70)),_1:{ctor:"[]"}}},{ctor:"::",_0:c,_1:{ctor:"::",_0:_(hu,l(Yi,35,60,"white"),{ctor:"::",_0:iu(o(n)),_1:{ctor:"[]"}}),_1:{ctor:"[]"}}})}),Xi=t(function(r,t){var e=r,n=t;return m.cmp(J(e._0),J(n._0))>0}),Zi=t(function(r,t){var e=r,n=t;return m.eq(e._0,n._0)}),$i=function(r){return _(E,pi,_(M,function(r){return"[]"===r.ctor?A:P(r)},j(r._0)))},Qi=function(r){return Y(r._0)},ra=function(r){return J(r._0)},ta=t(function(r,t){return pi({ctor:"::",_0:r,_1:t._0})}),ea=function(r){return pi({ctor:"::",_0:r,_1:{ctor:"[]"}})},na=t(function(r,t){return _(R,ea(r),_(E,ta(r),t))}),oa=pi({ctor:"[]"}),ca=n(function(r,t,n,o){var c=o,u=e(function(r,e,n){var o=n,c=o._1,u=o._0;return{ctor:"_Tuple2",_0:u+1,_1:function(){var n,o="Just"===(n=r).ctor?_(ta,u,n._0):ea(u),i=e;switch(i.ctor){case"Nested":return s(ca,P(o),t,l(t,e,o,c),i._2);case"Choice":return s(ca,P(o),t,l(t,e,o,c),i._4);default:return l(t,e,o,c)}}()}});return oe(l(H,u(r),{ctor:"_Tuple2",_0:0,_1:n},c.cells))}),ua=ca(A),ia=(e(function(r,t,n){return l(ua,e(function(t,e,n){var o=t;switch(o.ctor){case"Nested":return l(r,o._2,e,n);case"Choice":return l(r,o._4,e,n);default:return n}}),l(r,n,oa,t),n)}),t(function(r,t){return l(ua,e(function(t,e,n){var o=n;return"Just"===o.ctor?P(o._0):_(Zi,e,r)?P(t):A}),A,t)})),aa=function(r){var t=hi(l(ua,e(function(r,t,e){var n=r;r:do{switch(n.ctor){case"Nested":if("Expanded"===n._1.ctor){var o=_(ta,n._2.focus,t);return _(Xi,o,e)?o:e}break r;case"Choice":if("Expanded"===n._1.ctor){o=_(ta,n._4.focus,t);return _(Xi,o,e)?o:e}break r;default:break r}}while(0);return e}),oa,r))._0;return _(Zi,t,oa)?hi(_(ta,r.focus,oa)):hi(t)},_a=t(function(r,t){var n=e(function(t,e,o){var c,u="Just"===(c=t).ctor?_(ta,e,c._0):ea(e),i=_(r,o,u);switch(i.ctor){case"Nested":var a=i._2;return l(xi,i._0,i._1,m.update(a,{cells:_(fr,n(P(u)),a.cells)}));case"Choice":var s=i._4;return f(ki,i._0,i._1,i._2,i._3,m.update(s,{cells:_(fr,n(P(u)),s.cells)}));default:return i}});return _(fr,n(A),t)}),la=t(function(r,e){return m.update(e,{cells:_(_a,t(function(t,e){var n=t;switch(n.ctor){case"Nested":return l(xi,n._0,n._1,_(r,n._2,e));case"Choice":return f(ki,n._0,n._1,n._2,n._3,_(r,n._4,e));default:return t}}),_(r,e,oa).cells)})}),sa=t(function(r,e){var n=_(R,-1,Qi(r)),o=$i(r);return"Just"===o.ctor?_(la,t(function(r,t){return _(Zi,t,o._0)?m.update(r,{focus:n}):r}),e):m.update(e,{focus:n})}),fa=e(function(r,e,n){var o=$i(e),c=_(R,0,Qi(e)),u=function(t){var e=t;return m.cmp(c+r,0)>-1&&m.cmp(c+r,J(e.cells))<0?c+r:c},i=o;return"Just"===i.ctor?_(la,t(function(r,t){return _(Zi,t,i._0)?m.update(r,{focus:u(r)}):r}),n):m.update(n,{focus:u(n)})}),da=t(function(r,t){return m.update(t,{cells:_(_a,r,t.cells)})}),pa=e(function(r,e,n){return _(da,t(function(t,n){return _(Zi,n,r)?e(t):t}),n)}),ha=t(function(r,e){return _(da,t(function(t,e){if(!(m.cmp(ra(e),ra(r))>-1))return t;var n=t;switch(n.ctor){case"Nested":return l(xi,n._0,mi,n._2);case"Choice":return f(ki,n._0,mi,n._2,n._3,n._4);default:return t}}),e)}),ma=t(function(r,t){return{focus:0,shape:r,cells:t}}),ga=function(r){return{focus:0,shape:{ctor:"_Tuple2",_0:J(r),_1:1},cells:r}},va=t(function(r,e){var n=e;return l(hr,t(function(e,n){return l(hr,t(function(t,e){var n={ctor:"_Tuple2",_0:e,_1:t};return"_Tuple2"===n.ctor&&"Nothing"===n._0.ctor&&"Just"===n._1.ctor?_(Zi,r,n._1._0.nestPos)?P(n._1._0):A:e}),n,e)}),A,n._1)}),ba=t(function(r,t){var e,n,o,c=r,u=t,i=_(C["++"],(o=c,_(C["++"],"(",_(C["++"],y(o._0),_(C["++"],",",_(C["++"],y(o._1),")"))))),_(C["++"]," ",(e=u.nestPos,n=e,_(C["++"],"<",_(C["++"],_(qr,",",_(X,y,rr(n._0))),">"))))),a=u.cell;switch(a.ctor){case"Ghost":return _(eo,{ctor:"[]"},{ctor:"::",_0:Qn(_(C["++"],i,_(C["++"]," ghost: ",a._0))),_1:{ctor:"[]"}});case"Knob":return _(eo,{ctor:"[]"},{ctor:"::",_0:Qn(_(C["++"],i,_(C["++"]," knob: ",_(C["++"],a._0,_(C["++"]," ",_(C["++"],y(a._1.min),_(C["++"],"/",_(C["++"],y(a._1.step),_(C["++"],"/",_(C["++"],y(a._1.max),_(C["++"]," ",y(a._2)))))))))))),_1:{ctor:"[]"}});case"Toggle":return _(eo,{ctor:"[]"},{ctor:"::",_0:Qn(_(C["++"],i,_(C["++"]," toggle: ",_(C["++"],a._0,_(C["++"]," ",m.eq(a._1,bi)?"on":"off"))))),_1:{ctor:"[]"}});case"Button":return _(eo,{ctor:"[]"},{ctor:"::",_0:Qn(_(C["++"],i,_(C["++"]," button: ",a._0))),_1:{ctor:"[]"}});case"Nested":return _(eo,{ctor:"[]"},{ctor:"::",_0:Qn(_(C["++"],i,_(C["++"]," nested: ",_(C["++"],a._0,_(C["++"]," ",m.eq(a._1,gi)?"expanded":"collapsed"))))),_1:{ctor:"[]"}});case"Choice":return _(eo,{ctor:"[]"},{ctor:"::",_0:Qn(_(C["++"],i,_(C["++"]," choice: ",_(C["++"],a._0,_(C["++"]," ",y(a._2)))))),_1:{ctor:"[]"}});default:return _(eo,{ctor:"[]"},{ctor:"::",_0:Qn(_(C["++"],i,_(C["++"]," choiceitem: ",_(C["++"],a._0,_(C["++"]," ",m.eq(u.isSelected,P(Ti))?"selected":"not-selected"))))),_1:{ctor:"[]"}})}}),ya=function(r){var e=r,n=e.nestPos,o=e.isSelected,c=e.cell;switch(c.ctor){case"Knob":return Di(n);case"Toggle":var u=c._2;return m.eq(c._1,bi)?_(Ai,n,u(vi)):_(Mi,n,u(bi));case"Nested":return m.eq(c._1,gi)?zi(n):Ii(n);case"Choice":return m.eq(c._1,gi)?Bi(n):Oi(n);case"Button":return Ei(c._1({ctor:"_Tuple0"}));case"ChoiceItem":var i=o;return"Just"===i.ctor&&"NotSelected"===i._0.ctor?_(R,Ni(n),_(E,Pi(n),_(E,t(function(r,t){return t(r)})(c._0),e.onSelect))):Hi;default:var a=o;return"Just"===a.ctor&&"NotSelected"===a._0.ctor?Ni(n):Hi}},Ta=e(function(r,t,e){var n=aa(r)._0,o=_(va,n,t),c=_(R,Hi,_(E,ya,o));switch(e){case 37:return{ctor:"ShiftFocusLeftAt",_0:n};case 39:return function(r){return{ctor:"ShiftFocusRightAt",_0:r}}(n);case 38:return _(R,Hi,_(E,function(r){var t=r.cell;r:do{switch(t.ctor){case"Nested":if("Collapsed"===t._1.ctor)return Ii(n);break r;case"Choice":if("Collapsed"===t._1.ctor)return Oi(n);break r;default:break r}}while(0);return Hi},o));case 40:var u=pi(_(R,{ctor:"[]"},j(n._0)));return _(Zi,u,oa)?Hi:_(R,Hi,_(E,function(r){var t=r.cell;r:do{switch(t.ctor){case"Nested":if("Expanded"===t._1.ctor)return zi(u);break r;case"Choice":if("Expanded"===t._1.ctor)return Bi(u);break r;default:break r}}while(0);return Hi},_(va,u,t)));case 33:case 13:return c;default:return Hi}}),wa=(o(function(r,t,e,n,o){return{cell:r,nestPos:t,onSelect:e,isSelected:n,isFocused:o}}),t(function(r,t){return{ctor:"GridPos",_0:r,_1:t}})),Sa=_(wa,0,0),ka=t(function(r,t){return{ctor:"Grid",_0:r,_1:t}}),xa=(e(function(r,t,e){var n=r,o=n._0,c=e,u=c._1;return _(R,c,_(E,ka(c._0),_(E,function(r){return l(dr,o,r,u)},_(E,function(r){return l(dr,n._1,P(t),r)},_(pr,o,u)))))}),{ctor:"Fancy"}),Ca=e(function(r,t,e){if("DebugInfo"===xa.ctor)return _(ba,t,e);var n=e;return s(Ki,n.nestPos,r,n.isSelected,n.cell)}),Fa=e(function(r,e,n){var o,c=_(R,{ctor:"[]"},_(E,function(t){return{ctor:"::",_0:l(Ca,r,e,t),_1:{ctor:"[]"}}},n)),u=_(R,{ctor:"[]"},_(E,function(r){return{ctor:"::",_0:Jc(ya(r)),_1:{ctor:"::",_0:(e=r,n=e,t="Knob"===n.cell.ctor?Di(n.nestPos):Hi,_(Gc,"mousedown",Ht(t))),_1:{ctor:"[]"}}};var t,e,n},n)),i=t(function(r,t){return t-r}),a=t(function(r,t){var e=t;return _(C["++"],"focused--",y(_(i,r,ra(e._0))))}),s=t(function(r,t){var e=t;return _(C["++"],"level--",y(_(i,r,ra(e._0))))}),f="Just"===(o=n).ctor?_(C["++"],function(){var t={ctor:"_Tuple2",_0:o._0.isSelected,_1:o._0.isFocused};r:do{if("_Tuple2"===t.ctor){if("Just"===t._0.ctor){if("Selected"===t._0._0.ctor)return"Focused"===t._1.ctor?_(C["++"],"cell selected focused ",_(a,t._1._0,r)):"cell selected";if("Focused"===t._1.ctor)return _(C["++"],"cell focused ",_(a,t._1._0,r));break r}if("Focused"===t._1.ctor)return _(C["++"],"cell focused ",_(a,t._1._0,r));break r}break r}while(0);return"cell"}(),_(C["++"]," ",_(s,ra(o._0.nestPos),r))):"cell hole",d=_(C["++"],{ctor:"::",_0:Pc(f),_1:{ctor:"[]"}},u);return _(to,d,c)}),La=e(function(r,t,e){var n=t;return _(to,{ctor:"::",_0:Pc("row"),_1:{ctor:"[]"}},vr(_(mr,function(t){return _(Fa,r,_(wa,n._0,n._1+t))},e)))}),Ra=t(function(r,t){var e=Sa,n=e._0,o=e._1,c=vr(_(mr,function(t){return _(La,r,_(wa,n+t,o))},t));return _(to,{ctor:"::",_0:Pc("cells"),_1:{ctor:"[]"}},c)}),Aa=e(function(r,t,e){var n=e,o=72*r+5*r*2;return _(to,{ctor:"::",_0:Pc("grid"),_1:{ctor:"::",_0:Ic({ctor:"::",_0:{ctor:"_Tuple2",_0:"width",_1:_(C["++"],y(o),"px")},_1:{ctor:"[]"}}),_1:{ctor:"[]"}}},{ctor:"::",_0:_(Ra,t,n._1),_1:{ctor:"[]"}})}),Ma={ctor:"NotFocused"},Pa=c(function(r,o,c,u,i,a){var f,p=r,h=p._0,g=p._1,v=a,b=v._0,y=t(function(r,t){var e=r,n=t;return e._0*n._0+e._1}),T=t(function(r,t){var e=r,n=t;return m.cmp(e._0,n._1)<0&&m.cmp(e._1,n._0)<0}),w=i.cells,S=_(mr,t(function(r,e){var n,a,l=_(na,r,c);return{cell:e,nestPos:l,onSelect:_(E,t(function(r,t){return t(r)})(r),u),isSelected:(a=o,"Just"===a.ctor?P(m.eq(r,a._0)?Ti:yi):A),isFocused:m.eq(i.focus,r)?(n=ra(l),{ctor:"Focused",_0:n}):Ma}}),br(w)),k=i.shape,x=e(function(r,t,e){if(m.cmp(r,h)>-1&&m.cmp(t,g)>-1){var n={ctor:"_Tuple2",_0:r-h,_1:t-g};if(_(T,n,k)){var o=_(pr,_(y,n,k),S);return"Just"===o.ctor?P(o._0):e}return e}return e}),C=t(function(r,t){return _(mr,x(r),t)}),F=_(R,0,_(E,ra,c)),L=b._0,M=n(function(r,t,e,n){var o=e._1,c=n._0;return m.cmp(t+c,L)<0?_(wa,r+o,t):_(wa,r+o,L-c)}),N=t(function(r,t){var e=t,n=e._1,o=e._0;return{ctor:"_Tuple2",_0:o+1,_1:function(){var t=r;if("Just"===t.ctor){var e=t._0.nestPos,c={ctor:"_Tuple2",_0:ra(e),_1:_(R,-1,Qi(e))},u=c._0;if(m.eq(u,F+1)){var i=t._0.cell;r:do{switch(i.ctor){case"Nested":if("Expanded"===i._1.ctor)return d(Pa,s(M,h,o,k,i._2.shape),A,P(e),A,i._2,n);break r;case"Choice":if("Expanded"===i._1.ctor)return d(Pa,s(M,h,o,k,i._4.shape),P(i._2),P(e),P(i._3),i._4,n);break r;default:break r}}while(0);return n}return n}return n}()}}),B=t(function(r,t){return oe(l(hr,N,{ctor:"_Tuple2",_0:0,_1:t},r))});return f=_(mr,C,v._1),l(hr,B,_(ka,b,f),f)}),Ea=e(function(r,t,e){return d(Pa,r,A,A,A,t,e)}),Na=function(r){return t=l(Ea,_(wa,0,0),r,_(ka,n={ctor:"_Tuple2",_0:10,_1:6},_(Tr,n._1,_(Tr,n._0,A)))),_(ka,(e=t)._0,br(rr(vr(e._1))));var t,e,n},Ba=function(r){var t,e,n=J(r.cells),o=aa(r),c=Na(r),u=_(Gc,"keydown",_(jt,_(Ta,r,c),qc));return _(to,{ctor:"::",_0:(e="grid-gui",_(Mc,"id",e)),_1:{ctor:"::",_0:Pc("gui noselect"),_1:{ctor:"::",_0:(t=-1,_(Lc,"tabIndex",y(t))),_1:{ctor:"::",_0:u,_1:{ctor:"[]"}}}}},{ctor:"::",_0:l(Aa,n,o,c),_1:{ctor:"[]"}})},Oa=e(function(r,t,e){var n=r,o=n.min,c=t;return"Alter"===c.ctor?o+c._0*(n.max-o):e}),za=n(function(r,t,e,n){var o=t.dragFrom;if("Just"===o.ctor){var c=o._0;if(m.eq(t.pos,c))return wi;var u=t.pos.y,i=c.y,a=(T(i),(T(i)+140-T(u))/280);return{ctor:"Alter",_0:m.cmp(a,1)>0?1:m.cmp(a,0)<0?0:a}}return wi}),Ia=t(function(r,t){var e=r,n=e._1,o=e._0,c=aa(n)._0,u=_(ia,c,n);if("Just"===u.ctor&&"Knob"===u._0.ctor){var i=u._0._1,a=u._0._2,f=s(za,o,t,i,a);return m.eq(o.down,!0)&&m.eq(t.down,!1)?l(Ri,c,f,u._0._3(l(Oa,i,f,a))):_(Vi,c,f)}return Hi}),qa=t(function(r,t){return{ctor:"_Tuple2",_0:r,_1:t}}),Va=n(function(r,t,e,n){r:for(;;){var o=n,c=o._1,u=o._0,i=e;switch(i.ctor){case"TrackMouse":var a=i._0;r=r,t=t,e=_(Ia,o,a),n={ctor:"_Tuple2",_0:a,_1:c};continue r;case"FocusOn":return{ctor:"_Tuple2",_0:_(le["!"],t,{ctor:"[]"}),_1:_(qa,u,_(sa,i._0,c))};case"Tune":var d=i._0;return{ctor:"_Tuple2",_0:_(le["!"],t,{ctor:"[]"}),_1:_(qa,u,l(pa,d,function(r){var t=r;if("Knob"===t.ctor){var e=t._1;return s(Li,t._0,e,l(Oa,e,i._1,t._2),t._3)}return r},_(sa,d,c)))};case"ToggleOn":var p=i._0;return{ctor:"_Tuple2",_0:_(le["!"],t,{ctor:"[]"}),_1:_(qa,u,l(pa,p,function(r){var t=r;return"Toggle"===t.ctor?l(Fi,t._0,bi,t._2):r},_(sa,p,c)))};case"ToggleOff":var h=i._0;return{ctor:"_Tuple2",_0:_(le["!"],t,{ctor:"[]"}),_1:_(qa,u,l(pa,h,function(r){var t=r;return"Toggle"===t.ctor?l(Fi,t._0,vi,t._2):r},_(sa,h,c)))};case"ExpandNested":var m=i._0;return{ctor:"_Tuple2",_0:_(le["!"],t,{ctor:"[]"}),_1:_(qa,u,l(pa,m,function(r){var t=r;return"Nested"===t.ctor?l(xi,t._0,gi,t._2):r},_(ha,m,_(sa,m,c))))};case"CollapseNested":var g=i._0;return{ctor:"_Tuple2",_0:_(le["!"],t,{ctor:"[]"}),_1:_(qa,u,l(pa,g,function(r){var t=r;return"Nested"===t.ctor?l(xi,t._0,mi,t._2):r},_(sa,g,c)))};case"ExpandChoice":var v=i._0;return{ctor:"_Tuple2",_0:_(le["!"],t,{ctor:"[]"}),_1:_(qa,u,l(pa,v,function(r){var t=r;return"Choice"===t.ctor?f(ki,t._0,gi,t._2,t._3,t._4):r},_(sa,v,_(ha,v,c))))};case"CollapseChoice":var b=i._0;return{ctor:"_Tuple2",_0:_(le["!"],t,{ctor:"[]"}),_1:_(qa,u,l(pa,b,function(r){var t=r;return"Choice"===t.ctor?f(ki,t._0,mi,t._2,t._3,t._4):r},_(sa,b,c)))};case"Select":var y=i._0;return{ctor:"_Tuple2",_0:_(le["!"],t,{ctor:"[]"}),_1:function(){var r=_(R,-1,Qi(y)),t=_(R,oa,$i(y));return _(qa,u,l(pa,t,function(t){var e=t;return"Choice"===e.ctor?f(ki,e._0,e._1,r,e._3,e._4):t},_(sa,y,c)))}()};case"SendToUser":return{ctor:"_Tuple2",_0:_(r,i._0,t),_1:_(qa,u,c)};case"SelectAndSendToUser":return s(Da,r,t,{ctor:"::",_0:Ni(i._0),_1:{ctor:"::",_0:Ei(i._1),_1:{ctor:"[]"}}},_(qa,u,c));case"ToggleOnAndSendToUser":return s(Da,r,t,{ctor:"::",_0:(T=i._0,{ctor:"ToggleOn",_0:T}),_1:{ctor:"::",_0:Ei(i._1),_1:{ctor:"[]"}}},_(qa,u,c));case"ToggleOffAndSendToUser":return s(Da,r,t,{ctor:"::",_0:qi(i._0),_1:{ctor:"::",_0:Ei(i._1),_1:{ctor:"[]"}}},_(qa,u,c));case"ShiftFocusLeftAt":return{ctor:"_Tuple2",_0:_(le["!"],t,{ctor:"[]"}),_1:_(qa,u,l(fa,-1,i._0,c))};case"ShiftFocusRightAt":return{ctor:"_Tuple2",_0:_(le["!"],t,{ctor:"[]"}),_1:_(qa,u,l(fa,1,i._0,c))};case"TuneAndApply":return s(Da,r,t,{ctor:"::",_0:_(Vi,i._0,i._1),_1:{ctor:"::",_0:Ei(i._2),_1:{ctor:"[]"}}},_(qa,u,c));default:return{ctor:"_Tuple2",_0:_(le["!"],t,{ctor:"[]"}),_1:_(qa,u,c)}}}var T}),Da=n(function(r,e,n,o){return l(G,t(function(t,e){var n=e,o=s(Va,r,n._0._0,t,n._1),c=o._0._0,u=o._0._1,i=o._1;return{ctor:"_Tuple2",_0:{ctor:"_Tuple2",_0:c,_1:ae({ctor:"::",_0:n._0._1,_1:{ctor:"::",_0:u,_1:{ctor:"[]"}}})},_1:i}}),{ctor:"_Tuple2",_0:{ctor:"_Tuple2",_0:e,_1:_e},_1:o},n)}),Ga=ce,Ha=t(function(r,t){return Gi(_(si,t,Ga(r)))}),Ja=t(function(r,t){return Gi(_(fi,t,Ga(r)))}),Ua=t(function(r,t){return Gi(_(di,t,Ga(r)))}),Wa=function(r){return Ba(oe(r))},ja=function(r){switch(r){case"0":return 0;case"1":return 1;case"sC":return 2;case"1-sC":return 3;case"dC":return 4;case"1-dC":return 5;case"sA":return 6;case"1-sA":return 7;case"dA":return 8;case"1-dA":return 9;case"AS":return 10;case"CC":return 11;case"1-CC":return 12;case"CA":return 13;case"1-CA":return 14;default:return 0}},Ya=function(r){switch(r){case"+":return 0;case"-":return 1;case"R-":return 2;default:return 0}},Ka=function(r){switch(r){case 0:return"zero";case 1:return"one";case 2:return"srcColor";case 3:return"oneMinusSrcColor";case 4:return"dstColor";case 5:return"oneMinusDstColor";case 6:return"srcAlpha";case 7:return"oneMinusSrcAlpha";case 8:return"dstAlpha";case 9:return"oneMinusDstAlpha";case 10:return"srcAlphaSaturate";case 11:return"constantColor";case 12:return"oneMinusConstantColor";case 13:return"constantAlpha";case 14:return"oneMinusConstantAlpha";default:return"[?]"}},Xa=t(function(r,t){var e=r,n=e.space,o=e.delim,c=t;return _(C["++"],n,_(C["++"],"Function: ",_(C["++"],function(r){switch(r){case 0:return"Custom Add";case 1:return"Custom Subtract";case 2:return"Custom Reverse Subtract";default:return"[?]"}}(c._0),_(C["++"],o,_(C["++"],n,_(C["++"],"Factor 1: ",_(C["++"],Ka(c._1),_(C["++"],o,_(C["++"],n,_(C["++"],"Factor 2: ",_(C["++"],Ka(c._2),o)))))))))))}),Za=t(function(r,t){var e=t,n={ctor:"::",_0:y(e.r),_1:{ctor:"::",_0:y(e.g),_1:{ctor:"::",_0:y(e.b),_1:{ctor:"::",_0:y(e.a),_1:{ctor:"[]"}}}}};return"::"===n.ctor&&"::"===n._1.ctor&&"::"===n._1._1.ctor&&"::"===n._1._1._1.ctor&&"[]"===n._1._1._1._1.ctor?_(C["++"],"rgba(",_(C["++"],n._0,_(C["++"],",",_(C["++"],n._1._0,_(C["++"],",",_(C["++"],n._1._1._0,_(C["++"],",",_(C["++"],n._1._1._1._0,")")))))))):"[?]"}),$a=t(function(r,t){var e=r,n=r.delim,o=t;return _(C["++"],"Color: ",_(C["++"],_(R,"[?]",_(E,Za(e),o.color)),_(C["++"],n,_(C["++"],"Color EQ: ",_(C["++"],_(Xa,e,o.colorEq),_(C["++"],n,_(C["++"],"Alpha EQ: ",_(C["++"],_(Xa,e,o.alphaEq),n))))))))}),Qa=(t(function(r,t){return _(qr,":",_(X,$a(r),t))}),function(r){switch(r){case 0:return m.chr("0");case 1:return m.chr("1");case 2:return m.chr("2");case 3:return m.chr("3");case 4:return m.chr("4");case 5:return m.chr("5");case 6:return m.chr("6");case 7:return m.chr("7");case 8:return m.chr("8");case 9:return m.chr("9");case 10:return m.chr("a");case 11:return m.chr("b");case 12:return m.chr("c");case 13:return m.chr("d");case 14:return m.chr("e");case 15:return m.chr("f");default:return m.chr("0")}}),r_=function(r){return Mr({ctor:"::",_0:Qa(r/16|0),_1:{ctor:"::",_0:Qa(_(F,r,16)),_1:{ctor:"[]"}}})},t_=function(r){var t=r;return _(Gr,Qa(t._0),_(Gr,Qa(t._1),_(Gr,Qa(t._2),"")))},e_=function(r){var t,e,n=r;return _(C["++"],(t=n.color,"Just"===(e=t).ctor?_(C["++"],r_(S(255*e._0.r)),_(C["++"],r_(S(255*e._0.g)),_(C["++"],r_(S(255*e._0.b)),r_(S(255*e._0.a))))):"00000000"),_(C["++"],t_(n.colorEq),t_(n.alphaEq)))},n_=function(r){switch(r.valueOf()){case"0":return P(0);case"1":return P(1);case"2":return P(2);case"3":return P(3);case"4":return P(4);case"5":return P(5);case"6":return P(6);case"7":return P(7);case"8":return P(8);case"9":return P(9);case"A":return P(10);case"B":return P(11);case"C":return P(12);case"D":return P(13);case"E":return P(14);case"F":return P(15);case"a":return P(10);case"b":return P(11);case"c":return P(12);case"d":return P(13);case"e":return P(14);case"f":return P(15);default:return A}},o_=function(r){var t=r,e="_Tuple2",n=n_(t._0),o=n_(t._1);return"_Tuple2"===e&&"Just"===n.ctor&&"Just"===o.ctor?P(16*n._0+o._0):A},c_=function(r){var t=Pr(r);if("::"===t.ctor&&"::"===t._1.ctor&&"::"===t._1._1.ctor&&"::"===t._1._1._1.ctor&&"::"===t._1._1._1._1.ctor&&"::"===t._1._1._1._1._1.ctor&&"::"===t._1._1._1._1._1._1.ctor&&"::"===t._1._1._1._1._1._1._1.ctor&&"[]"===t._1._1._1._1._1._1._1._1.ctor){var e={ctor:"_Tuple4",_0:o_({ctor:"_Tuple2",_0:t._0,_1:t._1._0}),_1:o_({ctor:"_Tuple2",_0:t._1._1._0,_1:t._1._1._1._0}),_2:o_({ctor:"_Tuple2",_0:t._1._1._1._1._0,_1:t._1._1._1._1._1._0}),_3:o_({ctor:"_Tuple2",_0:t._1._1._1._1._1._1._0,_1:t._1._1._1._1._1._1._1._0})};return"_Tuple4"===e.ctor&&"Just"===e._0.ctor&&"Just"===e._1.ctor&&"Just"===e._2.ctor&&"Just"===e._3.ctor?P({r:T(e._0._0)/255,g:T(e._1._0)/255,b:T(e._2._0)/255,a:T(e._3._0)/255}):A}return A},u_=function(r){var t=Pr(r);if("::"===t.ctor&&"::"===t._1.ctor&&"::"===t._1._1.ctor&&"[]"===t._1._1._1.ctor){var e=_(R,0,n_(t._1._1._0)),n=_(R,1,n_(t._1._0)),o=_(R,0,n_(t._0));return P({ctor:"_Tuple3",_0:o,_1:n,_2:e})}return A},i_=function(r){if(m.eq(Vr(r),14)){var t=l(Ir,11,14,r),e=l(Ir,8,11,r),n=l(Ir,0,8,r),o={ctor:"_Tuple3",_0:c_(n),_1:u_(e),_2:u_(t)};return"_Tuple3"===o.ctor&&"Just"===o._0.ctor&&"Just"===o._1.ctor&&"Just"===o._2.ctor?P({color:P(o._0._0),colorEq:o._1._0,alphaEq:o._2._0}):A}return A},a_={ctor:"::",_0:To,_1:{ctor:"::",_0:wo,_1:{ctor:"::",_0:So,_1:{ctor:"::",_0:ko,_1:{ctor:"::",_0:xo,_1:{ctor:"::",_0:Co,_1:{ctor:"::",_0:Fo,_1:{ctor:"::",_0:Lo,_1:{ctor:"::",_0:Ro,_1:{ctor:"::",_0:Ao,_1:{ctor:"::",_0:Mo,_1:{ctor:"::",_0:Po,_1:{ctor:"::",_0:Eo,_1:{ctor:"::",_0:No,_1:{ctor:"::",_0:Bo,_1:{ctor:"[]"}}}}}}}}}}}}}}}},__=br(a_),l_={ctor:"::",_0:zo,_1:{ctor:"::",_0:Io,_1:{ctor:"::",_0:qo,_1:{ctor:"[]"}}}},s_=br(l_),f_=function(r){var t=r,e=_(R,To,_(pr,t._2,__)),n=_(R,wo,_(pr,t._1,__)),o=_(R,zo,_(pr,t._0,s_));return _(o,n,e)},d_=function(r){var t=r,e=_(R,{r:0,g:0,b:0,a:0},t.color);return bo({r:e.r,g:e.r,b:e.b,a:e.a,color:f_(t.colorEq),alpha:f_(t.alphaEq)})},p_=t(function(r,t){var e=r,n=t;return{color:A,colorEq:{ctor:"_Tuple3",_0:_(R,0,_(Sn,e._0,l_)),_1:_(R,1,_(Sn,e._1,a_)),_2:_(R,0,_(Sn,e._2,a_))},alphaEq:{ctor:"_Tuple3",_0:_(R,0,_(Sn,n._0,l_)),_1:_(R,1,_(Sn,n._1,a_)),_2:_(R,0,_(Sn,n._2,a_))}}}),h_={color:A,colorEq:{ctor:"_Tuple3",_0:0,_1:1,_2:0},alphaEq:{ctor:"_Tuple3",_0:0,_1:6,_2:7}},m_=(n(function(r,t,e,n){return{r:r,g:t,b:e,a:n}}),e(function(r,t,e){return{color:r,colorEq:t,alphaEq:e}}),t(function(r,t){return{delim:r,space:t}}),function(r){switch(r.ctor){case"Normal":return"normal";case"Difference":return"difference";case"Exclusion":return"exclusion";case"Overlay":return"overlay";case"SoftLight":return"soft-light";case"Hue":return"hue";case"Multiply":return"multiply";case"Screen":return"screen";case"Darken":return"darken";case"Lighten":return"lighten";case"ColorDodge":return"color-dodge";case"ColorBurn":return"color-burn";case"HardLight":return"hard-light";case"Saturation":return"saturation";case"Color":return"color";case"Luminosity":return"luminosity";default:return"unset"}}),g_={ctor:"Unset"},v_={ctor:"Luminosity"},b_={ctor:"Color"},y_={ctor:"Saturation"},T_={ctor:"HardLight"},w_={ctor:"ColorBurn"},S_={ctor:"ColorDodge"},k_={ctor:"Lighten"},x_={ctor:"Darken"},C_={ctor:"Screen"},F_={ctor:"Multiply"},L_={ctor:"Hue"},R_={ctor:"SoftLight"},A_={ctor:"Overlay"},M_={ctor:"Exclusion"},P_={ctor:"Difference"},E_={ctor:"Normal"},N_=function(r){switch(r){case"normal":return E_;case"difference":return P_;case"exclusion":return M_;case"overlay":return A_;case"soft-light":return R_;case"hue":return L_;case"multiply":return F_;case"screen":return C_;case"darken":return x_;case"lighten":return k_;case"color-dodge":return S_;case"color-burn":return w_;case"hard-light":return T_;case"saturation":return y_;case"color":return b_;case"luminosity":return v_;case"unset":default:return g_}},B_=E_,O_=function(r){switch(r.ctor){case"IntelliJ":return{ctor:"_Tuple2",_0:616,_1:90};case"PhpStorm":return{ctor:"_Tuple2",_0:518,_1:108};case"PyCharm":return{ctor:"_Tuple2",_0:479,_1:108};case"RubyMine":return{ctor:"_Tuple2",_0:502,_1:108};case"WebStorm":return{ctor:"_Tuple2",_0:567,_1:90};case"CLion":return{ctor:"_Tuple2",_0:299,_1:90};case"DataGrip":return{ctor:"_Tuple2",_0:468,_1:108};case"AppCode":return{ctor:"_Tuple2",_0:518,_1:108};case"GoLand":return{ctor:"_Tuple2",_0:419,_1:90};case"ReSharper":return{ctor:"_Tuple2",_0:546,_1:108};case"ReSharperCpp":return{ctor:"_Tuple2",_0:763,_1:108};case"DotCover":return{ctor:"_Tuple2",_0:490,_1:90};case"DotMemory":return{ctor:"_Tuple2",_0:620,_1:108};case"DotPeek":return{ctor:"_Tuple2",_0:444,_1:90};case"DotTrace":return{ctor:"_Tuple2",_0:461,_1:90};case"Rider":return{ctor:"_Tuple2",_0:273,_1:90};case"TeamCity":return{ctor:"_Tuple2",_0:495,_1:108};case"YouTrack":return{ctor:"_Tuple2",_0:485,_1:90};case"UpSource":return{ctor:"_Tuple2",_0:490,_1:104};case"Hub":return{ctor:"_Tuple2",_0:211,_1:90};case"Kotlin":return{ctor:"_Tuple2",_0:323,_1:99};case"MPS":return{ctor:"_Tuple2",_0:200,_1:77};default:return{ctor:"_Tuple2",_0:90,_1:90}}},z_=function(r){switch(r.ctor){case"JetBrains":return"jetbrains";case"IntelliJ":return"intellij-idea";case"PhpStorm":return"phpstorm";case"PyCharm":return"pycharm";case"RubyMine":return"rubymine";case"WebStorm":return"webstorm";case"CLion":return"clion";case"DataGrip":return"datagrip";case"AppCode":return"appcode";case"GoLand":return"goland";case"ReSharper":return"resharper";case"ReSharperCpp":return"resharper-cpp";case"DotCover":return"dotcover";case"DotMemory":return"dotmemory";case"DotPeek":return"dotpeek";case"DotTrace":return"dottrace";case"Rider":return"rider";case"TeamCity":return"teamcity";case"YouTrack":return"youtrack";case"UpSource":return"upsource";case"Hub":return"hub";case"Kotlin":return"kotlin";case"MPS":return"mps";default:return"unknown"}},I_=function(r){var e=_(fr,t(function(r,t){return{ctor:"_Tuple2",_0:r,_1:t}}),{ctor:"::",_0:"jetbrains",_1:{ctor:"::",_0:"intellij-idea",_1:{ctor:"::",_0:"phpstorm",_1:{ctor:"::",_0:"pycharm",_1:{ctor:"::",_0:"rubymine",_1:{ctor:"::",_0:"webstorm",_1:{ctor:"::",_0:"clion",_1:{ctor:"::",_0:"datagrip",_1:{ctor:"::",_0:"appcode",_1:{ctor:"::",_0:"goland",_1:{ctor:"::",_0:"resharper",_1:{ctor:"::",_0:"resharper-cpp",_1:{ctor:"::",_0:"dotcover",_1:{ctor:"::",_0:"dotmemory",_1:{ctor:"::",_0:"dotpeek",_1:{ctor:"::",_0:"dottrace",_1:{ctor:"::",_0:"rider",_1:{ctor:"::",_0:"teamcity",_1:{ctor:"::",_0:"youtrack",_1:{ctor:"::",_0:"upsource",_1:{ctor:"::",_0:"hub",_1:{ctor:"::",_0:"kotlin",_1:{ctor:"::",_0:"mps",_1:{ctor:"[]"}}}}}}}}}}}}}}}}}}}}}}}});return _(R,-1,Y(_(Q,function(t){var e=t;return m.eq(z_(r),e._1)?P(e._0):A},e)))},q_=function(r){switch(r.ctor){case"JetBrains":return{ctor:"::",_0:"#ad3259",_1:{ctor:"::",_0:"#aa48ff",_1:{ctor:"::",_0:"#ffdb00",_1:{ctor:"[]"}}}};case"IntelliJ":return{ctor:"::",_0:"#0b67cc",_1:{ctor:"::",_0:"#fc31fe",_1:{ctor:"::",_0:"#ffd08d",_1:{ctor:"[]"}}}};case"PhpStorm":return{ctor:"::",_0:"#b345f1",_1:{ctor:"::",_0:"#765af8",_1:{ctor:"::",_0:"#ff318c",_1:{ctor:"[]"}}}};case"PyCharm":return{ctor:"::",_0:"#09f58f",_1:{ctor:"::",_0:"#ed8b00",_1:{ctor:"::",_0:"#ffe400",_1:{ctor:"[]"}}}};case"RubyMine":return{ctor:"::",_0:"#e52763",_1:{ctor:"::",_0:"#8f41cd",_1:{ctor:"::",_0:"#ea7211",_1:{ctor:"[]"}}}};case"WebStorm":return{ctor:"::",_0:"#00cdd7",_1:{ctor:"::",_0:"#2086d7",_1:{ctor:"::",_0:"#fff045",_1:{ctor:"[]"}}}};case"CLion":return{ctor:"::",_0:"#22d88f",_1:{ctor:"::",_0:"#029de0",_1:{ctor:"::",_0:"#ed358c",_1:{ctor:"[]"}}}};case"DataGrip":return{ctor:"::",_0:"#22d88f",_1:{ctor:"::",_0:"#9775f8",_1:{ctor:"::",_0:"#ff59e6",_1:{ctor:"[]"}}}};case"AppCode":return{ctor:"::",_0:"#247ce6",_1:{ctor:"::",_0:"#00daf0",_1:{ctor:"::",_0:"#1ddf93",_1:{ctor:"[]"}}}};case"GoLand":return{ctor:"::",_0:"#0670c7",_1:{ctor:"::",_0:"#ea4fff",_1:{ctor:"::",_0:"#3bea62",_1:{ctor:"[]"}}}};case"ReSharper":return{ctor:"::",_0:"#c21456",_1:{ctor:"::",_0:"#e14ce3",_1:{ctor:"::",_0:"#fdbc2c",_1:{ctor:"[]"}}}};case"ReSharperCpp":return{ctor:"::",_0:"#fdbc2c",_1:{ctor:"::",_0:"#e14ce3",_1:{ctor:"::",_0:"#c21456",_1:{ctor:"[]"}}}};case"DotCover":return{ctor:"::",_0:"#ff7500",_1:{ctor:"::",_0:"#7866ff",_1:{ctor:"::",_0:"#e343e6",_1:{ctor:"[]"}}}};case"DotMemory":return{ctor:"::",_0:"#ffbd00",_1:{ctor:"::",_0:"#7866ff",_1:{ctor:"::",_0:"#e343e6",_1:{ctor:"[]"}}}};case"DotPeek":return{ctor:"::",_0:"#00caff",_1:{ctor:"::",_0:"#7866ff",_1:{ctor:"::",_0:"#e343e6",_1:{ctor:"[]"}}}};case"DotTrace":return{ctor:"::",_0:"#fc1681",_1:{ctor:"::",_0:"#786bfb",_1:{ctor:"::",_0:"#e14ce3",_1:{ctor:"[]"}}}};case"Rider":return{ctor:"::",_0:"#c90f5e",_1:{ctor:"::",_0:"#077cfb",_1:{ctor:"::",_0:"#fdb60d",_1:{ctor:"[]"}}}};case"TeamCity":return{ctor:"::",_0:"#0cb0f2",_1:{ctor:"::",_0:"#905cfb",_1:{ctor:"::",_0:"#3bea62",_1:{ctor:"[]"}}}};case"YouTrack":return{ctor:"::",_0:"#0cb0f2",_1:{ctor:"::",_0:"#905cfb",_1:{ctor:"::",_0:"#ff318c",_1:{ctor:"[]"}}}};case"UpSource":return{ctor:"::",_0:"#22b1ef",_1:{ctor:"::",_0:"#9062f7",_1:{ctor:"::",_0:"#fd8224",_1:{ctor:"[]"}}}};case"Hub":return{ctor:"::",_0:"#00b8f1",_1:{ctor:"::",_0:"#9758fb",_1:{ctor:"::",_0:"#ffee45",_1:{ctor:"[]"}}}};case"Kotlin":return{ctor:"::",_0:"#22b1ef",_1:{ctor:"::",_0:"#9062f7",_1:{ctor:"::",_0:"#fd8224",_1:{ctor:"[]"}}}};case"MPS":return{ctor:"::",_0:"#0b8fff",_1:{ctor:"::",_0:"#21d789",_1:{ctor:"::",_0:"#ffdc52",_1:{ctor:"[]"}}}};default:return{ctor:"::",_0:"#9151e1",_1:{ctor:"::",_0:"#ec4476",_1:{ctor:"::",_0:"#fde74a",_1:{ctor:"[]"}}}}}},V_={ctor:"Unknown"},D_={ctor:"MPS"},G_={ctor:"Kotlin"},H_={ctor:"Hub"},J_={ctor:"UpSource"},U_={ctor:"YouTrack"},W_={ctor:"TeamCity"},j_={ctor:"Rider"},Y_={ctor:"DotTrace"},K_={ctor:"DotPeek"},X_={ctor:"DotMemory"},Z_={ctor:"DotCover"},$_={ctor:"ReSharperCpp"},Q_={ctor:"ReSharper"},rl={ctor:"GoLand"},tl={ctor:"AppCode"},el={ctor:"DataGrip"},nl={ctor:"CLion"},ol={ctor:"WebStorm"},cl={ctor:"RubyMine"},ul={ctor:"PyCharm"},il={ctor:"PhpStorm"},al={ctor:"IntelliJ"},_l={ctor:"JetBrains"},ll=function(r){switch(r){case"jetbrains":return _l;case"intellij-idea":return al;case"phpstorm":return il;case"pycharm":return ul;case"rubymine":return cl;case"webstorm":return ol;case"clion":return nl;case"datagrip":return el;case"appcode":return tl;case"goland":return rl;case"resharper":return Q_;case"resharper-cpp":return $_;case"dotcover":return Z_;case"dotmemory":return X_;case"dotpeek":return K_;case"dottrace":return Y_;case"rider":return j_;case"teamcity":return W_;case"youtrack":return U_;case"upsource":return J_;case"hub":return H_;case"kotlin":return G_;case"mps":return D_;default:return V_}},sl={src:"\n\n        // Precision\n        precision mediump float;\n        precision mediump int;\n\n        // Varyings\n        varying vec4 vColor;\n        varying vec4 vColor1;\n        varying vec4 vColor2;\n        varying vec3 vPosition;\n        //varying vec3 vMirror;\n\n        uniform vec3 uResolution;\n        uniform float uNow;\n        uniform vec2 uClip;\n        uniform vec2 uScale;\n        uniform float uVignette;\n        uniform float uIris;\n        uniform float uOpacity;\n        uniform int uLayerIndex;\n\n\n       // vec4 bgColor = vec4(0.0, 0.0, 0.0, 1.0);\n\n       bool midLayer = false;\n\n\n        float noise(vec2 seed, float time) {\n            float x = (seed.x / 3.14159 + 4.0) * (seed.y / 13.0 + 4.0) * ((fract(time) + 1.0) * 10.0);\n            return mod((mod(x, 13.0) + 1.0) * (mod(x, 123.0) + 1.0), 0.01) - 0.005;\n        }\n\n        float brightness(vec3 color) {\n                return (0.2126 * color.r + 0.7152 * color.g + 0.0722 * color.b);\n        }\n\n        vec3 rgb2hsv(vec3 c){\n        vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n        vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n        vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n        float d = q.x - min(q.w, q.y);\n        float e = 1.0e-10;\n        return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n        }\n\n        vec3 hsv2rgb(vec3 c)\n        {\n        vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n        vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n        return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n        }\n\n        vec4 adjustColor(vec4 origColor, float deltaHue, float deltaSaturation, float deltaBrightness) {\n\n        vec3 changedColor  = rgb2hsv(origColor.rgb);\n        changedColor[0] = mod(changedColor[0] + deltaHue, 1.0); // hue shift\n        changedColor[1] = clamp(changedColor[1] + deltaSaturation, 0.0, 1.0); // saturation shift\n        changedColor[2] = clamp(changedColor[2] + deltaBrightness, 0.0, 1.0); // brightness shift\n\n        return vec4(vec3(hsv2rgb(changedColor)), 1.0);\n        }\n\n\n\n        // Main\n        void main() {\n\n        if ( uLayerIndex == 1 ) {\n              midLayer = true;\n           }\n\n\n            vec2 actPos = gl_FragCoord.xy / uResolution.xy;\n\n            //if (actPos.x < 0.5) discard;\n            // if ((vMirror.x >= 0.0) && (vMirror.y >= 0.0)) {\n\n            // }\n\n            // here uClip.y is not Y coord, but upper limit for X\n            if ((uClip.x >= 0.0) || (uClip.y >= 0.0)) {\n                if ((actPos.x <= uClip.x) || (actPos.x >= uClip.y)) {\n                    discard;\n                }\n            }\n             gl_FragColor = vColor;\n\n\n            // fog\n            vec3 shadowHSV = rgb2hsv(vColor1.rgb);\n            shadowHSV[2] *=  uVignette + 0.1;\n            vec3 shadowRGB = hsv2rgb(shadowHSV);\n            gl_FragColor.rgb =  mix(gl_FragColor.rgb, shadowRGB, smoothstep(0.0, 1.3 - uIris, distance(actPos, vec2(0.5))));\n\n            // noise by brightness\n            if ( midLayer ) {\n               gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(noise(actPos * 1000.0, 1.0) * 100.0), 0.02 / pow(brightness(gl_FragColor.rgb), 0.1));\n            }\n\n\n            gl_FragColor.a = uOpacity;\n\n\n             //gl_FragColor.rgb *= gl_FragColor.a;\n\n\n\n\n        }\n\n    "},fl={src:"\n\n\n        // Precision\n        precision mediump float;\n        precision mediump int;\n\n        // Attributes\n        attribute float aSide;\n        attribute vec3 aPosition;\n        attribute vec3 aCentroid;\n        attribute vec3 aNormal;\n        attribute vec4 materialAmbient;\n        attribute vec4 materialDiffuse;\n        attribute vec4 aGradient;\n        attribute vec3 aV0;\n\n        attribute float aPhi;\n\n\n        // Uniforms\n        uniform mat4 cameraTranslate;\n        uniform mat4 cameraRotate;\n        uniform mat4 perspective;\n        uniform mat4 camera;\n        uniform mat4 rotation;\n\n\n        uniform vec3 uResolution;\n        uniform vec2 uScale;\n\n        uniform vec3 uSegment;\n        uniform bool paused;\n        uniform float uNow;\n        uniform int uLayerIndex;\n\n        uniform mat4 uLightPosition;\n        uniform mat4 uLightAmbient;\n        uniform mat4 uLightDiffuse;\n        uniform float uLightSpeed;\n\n        uniform vec3 uAmplitude;\n        uniform vec3 uColorShift;\n        uniform float uOpacity;\n\n        uniform vec2 uMousePosition;\n        uniform int uProductId;\n        uniform float uMirror;\n        uniform vec2 uClip;\n\n        // Varyings\n        varying vec4 vColor;\n        varying vec4 vColor1;\n        varying vec4 vColor2;\n        varying vec3 vPosition;\n        //varying vec3 vMirror;\n\n\n       float time = uNow;\n       vec3 position = vec3(0.0);\n       bool background = false;\n       bool midLayer = false;\n\n       //       vec3 vertexOscillators(vec3 arg) {\n       //     return vec3(sin(arg[0]), cos(arg[1]), sin(arg[2]));\n       // }\n\n\n\n       vec3 vertexOscillators(vec3 arg) {\n            return vec3(sin(arg[0]), cos(arg[1]), sin(arg[2]));\n        }\n\n        vec3 lightOscillators(vec3 arg) {\n           // return vec3( 2.0 * sin( 5.0 * arg[0]), sin( 6.0 * arg[1]), sin(arg[2]));\n\n             return vec3(\n                 cos(3.0 * arg[0]),\n                 sin(2.0 * arg[1]),\n                  sin(arg[2])\n                  );\n\n\n        }\n\n        vec3 rgb2hsv(vec3 c){\n                vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n                vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n                vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n                float d = q.x - min(q.w, q.y);\n                float e = 1.0e-10;\n                return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n            }\n\n        vec3 hsv2rgb(vec3 c){\n            vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n            vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n            return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n        }\n\n        vec4 adjustLight(vec4 origColor, vec3 hsb) {\n            vec3 changedColor  = rgb2hsv(origColor.rgb);\n            changedColor[0] = clamp(changedColor[0] + hsb[0], 0.0, 1.0); // hue shift\n            changedColor[1] = clamp(changedColor[1] + hsb[1], 0.0, 1.0); // saturation shift\n            changedColor[2] = clamp(changedColor[2] + hsb[2], 0.0, 1.0); // brightness shift\n            return vec4(vec3(hsv2rgb(changedColor)), 1.0);\n        }\n\n\n        // Main\n        void main() {\n\n           if ( uLayerIndex == 0 ) {\n\n               background = true;\n\n           }\n\n            if ( uLayerIndex == 1 ) {\n              midLayer = true;\n           }\n\n\n            float phase = aPhi;\n            vec3 speed = normalize(aV0) * 0.0007;\n\n            // Create color\n             vColor1 = materialAmbient;\n             vColor2 = materialDiffuse;\n             vColor = vec4(1.0);\n\n            // Calculate the vertex position\n            vec3 amplitudes = uAmplitude * uSegment;\n\n            // Light geometry and magnitudes\n            vec3 orbitFactor = !background ? vec3(2.5, 2.5, 2.5) : vec3(-2.5, 1.5, 1.2) ;\n            vec3 lightsSpeed = !background ? vec3(uLightSpeed * 40.0, uLightSpeed  * 10.0, 100.0) : vec3(uLightSpeed, uLightSpeed  * 5.0, 150.0) ;\n\n\n\n            position = aPosition;\n            position += amplitudes * vertexOscillators(speed * time + phase);\n            position /= uResolution * vec3(uScale, 1.0);\n            position *= 4.0;\n\n            vec4 light1 = vec4(0.0);\n            vec4 light2 = vec4(0.0);\n            vec3 deltaHSVLight1 = vec3(0.0);\n            vec3 deltaHSVLight2 = vec3(0.0);\n            float shine = 1.0;\n\n            // hue shift in shadows\n            vec3 shadowColor = rgb2hsv( aGradient.rgb );\n\n\n            if( uProductId == 0 ) { //JetBrains\n                shadowColor[0] -= 0.25;\n                shadowColor[1] = 1.0;\n                shadowColor[2] *= 0.5;\n            }\n\n            if( uProductId == 1 ) { //IntelliJ IDEA\n                deltaHSVLight1 = vec3( 0.0, 0.0, -0.2 );\n                deltaHSVLight2 = vec3( -0.1, 1.0, 1.0 );\n                shadowColor[0] -= 0.2;\n                shadowColor[1] = 0.9;\n                shadowColor[2] *= 0.9;\n                shine = 1.1;\n                orbitFactor[1] += 2.5;\n            }\n\n            if( uProductId == 2 ) { //PyCharm\n                deltaHSVLight1 = vec3( 0.1, 0.0, 0.2 );\n                deltaHSVLight2 = vec3( -0.1, 0.0, -0.4 );\n                shadowColor[0] -= 0.4;\n                shadowColor[1] = 0.9;\n                shadowColor[2] *= 0.4;\n                orbitFactor[2] -= 0.5;\n            }\n\n            if( uProductId == 3 ) { //RubyMine\n                deltaHSVLight1 = vec3( 0.1, 1.0, 0.2 );\n                deltaHSVLight2 = vec3( -0.1, 1.0, 0.4 );\n                shadowColor[0] += 0.3;\n                shadowColor[1] = 0.3;\n                shadowColor[2] *= 0.4;\n                shine = 1.1;\n                orbitFactor[1] += 1.5;\n            }\n\n            if( uProductId == 5 ) { //WebStorm\n                deltaHSVLight1 = vec3( 0.0, 0.5, -0.1 );\n                deltaHSVLight2 = vec3( 0.1, 1.0, 0.7 );\n                shadowColor[0] -= 0.1;\n                shadowColor[1] = 0.5;\n                shadowColor[2] *= 0.5;\n                shine = 1.1;\n                orbitFactor[1] += 1.5;\n            }\n            if( uProductId == 6 ) { //CLion\n                deltaHSVLight1 = vec3( -0.04, 1.0, -0.1 );\n                deltaHSVLight2 = vec3( 0.0, 1.0, 0.9 );\n                shadowColor[0] -= 0.2;\n                shadowColor[1] = 0.9;\n                shadowColor[2] *= 0.5;\n                shine = 1.3;\n                orbitFactor[0] += 0.5;\n            }\n            if( uProductId == 7 ) { //DataGrip\n                deltaHSVLight1 = vec3( -0.18, 0.9, 0.8 );\n                deltaHSVLight2 = vec3( 0.0, 0.4, 0.8 );\n                shadowColor[0] -= 0.2;\n                shadowColor[1] = 0.4;\n                shadowColor[2] *= 0.4;\n                shine = 1.4;\n                orbitFactor[0] -= 1.5;\n            }\n            if( uProductId == 8 ) { //AppCode\n                deltaHSVLight1 = vec3( -0.03, 0.9, 0.1 );\n                deltaHSVLight2 = vec3( 0.0, 0.9, -0.1 );\n                shadowColor[0] -= 0.2;\n                shadowColor[1] = 0.9;\n                shadowColor[2] *= 0.2;\n                orbitFactor[1] -= 1.5;\n            }\n\n            if( uProductId == 9 ) { //GoLand\n                deltaHSVLight1 = vec3( 0.1, 0.8, 0.9 );\n                deltaHSVLight2 = vec3( 0.0, 0.6, 0.9 );\n                shadowColor[0] -= 0.2;\n                shadowColor[1] = 0.8;\n                shadowColor[2] *= 0.4;\n                orbitFactor[1] += 1.5;\n            }\n            if( uProductId == 10 ) { //ReSharper\n                deltaHSVLight1 = vec3( -0.01, 0.8, -0.1 );\n                deltaHSVLight2 = vec3( 0.0, 0.6, 1.0 );\n                shadowColor[0] -= 0.2;\n                shadowColor[1] = 0.8;\n                shadowColor[2] *= 0.5;\n                orbitFactor[1] -= 2.0;\n            }\n            if( uProductId == 11 ) { //ReSharper C++\n                deltaHSVLight1 = vec3( -0.02, 0.8, -0.1 );\n                deltaHSVLight2 = vec3( 0.0, 0.6, 1.0 );\n                shadowColor[0] -= 0.3;\n                shadowColor[1] = 0.9;\n                shadowColor[2] *= 0.3;\n                orbitFactor[1] -= 2.0;\n            }\n\n            if( uProductId == 12 ) { //dotCover\n                deltaHSVLight1 = vec3( 0.25, 1.0, 0.5 );\n                deltaHSVLight2 = vec3( -0.64, 1.0, 1.0 );\n                shadowColor[0] -= 0.2;\n                shadowColor[1] = 1.0;\n                shadowColor[2] *= 0.7;\n                orbitFactor[2] += 1.0;\n            }\n            if( uProductId == 13 ) { //dotMemory\n                deltaHSVLight1 = vec3( -0.45, 0.4, 0.9 );\n                deltaHSVLight2 = vec3( -0.2, -0.8, 0.7 );\n                shadowColor[0] -= 0.2;\n                shadowColor[1] = 0.8;\n                shadowColor[2] *= 0.4;\n                orbitFactor[2] += 1.0;\n            }\n\n            if( uProductId == 14 ) { //dotPeek\n                deltaHSVLight1 = vec3( 0.0, -0.7, -0.3 );\n                deltaHSVLight2 = vec3( 0.0, 0.0, 1.0 );\n                shadowColor[0] -= 0.2;\n                shadowColor[1] = 0.5;\n                orbitFactor[1] += 1.5;\n            }\n\n            if( uProductId == 15 ) { //dotTrace\n                deltaHSVLight1 = vec3( 0.2, 0.4, -0.1 );\n                deltaHSVLight2 = vec3( -0.2, 1.0, 0.3 );\n                shadowColor[0] -= 0.2;\n                shadowColor[1] = 0.8;\n            }\n\n            if( uProductId == 16 ) { //Rider\n                deltaHSVLight1 = vec3( 0.15, 0.5, 0.0 );\n                deltaHSVLight2 = vec3( 0.0, 0.0, 1.0 );\n                shadowColor[0] -= 0.2;\n                shadowColor[1] = 0.5;\n            }\n\n            if( uProductId == 17 ) { //Teamcity\n                deltaHSVLight1 = vec3( 0.0, -0.2, -0.2 );\n                deltaHSVLight2 = vec3( -0.2, 1.0, 0.3 );\n                shadowColor[0] -= 0.2;\n                shadowColor[1] = 0.7;\n                shadowColor[2] *= 0.8;\n                orbitFactor[1] += 1.0;\n            }\n\n            if( uProductId == 18 ) { //YouTrack\n                deltaHSVLight1 = vec3( 0.0, -0.4, -0.2 );\n                deltaHSVLight2 = vec3( 0.1, 1.0, 0.3 );\n                shadowColor[0] -= 0.2;\n                shadowColor[1] = 0.7;\n                shadowColor[2] *= 0.8;\n                orbitFactor[1] += 1.0;\n            }\n\n            if( uProductId == 19 ) { //Upsource\n                deltaHSVLight1 = vec3( 0.0, -0.3, -0.2 );\n                deltaHSVLight2 = vec3( 0.1, 1.0, 0.3 );\n                shadowColor[0] -= 0.2;\n                shadowColor[1] = 0.7;\n                shadowColor[2] *= 0.8;\n                orbitFactor[1] += 1.0;\n            }\n\n            if( uProductId == 20 ) { //Hub\n                deltaHSVLight1 = vec3( 0.05, -0.4, -0.1 );\n                deltaHSVLight2 = vec3( 0.0, 0.9, 0.4 );\n                shadowColor[0] -= 0.2;\n                shadowColor[1] = 0.9;\n                shadowColor[2] *= 0.5;\n                orbitFactor[1] += 1.5;\n            }\n\n            if( uProductId == 21 ) { //Kotlin\n                deltaHSVLight1 = vec3( 0.0, -0.2, -0.2 );\n                deltaHSVLight2 = vec3( 0.06, 1.0, 0.1 );\n                shadowColor[0] -= 0.2;\n                shadowColor[1] = 0.9;\n                shadowColor[2] *= 0.8;\n                orbitFactor[1] += 1.0;\n            }\n\n            if( uProductId == 22 ) { //MPS\n                deltaHSVLight1 = vec3( 0.0, -0.2, 0.2 );\n                deltaHSVLight2 = vec3( 0.0, 0.7, -0.3 );\n                shadowColor[0] -= 0.2;\n                shadowColor[1] = 0.7;\n                shadowColor[2] *= 0.6;\n                orbitFactor[1] += 1.0;\n            }\n\n            // Iterate through lights\n\n            for (int i = 0; i < 2; i++) {\n\n          //  if(uLayerIndex != 0) {\n                vec3 lightPosition = orbitFactor[i] * vec3(uLightPosition[i]) * lightOscillators(vec3(vec2(uNow / lightsSpeed[i]), 90.0)) ;\n\n                if ( background ) {\n                    light1 =  adjustLight(uLightDiffuse[i], uColorShift);\n                    light2 =  adjustLight(uLightAmbient[i], uColorShift);\n                } else {\n                    light1 =  adjustLight(uLightAmbient[i], deltaHSVLight1 + uColorShift);\n                    light2 =  adjustLight(uLightDiffuse[i], deltaHSVLight2 + uColorShift);\n                }\n\n                vec3 ray = normalize(lightPosition - aCentroid);\n                float illuminance = dot(aNormal, ray);\n                illuminance = shine * max(illuminance, 0.0);\n\n\n                // Calculate ambient light\n                  vColor *=  light1;\n\n                // Calculate diffuse light\n                  vColor +=  light2 * illuminance;\n\n            }\n\n       //Chaotic shadows\n\n             vColor *=  mix(vec4(hsv2rgb(shadowColor), 1.0), vColor, abs(position.z));\n\n           // Set gl_Position\n             gl_Position = cameraRotate * cameraTranslate * vec4(position, 1.0);\n\n\n          if (uMirror > 0.0) {\n              gl_Position.x = -1.0 * gl_Position.x;\n          }\n\n        }\n\n   "},dl=o(function(r,t,e,n,o){var c=e,u=c._3,i=c._2,a=c._1,_=c._0,l=n,s=l._3,f=l._2,d=l._1,p=l._0,h=o,m=h._3,g=h._2,v=h._1,b=h._0;return{ambient:Be(Ne({m11:Ze(_),m12:Xe(_),m13:Ke(_),m14:Ye(_),m21:Ze(a),m22:Xe(a),m23:Ke(a),m24:Ye(a),m31:Ze(i),m32:Xe(i),m33:Ke(i),m34:Ye(i),m41:Ze(u),m42:Xe(u),m43:Ke(u),m44:Ye(u)})),diffuse:Be(Ne({m11:Ze(p),m12:Xe(p),m13:Ke(p),m14:Ye(p),m21:Ze(d),m22:Xe(d),m23:Ke(d),m24:Ye(d),m31:Ze(f),m32:Xe(f),m33:Ke(f),m34:Ye(f),m41:Ze(s),m42:Xe(s),m43:Ke(s),m44:Ye(s)})),position:Be(Ne({m11:Ae(b),m12:Re(b),m13:Le(b),m14:0,m21:Ae(v),m22:Re(v),m23:Le(v),m24:0,m31:Ae(g),m32:Re(g),m33:Le(g),m34:0,m41:Ae(m),m42:Re(m),m43:Le(m),m44:0})),speed:t}}),pl=function(r){return{ambient:(n=r.ambient.rgba,"::"===n.ctor&&"::"===n._1.ctor&&"::"===n._1._1.ctor&&"::"===n._1._1._1.ctor?s($e,n._0,n._1._0,n._1._1._0,n._1._1._1._0):s($e,0,0,0,0)),diffuse:(e=r.diffuse.rgba,"::"===e.ctor&&"::"===e._1.ctor&&"::"===e._1._1.ctor&&"::"===e._1._1._1.ctor?s($e,e._0,e._1._0,e._1._1._0,e._1._1._1._0):s($e,0,0,0,0)),position:(t=r.position,"::"===t.ctor&&"::"===t._1.ctor&&"::"===t._1._1.ctor?l(Ee,t._0,t._1._0,t._1._1._0):l(Ee,0,0,0))};var t,e,n},hl=e(function(r,t,e){var n=_(X,pl,e),o=l(Ee,0,0,0),c=s($e,0,0,0,0),u=n;if("::"===u.ctor){if("[]"===u._1.ctor){var i=u._0,a={ctor:"_Tuple4",_0:i.position,_1:o,_2:o,_3:o},d={ctor:"_Tuple4",_0:i.diffuse,_1:c,_2:c,_3:c},p={ctor:"_Tuple4",_0:i.ambient,_1:c,_2:c,_3:c};return f(dl,r,t,p,d,a)}if("[]"===u._1._1.ctor){var h=u._1._0,m=u._0;a={ctor:"_Tuple4",_0:m.position,_1:h.position,_2:o,_3:o},d={ctor:"_Tuple4",_0:m.diffuse,_1:h.diffuse,_2:c,_3:c},p={ctor:"_Tuple4",_0:m.ambient,_1:h.ambient,_2:c,_3:c};return f(dl,r,t,p,d,a)}if("[]"===u._1._1._1.ctor){var g=u._1._1._0,v=u._1._0,b=u._0;a={ctor:"_Tuple4",_0:b.position,_1:v.position,_2:g.position,_3:o},d={ctor:"_Tuple4",_0:b.diffuse,_1:v.diffuse,_2:g.diffuse,_3:c},p={ctor:"_Tuple4",_0:b.ambient,_1:v.ambient,_2:g.ambient,_3:c};return f(dl,r,t,p,d,a)}var y=u._1._1._1._0,T=u._1._1._0,w=u._1._0,S=u._0;a={ctor:"_Tuple4",_0:S.position,_1:w.position,_2:T.position,_3:y.position},d={ctor:"_Tuple4",_0:S.diffuse,_1:w.diffuse,_2:T.diffuse,_3:y.diffuse},p={ctor:"_Tuple4",_0:S.ambient,_1:w.ambient,_2:T.ambient,_3:y.ambient};return f(dl,r,t,p,d,a)}return{ambient:De,diffuse:De,position:De,speed:t}}),ml=function(r){switch(r.ctor){case"Triangles":return"triangles";case"Lines":return"lines";case"PartialLines":return"partial-lines";default:return"points"}},gl=function(r){var t=r;return"::"===t.ctor?"::"===t._1.ctor?"::"===t._1._1.ctor?"::"===t._1._1._1.ctor?s($e,t._0,t._1._0,t._1._1._0,t._1._1._1._0):s($e,t._0,t._1._0,t._1._1._0,0):s($e,t._0,t._1._0,0,0):s($e,t._0,0,0,0):s($e,0,0,0,0)},vl=function(r){var t=r;return"::"===t.ctor?"::"===t._1.ctor?"::"===t._1._1.ctor?l(Ee,t._0,t._1._0,t._1._1._0):l(Ee,t._0,t._1._0,0):l(Ee,t._0,0,0):l(Ee,0,0,0)},bl=o(function(r,t,e,n,o){return{aSide:n,materialAmbient:gl(t.ambient.rgba),materialDiffuse:gl(t.diffuse.rgba),aPosition:vl(o.position),aCentroid:vl(e.centroid),aNormal:vl(e.normal),aGradient:r,aV0:vl(o.v0),aPhi:o.time}}),yl=(po({ctor:"[]"}),{materialAmbient:s($e,0,0,0,0),aCentroid:l(Ee,0,0,0),materialDiffuse:s($e,0,0,0,0),aNormal:l(Ee,0,0,0),aPosition:l(Ee,0,0,0),aSide:0,aGradient:s($e,0,0,0,0),aV0:l(Ee,0,0,0),aPhi:0}),Tl=e(function(r,e,n){return _(fr,t(function(t,n){var o=n.vertices;if("::"===o.ctor&&"::"===o._1.ctor&&"::"===o._1._1.ctor){var c=o._1._0,u=o._0;return{ctor:"_Tuple3",_0:f(bl,s($e,u.gradient,u.gradient,u.gradient,1),r,n,e,u),_1:f(bl,s($e,u.gradient,u.gradient,u.gradient,1),r,n,e,c),_2:f(bl,s($e,c.gradient,c.gradient,c.gradient,1),r,n,e,o._1._1._0)}}return{ctor:"_Tuple3",_0:yl,_1:yl,_2:yl}}),n)}),wl=t(function(r,e){var n=_(R,{ctor:"[]"},_(E,function(r){var t=Y(r.meshes);if("Just"===t.ctor){var e=t._0;return l(Tl,e.material,e.side,e.geometry.triangles)}return{ctor:"[]"}},e));switch(r.renderMode.ctor){case"Triangles":return po(n);case"PartialLines":return fo(_(X,function(r){var t=r;return{ctor:"_Tuple2",_0:t._0,_1:t._1}},n));case"Lines":return fo(l(H,t(function(r,t){var e=r,n=e._1;return _(C["++"],t,_(C["++"],{ctor:"::",_0:{ctor:"_Tuple2",_0:e._0,_1:n},_1:{ctor:"[]"}},{ctor:"::",_0:{ctor:"_Tuple2",_0:n,_1:e._2},_1:{ctor:"[]"}}))}),{ctor:"[]"},n));default:return so(l(H,t(function(r,t){var e=r;return _(C["++"],t,_(C["++"],{ctor:"::",_0:e._0,_1:{ctor:"[]"}},_(C["++"],{ctor:"::",_0:e._1,_1:{ctor:"[]"}},{ctor:"::",_0:e._2,_1:{ctor:"[]"}})))}),{ctor:"[]"},n))}}),Sl={ctor:"_Tuple2",_0:-1,_1:-1},kl=i(function(r,t,e,n,o,c,u,i){var a=u,s=(o.opacity,o.colorShift),f=s._0,d=s._1,p=s._2,h=o.amplitude,m=h._0,g=h._1,v=h._2,b=_(R,Sl,o.clip),y=o.mirror?1:0,w=Je(n.size),S=Ue(n.size),k=c,x=k._0,C=k._1,F=l(hl,c,a._1,a._0);return{uResolution:l(Ee,S,w,100),uLightAmbient:F.ambient,uLightDiffuse:F.diffuse,uLightPosition:F.position,uLightSpeed:F.speed,uNow:r,uLayerIndex:i,uMousePosition:_(We,T(ce(t)),T(oe(t))),uSegment:l(Ee,100,100,50),uMirror:y,uClip:_(We,ce(b),oe(b)),uScale:_(We,T(x)/S,T(C)/w),uAmplitude:l(Ee,m,g,v),uColorShift:l(Ee,f,d,p),uOpacity:o.opacity,uVignette:o.vignette,uIris:o.iris,paused:n.paused,rotation:n.rotation,perspective:n.perspective,camera:n.camera,cameraTranslate:n.cameraTranslate,cameraRotate:n.cameraRotate,size:n.size,origin:n.origin,uProductId:e}}),xl=a(function(r,t,e,n,o,c,u,i,a){var l,s,d,p,h,m,g,v,b,y,T=_(R,{ctor:"_Tuple2",_0:0,_1:0},_(E,function(r){var t=r;if("Just"===t.ctor){var e=t._0;return{ctor:"_Tuple2",_0:e.geometry.width,_1:e.geometry.height}}return{ctor:"_Tuple2",_0:0,_1:0}},_(E,function(r){return Y(r.meshes)},u))),w=_(R,{ctor:"[]"},_(E,function(r){return r.lights},u)),S="::"===(l=w).ctor?l._0.speed:0;return f(lo,i,fl,sl,a,(d=r,p=t,h=e,m=o,g=c,v=T,b={ctor:"_Tuple2",_0:w,_1:S},y=n,8===(s=kl).arity?s.func(d,p,h,m,g,v,b,y):s(d)(p)(h)(m)(g)(v)(b)(y)))}),Cl=(e(function(r,t,e){return{rgba:r,hex:t,opacity:e}}),o(function(r,t,e,n,o){return{ambient:r,diffuse:t,speed:e,position:n,ray:o}}),e(function(r,t,e){return{ambient:r,diffuse:t,slave:e}}),c(function(r,t,e,n,o,c){return{width:r,height:t,triangles:e,vertices:n,segmentWidth:o,sliceHeight:c}}),a(function(r,t,e,n,o,c,u,i,a){return{a:r,b:t,c:e,centroid:n,color:o,normal:c,u:u,v:i,vertices:a}}),o(function(r,t,e,n,o){return{position:r,v0:t,anchor:e,time:n,gradient:o}}),n(function(r,t,e,n){return{geometry:r,material:t,position:e,side:n}}),t(function(r,t){return{lights:r,meshes:t}}),a(function(r,t,e,n,o,c,u,i,a){return{materialAmbient:r,materialDiffuse:t,aCentroid:e,aNormal:n,aPosition:o,aSide:c,aGradient:u,aV0:i,aPhi:a}}),n(function(r,t,e,n){return{vColor:r,vPosition:t,vColor1:e,vColor2:n}}),{ctor:"Points"}),Fl={ctor:"PartialLines"},Ll={ctor:"Lines"},Rl={ctor:"Triangles"},Al={faces:{ctor:"_Tuple2",_0:17,_1:17},renderMode:Rl,amplitude:{ctor:"_Tuple3",_0:.3,_1:.3,_2:.3},colorShift:{ctor:"_Tuple3",_0:0,_1:0,_2:0},opacity:1,vignette:0,iris:.07,mirror:!1,clip:A,lightSpeed:1e3,shareMesh:!1},Ml=function(r){switch(r){case"triangles":return Rl;case"lines":return Ll;case"partial-lines":return Fl;case"points":return Cl;default:return Rl}},Pl={src:'\n\nprecision mediump float;\n\nvarying float antialiasing;\nvarying float aoIterations;\nvarying float bailout;\nvarying float maxIterations;\nvarying float minRange;\nvarying float stepLimit;\n\n/**\n* Fractal Lab\'s uber 3D fractal shader\n* Last update: 26 February 2011\n*\n* Changelog:\n*      0.1     - Initial release\n*      0.2     - Refactor for Fractal Lab\n*\n*\n* Copyright 2011, Tom Beddard\n* http://www.subblue.com\n*\n* For more generative graphics experiments see:\n* http://www.subblue.com\n*\n* Licensed under the GPL Version 3 license.\n* http://www.gnu.org/licenses/\n*\n*\n* Credits and references\n* ======================\n*\n* http://www.fractalforums.com/3d-fractal-generation/a-mandelbox-distance-estimate-formula/\n* http://www.fractalforums.com/3d-fractal-generation/revenge-of-the-half-eaten-menger-sponge/msg21700/\n* http://www.fractalforums.com/index.php?topic=3158.msg16982#msg16982\n*\n* Various other discussions on the fractal can be found here:\n* http://www.fractalforums.com/3d-fractal-generation/\n*\n*\n*/\n\n\nuniform float scale;                // {"label":"Scale",        "min":-10,  "max":10,   "step":0.01,     "default":2,    "group":"Fractal", "group_label":"Fractal parameters"}\nuniform float power;                // {"label":"Power",        "min":-20,  "max":20,   "step":0.1,     "default":8,    "group":"Fractal"}\nuniform float surfaceDetail;        // {"label":"Detail",   "min":0.1,  "max":2,    "step":0.01,    "default":0.6,  "group":"Fractal"}\nuniform float surfaceSmoothness;    // {"label":"Smoothness",   "min":0.01,  "max":1,    "step":0.01,    "default":0.8,  "group":"Fractal"}\nuniform float boundingRadius;       // {"label":"Bounding radius", "min":0.1, "max":150, "step":0.01, "default":5, "group":"Fractal"}\nuniform vec3  offset;               // {"label":["Offset x","Offset y","Offset z"],  "min":-3,   "max":3,    "step":0.01,    "default":[0,0,0],  "group":"Fractal", "group_label":"Offsets"}\nuniform vec3  shift;                // {"label":["Shift x","Shift y","Shift z"],  "min":-3,   "max":3,    "step":0.01,    "default":[0,0,0],  "group":"Fractal"}\n\nuniform float cameraRoll;           // {"label":"Roll",         "min":-180, "max":180,  "step":0.5,     "default":0,    "group":"Camera", "group_label":"Camera parameters"}\nuniform float cameraPitch;          // {"label":"Pitch",        "min":-180, "max":180,  "step":0.5,     "default":0,    "group":"Camera"}\nuniform float cameraYaw;            // {"label":"Yaw",          "min":-180, "max":180,  "step":0.5,     "default":0,    "group":"Camera"}\nuniform float cameraFocalLength;    // {"label":"Focal length", "min":0.1,  "max":3,    "step":0.01,    "default":0.9,  "group":"Camera"}\nuniform vec3  cameraPosition;       // {"label":["Camera x", "Camera y", "Camera z"],   "default":[0.0, 0.0, -2.5], "control":"camera", "group":"Camera", "group_label":"Position"}\n\nuniform int   colorIterations;      // {"label":"Colour iterations", "default": 4, "min":0, "max": 30, "step":1, "group":"Colour", "group_label":"Base colour"}\nuniform vec3  color1;               // {"label":"Colour 1",  "default":[1.0, 1.0, 1.0], "group":"Colour", "control":"color"}\nuniform float color1Intensity;      // {"label":"Colour 1 intensity", "default":0.45, "min":0, "max":3, "step":0.01, "group":"Colour"}\nuniform vec3  color2;               // {"label":"Colour 2",  "default":[0, 0.53, 0.8], "group":"Colour", "control":"color"}\nuniform float color2Intensity;      // {"label":"Colour 2 intensity", "default":0.3, "min":0, "max":3, "step":0.01, "group":"Colour"}\nuniform vec3  color3;               // {"label":"Colour 3",  "default":[1.0, 0.53, 0.0], "group":"Colour", "control":"color"}\nuniform float color3Intensity;      // {"label":"Colour 3 intensity", "default":0, "min":0, "max":3, "step":0.01, "group":"Colour"}\nuniform int   transparent;          // {"label":"Transparent background", "default":false, "group":"Colour"}\nuniform float gamma;                // {"label":"Gamma correction", "default":1, "min":0.1, "max":2, "step":0.01, "group":"Colour"}\n\nuniform vec3  light;                // {"label":["Light x", "Light y", "Light z"], "default":[-16.0, 100.0, -60.0], "min":-300, "max":300,  "step":1,   "group":"Shading", "group_label":"Light position"}\nuniform vec2  ambientColor;         // {"label":["Ambient intensity", "Ambient colour"],  "default":[0.5, 0.3], "group":"Colour", "group_label":"Ambient light & background"}\nuniform vec3  background1Color;     // {"label":"Background top",   "default":[0.0, 0.46, 0.8], "group":"Colour", "control":"color"}\nuniform vec3  background2Color;     // {"label":"Background bottom", "default":[0, 0, 0], "group":"Colour", "control":"color"}\nuniform vec3  innerGlowColor;       // {"label":"Inner glow", "default":[0.0, 0.6, 0.8], "group":"Shading", "control":"color", "group_label":"Glows"}\nuniform float innerGlowIntensity;   // {"label":"Inner glow intensity", "default":0.1, "min":0, "max":1, "step":0.01, "group":"Shading"}\nuniform vec3  outerGlowColor;       // {"label":"Outer glow", "default":[1.0, 1.0, 1.0], "group":"Shading", "control":"color"}\nuniform float outerGlowIntensity;   // {"label":"Outer glow intensity", "default":0.0, "min":0, "max":1, "step":0.01, "group":"Shading"}\nuniform float fog;                  // {"label":"Fog intensity",          "min":0,    "max":1,    "step":0.01,    "default":0,    "group":"Shading", "group_label":"Fog"}\nuniform float fogFalloff;           // {"label":"Fog falloff",  "min":0,    "max":10,   "step":0.01,    "default":0,    "group":"Shading"}\nuniform float specularity;          // {"label":"Specularity",  "min":0,    "max":3,    "step":0.01,    "default":0.8,  "group":"Shading", "group_label":"Shininess"}\nuniform float specularExponent;     // {"label":"Specular exponent", "min":0, "max":50, "step":0.1,     "default":4,    "group":"Shading"}\n\nuniform vec2  size;                 // {"default":[400, 300]}\nuniform vec2  outputSize;           // {"default":[800, 600]}\nuniform float aoIntensity;          // {"label":"AO intensity",     "min":0, "max":1, "step":0.01, "default":0.15,  "group":"Shading", "group_label":"Ambient occlusion"}\nuniform float aoSpread;             // {"label":"AO spread",    "min":0, "max":20, "step":0.01, "default":9,  "group":"Shading"}\n\nuniform mat3  objectRotation;       // {"label":["Rotate x", "Rotate y", "Rotate z"], "group":"Fractal", "control":"rotation", "default":[0,0,0], "min":-360, "max":360, "step":1, "group_label":"Object rotation"}\nuniform mat3  fractalRotation1;     // {"label":["Rotate x", "Rotate y", "Rotate z"], "group":"Fractal", "control":"rotation", "default":[0,0,0], "min":-360, "max":360, "step":1, "group_label":"Fractal rotation 1"}\nuniform mat3  fractalRotation2;     // {"label":["Rotate x", "Rotate y", "Rotate z"], "group":"Fractal", "control":"rotation", "default":[0,0,0], "min":-360, "max":360, "step":1, "group_label":"Fractal rotation 2"}\nuniform int   depthMap;             // {"label":"Depth map", "default": false, "value":1, "group":"Shading"}\n\nmat3 objectRotation_ = mat3(0, 0, 1, 0, 1, 0, 1, 0, 0);\nmat3 fractalRotation1_ = mat3(0, 0, 1, 0, 1, 0, 1, 0, 0);\nmat3 fractalRotation2_ = mat3(0, 0, 1, 0, 1, 0, 1, 0, 0);\n\n\nfloat aspectRatio = outputSize.x / outputSize.y;\nfloat fovfactor = 1.0 / sqrt(1.0 + cameraFocalLength * cameraFocalLength);\nfloat pixelScale = 1.0 / min(outputSize.x, outputSize.y);\nfloat epsfactor = 2.0 * fovfactor * pixelScale * surfaceDetail;\nvec3  w = vec3(0, 0, 1);\nvec3  v = vec3(0, 1, 0);\nvec3  u = vec3(1, 0, 0);\nmat3  cameraRotation;\n\n\nfloat HALFPI = 1.570796;\nfloat MIN_EPSILON = 6e-7;\nfloat MIN_NORM = 1.5e-7;\n\n\n// Return rotation matrix for rotating around vector v by angle\nmat3 rotationMatrixVector(vec3 v, float angle)\n{\n    float c = cos(radians(angle));\n    float s = sin(radians(angle));\n\n    return mat3(\n        c + (1.0 - c) * v.x * v.x,\n        (1.0 - c) * v.x * v.y - s * v.z,\n        (1.0 - c) * v.x * v.z + s * v.y,\n        (1.0 - c) * v.x * v.y + s * v.z,\n        c + (1.0 - c) * v.y * v.y,\n        (1.0 - c) * v.y * v.z - s * v.x,\n        (1.0 - c) * v.x * v.z - s * v.y,\n        (1.0 - c) * v.y * v.z + s * v.x,\n        c + (1.0 - c) * v.z * v.z\n    );\n}\n\n\nvec3 halfSpongeScale = vec3(0.5) * scale;\n\n// Adapted from Buddhis algorithm\n// http://www.fractalforums.com/3d-fractal-generation/revenge-of-the-half-eaten-menger-sponge/msg21700/\nvec3 MengerSponge(vec3 w)\n{\n    w *= objectRotation_;\n    w = (w * 0.5 + vec3(0.5)) * scale;  // scale [-1, 1] range to [0, 1]\n\n    vec3 v = abs(w - halfSpongeScale) - halfSpongeScale;\n    float d1 = max(v.x, max(v.y, v.z));     // distance to the box\n    float d = d1;\n    float p = 1.0;\n    float md = 10000.0;\n    vec3 cd = v;\n\n    for (int i = 0; i < 8; i++) {\n        vec3 a = mod(3.0 * w * p, 3.0);\n        p *= 3.0;\n\n        v = vec3(0.5) - abs(a - vec3(1.5)) + offset;\n        v *= fractalRotation1_;\n\n        // distance inside the 3 axis aligned square tubes\n        d1 = min(max(v.x, v.z), min(max(v.x, v.y), max(v.y, v.z))) / p;\n\n        // intersection\n        d = max(d, d1);\n\n        if (i < colorIterations) {\n            md = min(md, d);\n            cd = v;\n        }\n    }\n\n    // The distance estimate, min distance, and fractional iteration count\n    return vec3(d * 2.0 / scale, md, dot(cd, cd));\n}\n\n\n\n\n// Define the ray direction from the pixel coordinates\nvec3 rayDirection(vec2 pixel)\n{\n    vec2 p = (0.5 * size - pixel) / vec2(size.x, -size.y);\n    p.x *= aspectRatio;\n    vec3 d = (p.x * u + p.y * v - cameraFocalLength * w);\n\n    return normalize(cameraRotation * d);\n}\n\n\n\n// Intersect bounding sphere\n//\n// If we intersect then set the tmin and tmax values to set the start and\n// end distances the ray should traverse.\nbool intersectBoundingSphere(vec3 origin,\n                            vec3 direction,\n                            out float tmin,\n                            out float tmax)\n{\n    bool hit = false;\n    float b = dot(origin, direction);\n    float c = dot(origin, origin) - boundingRadius;\n    float disc = b*b - c;           // discriminant\n    tmin = tmax = 0.0;\n\n    if (disc > 0.0) {\n        // Real root of disc, so intersection\n        float sdisc = sqrt(disc);\n        float t0 = -b - sdisc;          // closest intersection distance\n        float t1 = -b + sdisc;          // furthest intersection distance\n\n        if (t0 >= 0.0) {\n            // Ray intersects front of sphere\n            tmin = t0;\n            tmax = t0 + t1;\n        } else if (t0 < 0.0) {\n            // Ray starts inside sphere\n            tmax = t1;\n        }\n        hit = true;\n    }\n\n    return hit;\n}\n\n\n\n\n// Calculate the gradient in each dimension from the intersection point\nvec3 generateNormal(vec3 z, float d)\n{\n    float e = max(d * 0.5, MIN_NORM);\n\n    float dx1 = MengerSponge(z + vec3(e, 0, 0)).x;\n    float dx2 = MengerSponge(z - vec3(e, 0, 0)).x;\n\n    float dy1 = MengerSponge(z + vec3(0, e, 0)).x;\n    float dy2 = MengerSponge(z - vec3(0, e, 0)).x;\n\n    float dz1 = MengerSponge(z + vec3(0, 0, e)).x;\n    float dz2 = MengerSponge(z - vec3(0, 0, e)).x;\n\n    return normalize(vec3(dx1 - dx2, dy1 - dy2, dz1 - dz2));\n}\n\n\n// Blinn phong shading model\n// http://en.wikipedia.org/wiki/BlinnPhong_shading_model\n// base color, incident, point of intersection, normal\nvec3 blinnPhong(vec3 color, vec3 p, vec3 n)\n{\n    // Ambient colour based on background gradient\n    vec3 ambColor = clamp(mix(background2Color, background1Color, (sin(n.y * HALFPI) + 1.0) * 0.5), 0.0, 1.0);\n    ambColor = mix(vec3(ambientColor.x), ambColor, ambientColor.y);\n\n    vec3  halfLV = normalize(light - p);\n    float diffuse = max(dot(n, halfLV), 0.0);\n    float specular = pow(diffuse, specularExponent);\n\n    return ambColor * color + color * diffuse + specular * specularity;\n}\n\n\n\n// Ambient occlusion approximation.\n// Based upon boxplorer\'s implementation which is derived from:\n// http://www.iquilezles.org/www/material/nvscene2008/rwwtt.pdf\nfloat ambientOcclusion(vec3 p, vec3 n, float eps)\n{\n    float o = 1.0;                  // Start at full output colour intensity\n    eps *= aoSpread;                // Spread diffuses the effect\n    float k = aoIntensity / eps;    // Set intensity factor\n    float d = 2.0 * eps;            // Start ray a little off the surface\n\n    for (int i = 0; i < 4; ++i) {\n        o -= (d - MengerSponge(p + n * d).x) * k;\n        d += eps;\n        k *= 0.5;                   // AO contribution drops as we move further from the surface\n    }\n\n    return clamp(o, 0.0, 1.0);\n}\n\n\n// Calculate the output colour for each input pixel\nvec4 render(vec2 pixel)\n{\n    vec3  ray_direction = rayDirection(pixel);\n    float ray_length = minRange;\n    vec3  ray = cameraPosition + ray_length * ray_direction;\n    vec4  bg_color = vec4(clamp(mix(background2Color, background1Color, (sin(ray_direction.y * HALFPI) + 1.0) * 0.5), 0.0, 1.0), 1.0);\n    vec4  color = bg_color;\n\n    float eps = MIN_EPSILON;\n    vec3  dist;\n    vec3  normal = vec3(0);\n    int   steps = 0;\n    bool  hit = false;\n    float tmin = 0.0;\n    float tmax = 10000.0;\n\n    if (intersectBoundingSphere(ray, ray_direction, tmin, tmax)) {\n        ray_length = tmin;\n        ray = cameraPosition + ray_length * ray_direction;\n\n        for (int i = 0; i < 91; i++) {\n            steps = i;\n            dist = MengerSponge(ray);\n            dist.x *= surfaceSmoothness;\n\n            // If we hit the surface on the previous step check again to make sure it wasn\'t\n            // just a thin filament\n            if (hit && dist.x < eps || ray_length > tmax || ray_length < tmin) {\n                steps--;\n                break;\n            }\n\n            hit = false;\n            ray_length += dist.x;\n            ray = cameraPosition + ray_length * ray_direction;\n            eps = ray_length * epsfactor;\n\n            if (dist.x < eps || ray_length < tmin) {\n                hit = true;\n            }\n        }\n    }\n\n    // Found intersection?\n    float glowAmount = float(steps)/float(stepLimit);\n    float glow;\n\n    if (hit) {\n        float aof = 1.0, shadows = 1.0;\n        glow = clamp(glowAmount * innerGlowIntensity * 3.0, 0.0, 1.0);\n\n        if (steps < 1 || ray_length < tmin) {\n            normal = normalize(ray);\n        } else {\n            normal = generateNormal(ray, eps);\n            aof = ambientOcclusion(ray, normal, eps);\n        }\n\n        color.rgb = mix(color1, mix(color2, color3, dist.y * color2Intensity), dist.z * color3Intensity);\n        color.rgb = blinnPhong(clamp(color.rgb * color1Intensity, 0.0, 1.0), ray, normal);\n        color.rgb *= aof;\n        color.rgb = mix(color.rgb, innerGlowColor, glow);\n        color.rgb = mix(bg_color.rgb, color.rgb, exp(-pow(ray_length * exp(fogFalloff), 2.0) * fog));\n        color.a = 1.0;\n    } else {\n        // Apply outer glow and fog\n        ray_length = tmax;\n        color.rgb = mix(bg_color.rgb, color.rgb, exp(-pow(ray_length * exp(fogFalloff), 2.0)) * fog);\n        glow = clamp(glowAmount * outerGlowIntensity * 3.0, 0.0, 1.0);\n        color.rgb = mix(color.rgb, outerGlowColor, glow);\n        if (transparent > 0) color = vec4(0.0);\n    }\n\n    if (depthMap > 0) {\n        color.rgb = vec3(ray_length / 10.0);\n    }\n\n    return color;\n}\n\n\n// ============================================================================================ //\n\n\n// The main loop\nvoid main()\n{\n    vec4 color = vec4(0.0);\n    float n = 0.0;\n\n    cameraRotation = rotationMatrixVector(v, 180.0 - cameraYaw) * rotationMatrixVector(u, -cameraPitch) * rotationMatrixVector(w, cameraRoll);\n\n\n    // #ifdef antialiasing\n//    for (float x = 0.0; x < 1.0; x += float(antialiasing)) {\n//        for (float y = 0.0; y < 1.0; y += float(antialiasing)) {\n//            color += render(gl_FragCoord.xy + vec2(x, y));\n//            n += 1.0;\n//        }\n//    }\n//    color /= n;\n    // #else\n    color = render(gl_FragCoord.xy);\n    // #endif\n\n    if (color.a < 0.00392) discard; // Less than 1/255\n\n    gl_FragColor = vec4(pow(color.rgb, vec3(1.0 / gamma)), color.a);\n    //gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n}\n\n'},El={src:"\n\n        precision mediump float;\n        attribute vec3 vPosition;\n\n        uniform mat4 cameraTranslate;\n        uniform mat4 cameraRotate;\n        uniform mat4 perspective;\n        uniform mat4 camera;\n        uniform mat4 rotation;\n\n        varying float antialiasing;\n        varying float aoIterations;\n        varying float bailout;\n        varying float maxIterations;\n        varying float minRange;\n        varying float stepLimit;\n\n        void main () {\n            antialiasing = 0.5;\n            bailout = 4.0;\n            minRange = 6e-5;\n            stepLimit = 91.0;\n            aoIterations = 4.0;\n            maxIterations = 8.0;\n            // gl_Position = vec4(vPosition * vec3(0.3, 0.3, 0.3), 1.0);\n            gl_Position = perspective * camera * rotation * cameraTranslate * cameraRotate * vec4(vPosition, 1.0);\n        }\n\n    "},Nl=e(function(r,t,e){return f(lo,t,El,Pl,e,function(r){return{rotation:r.rotation,perspective:r.perspective,camera:r.camera,cameraTranslate:r.cameraTranslate,cameraRotate:r.cameraRotate,paused:r.paused,scale:1,power:8,surfaceDetail:.6,surfaceSmoothness:.6,boundingRadius:5,offset:l(Ee,0,0,0),shift:l(Ee,0,0,0),cameraRoll:0,cameraPitch:-31.5,cameraYaw:-42.5,cameraFocalLength:.9,cameraPosition:l(Ee,1.909264,1.37907,-2.195337),colorIterations:4,color1:l(Ee,1,1,1),color1Intensity:.57,color2:l(Ee,.67,.79,.81),color2Intensity:1.16,color3:l(Ee,1,.53,0),color3Intensity:.57,transparent:1,gamma:1,light:l(Ee,-16,100,-60),ambientColor:_(We,.5,.3),background1Color:l(Ee,0,.46,.8),background2Color:l(Ee,0,0,0),innerGlowColor:l(Ee,0,.6,.8),innerGlowIntensity:.12,outerGlowColor:l(Ee,1,1,1),outerGlowIntensity:0,fog:0,fogFalloff:0,specularity:.8,specularExponent:4,size:_(We,400,300),origin:_(We,0,0),outputSize:_(We,800,600),aoIntensity:.15,aoSpread:9.2,objectRotation:_(Ie,0,l(Ee,0,0,0)),fractalRotation1:_(Ie,0,l(Ee,0,0,0)),fractalRotation2:_(Ie,0,l(Ee,0,0,0)),depthMap:0}}(r))}),Bl=(c(function(r,t,e,n,o,c){return{antialiasing:r,aoIterations:t,bailout:e,maxIterations:n,minRange:o,stepLimit:c}}),function(r){return{vPosition:r}}),Ol=(Uu=Bl(l(Ee,1,-1,0)),Wu=Bl(l(Ee,-1,-1,0)),ju=Bl(l(Ee,1,1,0)),{ctor:"::",_0:{ctor:"_Tuple3",_0:Bl(l(Ee,-1,1,0)),_1:ju,_2:Wu},_1:{ctor:"::",_0:{ctor:"_Tuple3",_0:Wu,_1:ju,_2:Uu},_1:{ctor:"[]"}}}),zl=function(r){var t=r,e=l(G,qe,De,{ctor:"::",_0:ze(l(Ee,0,1,0)),_1:{ctor:"::",_0:_(Ie,L(t._0),Me),_1:{ctor:"::",_0:_(Ie,L(t._1),Pe),_1:{ctor:"::",_0:ze(l(Ee,0,0,1)),_1:{ctor:"[]"}}}}}),n=function(r){return m.update(r,{vPosition:_(Ge,e,r.vPosition)})};return _(X,function(r){var t=r;return{ctor:"_Tuple3",_0:n(t._0),_1:n(t._1),_2:n(t._2)}},Ol)},Il=function(r){return po(_(or,zl,{ctor:"::",_0:{ctor:"_Tuple2",_0:0,_1:0},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:90,_1:0},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:180,_1:0},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:270,_1:0},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:0,_1:90},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:0,_1:270},_1:{ctor:"[]"}}}}}}}))},ql={src:"\n\n        precision mediump float;\n        varying vec3 vcolor;\n\n        void main () {\n            gl_FragColor = vec4(vcolor, 1.0);\n        }\n\n    "},Vl={src:"\n\n        attribute vec3 position;\n        attribute vec3 color;\n\n        uniform mat4 cameraTranslate;\n        uniform mat4 cameraRotate;\n        uniform mat4 perspective;\n        uniform mat4 camera;\n        uniform mat4 rotation;\n\n        varying vec3 vcolor;\n\n        void main () {\n            // gl_Position = perspective * camera * rotation * cameraTranslate * cameraRotate * vec4(position, 1.0);\n            // gl_Position = perspective * camera * rotation * vec4(position, 1.0);\n            gl_Position = perspective * camera * rotation * vec4(position, 1.0);\n            vcolor = color;\n        }\n\n    "},Dl=e(function(r,t,e){return f(lo,t,Vl,ql,e,r)}),Gl=t(function(r,t){return{position:r,color:t}}),Hl=function(r){return po({ctor:"::",_0:{ctor:"_Tuple3",_0:_(Gl,l(Ee,0,0,0),l(Ee,1,0,0)),_1:_(Gl,l(Ee,1,1,0),l(Ee,0,1,0)),_2:_(Gl,l(Ee,1,-1,0),l(Ee,0,0,1))},_1:{ctor:"[]"}})},Jl={src:"\n\n        precision mediump float;\n        varying vec3 vcolor;\n\n        void main () {\n            gl_FragColor = vec4(vcolor, 1.0);\n        }\n\n    "},Ul={src:"\n\n        attribute vec3 position;\n        attribute vec3 color;\n\n        uniform mat4 cameraTranslate;\n        uniform mat4 cameraRotate;\n        uniform mat4 perspective;\n        uniform mat4 camera;\n        uniform mat4 rotation;\n\n        varying vec3 vcolor;\n\n        void main () {\n            // gl_Position = perspective * camera * rotation * cameraTranslate * cameraRotate * vec4(position, 1.0);\n            // gl_Position = perspective * camera * rotation * vec4(position, 1.0);\n            gl_Position = perspective * camera * rotation * vec4(position, 1.0);\n            vcolor = color;\n        }\n\n    "},Wl=e(function(r,t,e){return f(lo,t,Ul,Jl,e,r)}),jl=t(function(r,t){return{position:r,color:t}}),Yl=function(r){return po({ctor:"::",_0:{ctor:"_Tuple3",_0:_(jl,l(Ee,0,0,0),l(Ee,1,0,0)),_1:_(jl,l(Ee,1,1,0),l(Ee,0,1,0)),_2:_(jl,l(Ee,1,-1,0),l(Ee,0,0,1))},_1:{ctor:"[]"}})},Kl={src:"\n\n        // Precision\n        precision mediump float;\n\n        uniform vec3 uColor;\n        uniform float uOpacity;\n        uniform vec3 uResolution;\n\n        varying vec4 vColor;\n\n\n\n        float vignette() {\n            float st = gl_FragCoord.x/uResolution.x;\n           // return distance(st,vec2(0.5));\n           return st;\n        }\n\n\n        // Main\n        void main() {\n\n            gl_FragColor.rgb = uColor;\n\n          // gl_FragColor = vec4(uColor, vignette());\n             gl_FragColor.a = mix(gl_FragColor.a , uOpacity, pow(smoothstep(0.0, 0.7, vignette()), 2.0));\n\n \n        }\n    "},Xl={src:"\n        precision mediump float;\n\n        attribute vec3 position;\n        attribute vec3 color;\n\n        uniform vec3 uColor;\n        varying vec4 vColor;\n\n\n        void main () {\n            gl_Position =  vec4(position, 1.0);\n            vColor = vec4(uColor, 0.0);\n        }\n\n    "},Zl=t(function(r,t){var e=t,n=e.color,o=n._0,c=n._1,u=n._2;return{rotation:r.rotation,perspective:r.perspective,camera:r.camera,cameraTranslate:r.cameraTranslate,cameraRotate:r.cameraRotate,size:r.size,origin:r.origin,paused:r.paused,uOpacity:e.opacity,uColor:l(Ee,o,c,u),uResolution:l(Ee,2340,1280,0)}}),$l={opacity:1,color:{ctor:"_Tuple3",_0:.671875,_1:.289,_2:.5898}},Ql=(t(function(r,t){return{opacity:r,color:t}}),t(function(r,t){return{position:r,color:t}})),rs=e(function(r,t,e){return f(lo,e,Xl,Kl,(n=t.color,po({ctor:"::",_0:{ctor:"_Tuple3",_0:_(Ql,l(Ee,1,1,0),Fe(n)),_1:_(Ql,l(Ee,-1,1,0),Fe(n)),_2:_(Ql,l(Ee,-1,-1,0),Fe(n))},_1:{ctor:"::",_0:{ctor:"_Tuple3",_0:_(Ql,l(Ee,-1,-1,0),Fe(n)),_1:_(Ql,l(Ee,1,1,0),Fe(n)),_2:_(Ql,l(Ee,1,-1,0),Fe(n))},_1:{ctor:"[]"}}})),_(Zl,r,t));var n}),ts=function(r){return{background:"#333",mode:r,gui:A,paused:!1,autoRotate:!1,fps:0,theta:.1,omega:0,layers:{ctor:"[]"},size:{ctor:"_Tuple2",_0:1200,_1:1200},origin:{ctor:"_Tuple2",_0:0,_1:0},mouse:{ctor:"_Tuple2",_0:0,_1:0},now:0,timeShift:0,product:_l,controlsVisible:!0}},es=(o(function(r,t,e,n,o){return{kind:r,name:t,layer:e,model:n,on:o}}),c(function(r,t,e,n,o,c){return{kind:r,blend:t,webglOrSvg:e,isOn:n,name:o,model:c}}),{ctor:"NoOp"}),ns={ctor:"SavePng"},os=function(r){return{ctor:"ApplyRandomizer",_0:r}},cs={ctor:"Randomize"},us=t(function(r,t){return{ctor:"ChangeOpacity",_0:r,_1:t}}),is=t(function(r,t){return{ctor:"ShiftColor",_0:r,_1:t}}),as=t(function(r,t){return{ctor:"AlterAmplitude",_0:r,_1:t}}),_s=t(function(r,t){return{ctor:"ChangeIris",_0:r,_1:t}}),ls=t(function(r,t){return{ctor:"ChangeVignette",_0:r,_1:t}}),ss=t(function(r,t){return{ctor:"ChangeLightSpeed",_0:r,_1:t}}),fs=t(function(r,t){return{ctor:"AlterFaces",_0:r,_1:t}}),ds=t(function(r,t){return{ctor:"ChangeFaces",_0:r,_1:t}}),ps=t(function(r,t){return{ctor:"ChangeFssRenderMode",_0:r,_1:t}}),hs=t(function(r,t){return{ctor:"RebuildFss",_0:r,_1:t}}),ms=t(function(r,t){return{ctor:"ChangeSVGBlend",_0:r,_1:t}}),gs=t(function(r,t){return{ctor:"AlterWGLBlend",_0:r,_1:t}}),vs=e(function(r,t,n){var o=e(function(r,t,e){return _(gs,r,function(r){var t=r.alphaEq,n=t._0,o=t._2;return m.update(r,{alphaEq:{ctor:"_Tuple3",_0:n,_1:ja(e),_2:o}})})}),c=e(function(r,t,e){return _(gs,r,function(r){var t=r.alphaEq,n=t._0,o=t._1;return m.update(r,{alphaEq:{ctor:"_Tuple3",_0:n,_1:o,_2:ja(e)}})})}),u=e(function(r,t,e){return _(gs,r,function(r){var t=r.alphaEq,n=t._1,o=t._2;return m.update(r,{alphaEq:{ctor:"_Tuple3",_0:Ya(e),_1:n,_2:o}})})}),i=e(function(r,t,e){return _(gs,r,function(r){var t=r.colorEq,n=t._0,o=t._1;return m.update(r,{colorEq:{ctor:"_Tuple3",_0:n,_1:o,_2:ja(e)}})})}),a=e(function(r,t,e){return _(gs,r,function(r){var t=r.colorEq,n=t._0,o=t._2;return m.update(r,{colorEq:{ctor:"_Tuple3",_0:n,_1:ja(e),_2:o}})})}),l=e(function(r,t,e){return _(gs,r,function(r){var t=r.colorEq,n=t._1,o=t._2;return m.update(r,{colorEq:{ctor:"_Tuple3",_0:Ya(e),_1:n,_2:o}})})}),s=_(ma,{ctor:"_Tuple2",_0:8,_1:2},_(X,Si,{ctor:"::",_0:"0",_1:{ctor:"::",_0:"1",_1:{ctor:"::",_0:"sC",_1:{ctor:"::",_0:"1-sC",_1:{ctor:"::",_0:"dC",_1:{ctor:"::",_0:"1-dC",_1:{ctor:"::",_0:"s",_1:{ctor:"::",_0:"1-s",_1:{ctor:"::",_0:"d",_1:{ctor:"::",_0:"1-d",_1:{ctor:"::",_0:"S",_1:{ctor:"::",_0:"CC",_1:{ctor:"::",_0:"1-CC",_1:{ctor:"::",_0:"C",_1:{ctor:"::",_0:"1-C",_1:{ctor:"[]"}}}}}}}}}}}}}}}})),d=_(ma,{ctor:"_Tuple2",_0:3,_1:1},_(X,Si,{ctor:"::",_0:"+",_1:{ctor:"::",_0:"-",_1:{ctor:"::",_0:"R-",_1:{ctor:"[]"}}}}));return _(ma,{ctor:"_Tuple2",_0:3,_1:2},{ctor:"::",_0:f(ki,"colorFn",mi,0,l(n),d),_1:{ctor:"::",_0:f(ki,"colorFt1",mi,1,a(n),s),_1:{ctor:"::",_0:f(ki,"colorFt2",mi,0,i(n),s),_1:{ctor:"::",_0:f(ki,"alphaFn",mi,0,u(n),d),_1:{ctor:"::",_0:f(ki,"alphaFt1",mi,1,c(n),s),_1:{ctor:"::",_0:f(ki,"alphaFt2",mi,0,o(n),s),_1:{ctor:"[]"}}}}}}})}),bs=t(function(r,t){return{ctor:"ChangeWGLBlend",_0:r,_1:t}}),ys=t(function(r,t){return{ctor:"Configure",_0:r,_1:t}}),Ts=function(r){return{ctor:"MirrorOff",_0:r}},ws=function(r){return{ctor:"MirrorOn",_0:r}},Ss=function(r){return{ctor:"TurnOff",_0:r}},ks=function(r){return{ctor:"TurnOn",_0:r}},xs=n(function(r,n,o,c){var u=function(r){return{min:-1,max:1,step:.05,roundBy:100,$default:r}},i=function(r){return{min:0,max:100,step:1,roundBy:1,$default:r}},a=function(r){return{min:0,max:1,step:.05,roundBy:100,$default:r}},d=e(function(r,t,e){return _(ps,r,Ml(e))}),p=t(function(r,t){return(m.eq(t,bi)?ks:Ss)(r)}),h=t(function(r,t){return(m.eq(t,bi)?ws:Ts)(r)}),g=n,v=g.lightSpeed,b=g.faces,y=g.amplitude,w=g.vignette,S=g.iris,x=g.colorShift,C=b,F=C._0,L=C._1,R=y,M=R._0,E=R._1,N=R._2,B=x,O=B._0,z=B._1,I=B._2,q={min:0,max:2e3,step:1,roundBy:1,$default:T(v)};return ga({ctor:"::",_0:l(Fi,"visible",bi,p(c)),_1:{ctor:"::",_0:l(Fi,"mirror",vi,h(c)),_1:{ctor:"::",_0:s(Li,"lights",q,T(v),function(r){return _(ss,c,k(r))}),_1:{ctor:"::",_0:s(Li,"col",i(T(F)),T(F),function(r){return _(fs,c,{ctor:"_Tuple2",_0:P(k(r)),_1:A})}),_1:{ctor:"::",_0:s(Li,"row",i(T(L)),T(L),function(r){return _(fs,c,{ctor:"_Tuple2",_0:A,_1:P(k(r))})}),_1:{ctor:"::",_0:l(xi,"fog",mi,_(ma,{ctor:"_Tuple2",_0:2,_1:1},{ctor:"::",_0:s(Li,"shine",a(w),w,ls(c)),_1:{ctor:"::",_0:s(Li,"density",a(S),S,_s(c)),_1:{ctor:"[]"}}})),_1:{ctor:"::",_0:f(ki,"mesh",mi,0,d(c),_(ma,{ctor:"_Tuple2",_0:2,_1:1},{ctor:"::",_0:Si("triangles"),_1:{ctor:"::",_0:Si("lines"),_1:{ctor:"[]"}}})),_1:{ctor:"::",_0:l(xi,"ranges",mi,_(ma,{ctor:"_Tuple2",_0:3,_1:1},{ctor:"::",_0:s(Li,"horizontal",a(M),M,function(r){return _(as,c,{ctor:"_Tuple3",_0:P(r),_1:A,_2:A})}),_1:{ctor:"::",_0:s(Li,"vertical",a(E),E,function(r){return _(as,c,{ctor:"_Tuple3",_0:A,_1:P(r),_2:A})}),_1:{ctor:"::",_0:s(Li,"depth",a(N),N,function(r){return _(as,c,{ctor:"_Tuple3",_0:A,_1:A,_2:P(r)})}),_1:{ctor:"[]"}}}})),_1:{ctor:"::",_0:l(xi,"hsb",mi,_(ma,{ctor:"_Tuple2",_0:3,_1:1},{ctor:"::",_0:s(Li,"hue",u(O),O,function(r){return _(is,c,{ctor:"_Tuple3",_0:P(r),_1:A,_2:A})}),_1:{ctor:"::",_0:s(Li,"saturation",u(z),z,function(r){return _(is,c,{ctor:"_Tuple3",_0:A,_1:P(r),_2:A})}),_1:{ctor:"::",_0:s(Li,"brightness",u(I),I,function(r){return _(is,c,{ctor:"_Tuple3",_0:A,_1:A,_2:P(r)})}),_1:{ctor:"[]"}}}})),_1:{ctor:"::",_0:l(xi,"blend",mi,l(vs,r,o,c)),_1:{ctor:"[]"}}}}}}}}}}})}),Cs=function(r){return{ctor:"ChangeProduct",_0:r}},Fs={ctor:"HideControls"},Ls={ctor:"TriggerPause"},Rs={ctor:"Continue"},As={ctor:"Pause"},Ms={ctor:"BackToNow"},Ps={ctor:"ExportZip"},Es=function(r){return{ctor:"Import",_0:r}},Ns=function(r){return{ctor:"Rotate",_0:r}},Bs={ctor:"RequestFitToWindow"},Os=function(r){return{ctor:"ResizeFromPreset",_0:r}},zs=function(r){var n,o={min:-1,max:1,step:.05,roundBy:100,$default:r.omega},c=t(function(r,t){return(m.eq(t,bi)?ks:Ss)(r)}),u=e(function(r,t,e){return _(ms,r,N_(e))}),i=(e(function(r,t,e){return es}),t(function(r,t){switch(t){case"rs":return Cs(Q_);case"rs cpp":return Cs($_);case"idea":return Cs(al);default:return Cs(ll(t))}})),a=_(ma,{ctor:"_Tuple2",_0:3,_1:3},_(X,Si,{ctor:"::",_0:"normal",_1:{ctor:"::",_0:"overlay",_1:{ctor:"::",_0:"multiply",_1:{ctor:"::",_0:"darken",_1:{ctor:"::",_0:"lighten",_1:{ctor:"::",_0:"multiply",_1:{ctor:"::",_0:"multiply",_1:{ctor:"::",_0:"multiply",_1:{ctor:"::",_0:"multiply",_1:{ctor:"[]"}}}}}}}}}})),d=t(function(r,t){return ga({ctor:"::",_0:l(Fi,"visible",bi,c(t)),_1:{ctor:"::",_0:f(ki,"blend",mi,0,u(t),a),_1:{ctor:"[]"}}})}),p=_(fr,t(function(t,e){var n=e,o=n.name,c=n.layer;if("WebGLLayer"===c.ctor){var u=n.model;return"FssModel"===u.ctor?l(xi,Or(o),mi,s(xs,r.mode,u._0,c._1,t)):{ctor:"Ghost",_0:_(C["++"],"layer ",y(t))}}return l(xi,Or(o),mi,_(d,c._1,t))}),_(Z,function(t){var e="_Tuple2",n=t.name,o=r.mode;return"_Tuple2"!==e||"Cover"!==n||"Production"!==o.ctor},r.layers)),h=_(ma,{ctor:"_Tuple2",_0:6,_1:4},_(X,Si,{ctor:"::",_0:"jetbrains",_1:{ctor:"::",_0:"idea",_1:{ctor:"::",_0:"phpstorm",_1:{ctor:"::",_0:"pycharm",_1:{ctor:"::",_0:"rubymine",_1:{ctor:"::",_0:"webstorm",_1:{ctor:"::",_0:"clion",_1:{ctor:"::",_0:"datagrip",_1:{ctor:"::",_0:"appcode",_1:{ctor:"::",_0:"goland",_1:{ctor:"::",_0:"rs",_1:{ctor:"::",_0:"rs cpp",_1:{ctor:"::",_0:"dotcover",_1:{ctor:"::",_0:"dotmemory",_1:{ctor:"::",_0:"dotpeek",_1:{ctor:"::",_0:"dottrace",_1:{ctor:"::",_0:"rider",_1:{ctor:"::",_0:"teamcity",_1:{ctor:"::",_0:"youtrack",_1:{ctor:"::",_0:"upsource",_1:{ctor:"::",_0:"hub",_1:{ctor:"::",_0:"kotlin",_1:{ctor:"::",_0:"mps",_1:{ctor:"[]"}}}}}}}}}}}}}}}}}}}}}}}})),g=function(r){switch(r.ctor){case"Production":return{ctor:"_Tuple2",_0:Ft({ctor:"::",_0:{ctor:"_Tuple2",_0:"2560x1440",_1:{ctor:"_Tuple2",_0:2560,_1:1440}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"1920x1200",_1:{ctor:"_Tuple2",_0:1920,_1:1200}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"1920x1080",_1:{ctor:"_Tuple2",_0:1920,_1:1080}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"1680x1050",_1:{ctor:"_Tuple2",_0:1680,_1:1050}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"1536x864",_1:{ctor:"_Tuple2",_0:1536,_1:864}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"1440x900",_1:{ctor:"_Tuple2",_0:1440,_1:900}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"1366x768",_1:{ctor:"_Tuple2",_0:1366,_1:768}},_1:{ctor:"[]"}}}}}}}}),_1:{ctor:"_Tuple2",_0:4,_1:2}};case"Ads":return{ctor:"_Tuple2",_0:Ft({ctor:"::",_0:{ctor:"_Tuple2",_0:"120x600",_1:{ctor:"_Tuple2",_0:120,_1:600}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"125x125",_1:{ctor:"_Tuple2",_0:125,_1:125}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"130x100",_1:{ctor:"_Tuple2",_0:130,_1:100}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"180x150",_1:{ctor:"_Tuple2",_0:180,_1:150}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"200x125",_1:{ctor:"_Tuple2",_0:200,_1:125}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"200x200",_1:{ctor:"_Tuple2",_0:200,_1:200}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"220x250",_1:{ctor:"_Tuple2",_0:220,_1:250}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"250x250",_1:{ctor:"_Tuple2",_0:250,_1:250}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"260x200",_1:{ctor:"_Tuple2",_0:260,_1:200}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"300x250",_1:{ctor:"_Tuple2",_0:300,_1:250}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"320x100",_1:{ctor:"_Tuple2",_0:320,_1:100}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"320x50",_1:{ctor:"_Tuple2",_0:320,_1:50}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"336x280",_1:{ctor:"_Tuple2",_0:336,_1:280}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"468x60",_1:{ctor:"_Tuple2",_0:468,_1:60}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"160x600",_1:{ctor:"_Tuple2",_0:160,_1:600}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"300x600",_1:{ctor:"_Tuple2",_0:300,_1:600}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"728x90",_1:{ctor:"_Tuple2",_0:728,_1:90}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"800x320",_1:{ctor:"_Tuple2",_0:800,_1:320}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"970x250",_1:{ctor:"_Tuple2",_0:970,_1:250}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"970x90",_1:{ctor:"_Tuple2",_0:970,_1:90}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"960x90 baidu",_1:{ctor:"_Tuple2",_0:960,_1:90}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"728x90 baidu",_1:{ctor:"_Tuple2",_0:728,_1:90}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"468x60 baidu",_1:{ctor:"_Tuple2",_0:468,_1:60}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"200x200 baidu",_1:{ctor:"_Tuple2",_0:200,_1:200}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"960x60 baidu",_1:{ctor:"_Tuple2",_0:960,_1:60}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"640x60 baidu",_1:{ctor:"_Tuple2",_0:640,_1:60}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"580x90 baidu",_1:{ctor:"_Tuple2",_0:580,_1:90}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"460x60 baidu",_1:{ctor:"_Tuple2",_0:460,_1:60}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"300x250 baidu",_1:{ctor:"_Tuple2",_0:300,_1:250}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"336x280 baidu",_1:{ctor:"_Tuple2",_0:336,_1:280}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"1200x628 fb",_1:{ctor:"_Tuple2",_0:1200,_1:628}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"800x418 tw",_1:{ctor:"_Tuple2",_0:800,_1:418}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"1080x1080 in",_1:{ctor:"_Tuple2",_0:1080,_1:1080}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"1200x627 ln",_1:{ctor:"_Tuple2",_0:1200,_1:627}},_1:{ctor:"[]"}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}),_1:{ctor:"_Tuple2",_0:4,_1:2}};default:return{ctor:"_Tuple2",_0:Ft({ctor:"::",_0:{ctor:"_Tuple2",_0:"480x297 prodcard",_1:{ctor:"_Tuple2",_0:480,_1:297}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"960x594 prodcard@2x",_1:{ctor:"_Tuple2",_0:960,_1:594}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"640x400 spl",_1:{ctor:"_Tuple2",_0:640,_1:400}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"1280x800 spl@2x",_1:{ctor:"_Tuple2",_0:1280,_1:800}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"650x170 nwlt",_1:{ctor:"_Tuple2",_0:650,_1:170}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"1300x340 nwlt@2x",_1:{ctor:"_Tuple2",_0:1300,_1:340}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"800x418 tw",_1:{ctor:"_Tuple2",_0:800,_1:418}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"1200x628 fb",_1:{ctor:"_Tuple2",_0:1200,_1:628}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"1280x800 wprev",_1:{ctor:"_Tuple2",_0:1280,_1:800}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"800x400 blog",_1:{ctor:"_Tuple2",_0:800,_1:400}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"1600x800 blog@2x",_1:{ctor:"_Tuple2",_0:1600,_1:800}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"800x155 bfoot",_1:{ctor:"_Tuple2",_0:800,_1:155}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"1600x310 bfoot",_1:{ctor:"_Tuple2",_0:1600,_1:310}},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"2850x1200 landg",_1:{ctor:"_Tuple2",_0:2850,_1:1200}},_1:{ctor:"[]"}}}}}}}}}}}}}}}),_1:{ctor:"_Tuple2",_0:4,_1:4}}}}(r.mode),b=g._0,T=g._1,w=_(ma,T,_(X,Si,{ctor:"::",_0:"browser",_1:Jr(b)})),S=t(function(r,t){switch(t){case"window":case"browser":return Bs;default:return _(R,Bs,_(E,function(r){var t=r;return Os(_(Du,t._0,t._1))},_(Zr,t,b)))}});return n=ga(_(C["++"],{ctor:"::",_0:f(ki,"product",mi,0,i,h),_1:{ctor:"::",_0:s(Li,"rotation",o,r.omega,Ns),_1:{ctor:"::",_0:f(ki,"size",mi,0,S,w),_1:{ctor:"::",_0:_(Ci,"lucky",v(cs)),_1:{ctor:"[]"}}}}},p)),{ctor:"_Tuple2",_0:li,_1:n}},Is=e(function(r,t,e){var n,o=ts(r),c=m.update(o,{layers:_(X,function(r){var t=r,n=t._2,o=t._0;return{kind:o,layer:_(e,o,n),name:t._1,model:n,on:!0}},t)});return m.update(c,{gui:(n=r,"TronUi"===n.ctor?P(zs(m.update(c,{mode:n._0}))):A)})}),qs=function(r){return{ctor:"Resize",_0:r}},Vs=function(r){return{ctor:"GuiMessage",_0:r}},Ds=function(r){return{ctor:"Animate",_0:r}},Gs={ctor:"Bang"},Hs=function(r){return{ctor:"TronUi",_0:r}},Js={ctor:"Ads"},Us={ctor:"Release"},Ws={ctor:"Production"},js={ctor:"Development"},Ys={ctor:"Empty"},Ks={ctor:"Vignette"},Xs={ctor:"Cover"},Zs={ctor:"MirroredFss"},$s={ctor:"Fss"},Qs={ctor:"Voronoi"},rf={ctor:"Template"},tf={ctor:"Fractal"},ef={ctor:"Lorenz"},nf={ctor:"NoModel"},of=function(r){return{ctor:"FssModel",_0:r}},cf=function(r){return{ctor:"LorenzModel",_0:r}},uf={ctor:"VignetteLayer"},af=t(function(r,t){return{ctor:"MirroredFssLayer",_0:r,_1:t}}),_f=t(function(r,t){return{ctor:"FssLayer",_0:r,_1:t}}),lf=function(r){return{ctor:"TemplateLayer",_0:r}},sf=function(r){return{ctor:"VoronoiLayer",_0:r}},ff=function(r){return{ctor:"FractalLayer",_0:r}},df=function(r){return{ctor:"LorenzLayer",_0:r}},pf={ctor:"CoverLayer"},hf=t(function(r,t){return{ctor:"SVGLayer",_0:r,_1:t}}),mf=_(hf,{ctor:"NoContent"},B_),gf=t(function(r,t){return{ctor:"WebGLLayer",_0:r,_1:t}}),vf=function(r){if(_(Br,"tron-",r))return Hs(vf(_(zr,5,r)));switch(r){case"dev":return js;case"prod":return Ws;case"release":return Us;case"ads":return Js;case"tron":return Hs(Ws);default:return Ws}},bf=function(r){var t=r;switch(t.ctor){case"Development":return"dev";case"Production":return"prod";case"Release":return"release";case"Ads":return"ads";default:return _(C["++"],"tron-",bf(t._0))}},yf=t(function(r,t){return{amplitude:r.amplitude,colorShift:r.colorShift,opacity:r.opacity,faces:r.faces,lightSpeed:r.lightSpeed,renderMode:ml(r.renderMode),clip:r.clip,shareMesh:r.shareMesh,vignette:r.vignette,iris:r.iris,mirror:r.mirror}}),Tf=function(r){r:for(;;){switch(r.ctor){case"Fss":return l(ye,"iris",re,l(ye,"vignette",re,l(ye,"shareMesh",ee,l(ye,"lightSpeed",te,l(ye,"clip",Qt(re),l(ye,"mirror",ee,l(ye,"opacity",re,l(ye,"colorShift",Qt(re),l(ye,"amplitude",Qt(re),l(ye,"faces",Qt(te),l(ye,"renderMode",ne,ge(function(r){return function(t){return function(e){return function(n){return function(o){return function(c){return function(u){return function(i){return function(a){return function(_){return function(l){var s={ctor:"_Tuple5",_0:t,_1:e,_2:n,_3:o,_4:u};return"_Tuple5"===s.ctor&&"::"===s._0.ctor&&"::"===s._0._1.ctor&&"[]"===s._0._1._1.ctor&&"::"===s._1.ctor&&"::"===s._1._1.ctor&&"::"===s._1._1._1.ctor&&"[]"===s._1._1._1._1.ctor&&"::"===s._2.ctor&&"::"===s._2._1.ctor&&"::"===s._2._1._1.ctor&&"[]"===s._2._1._1._1.ctor&&"::"===s._4.ctor&&"::"===s._4._1.ctor&&"[]"===s._4._1._1.ctor?of({renderMode:Ml(r),faces:{ctor:"_Tuple2",_0:s._0._0,_1:s._0._1._0},amplitude:{ctor:"_Tuple3",_0:s._1._0,_1:s._1._1._0,_2:s._1._1._1._0},colorShift:{ctor:"_Tuple3",_0:s._2._0,_1:s._2._1._0,_2:s._2._1._1._0},opacity:s._3,mirror:c,clip:P({ctor:"_Tuple2",_0:s._4._0,_1:s._4._1._0}),lightSpeed:i,shareMesh:a,vignette:_,iris:l}):nf}}}}}}}}}}}))))))))))));case"MirroredFss":r=$s;continue r;default:return ge(nf)}}},wf=l(ye,"v2",te,l(ye,"v1",te,ge(t(function(r,t){return{ctor:"_Tuple2",_0:r,_1:t}})))),Sf=function(r){switch(r){case"fss":return $s;case"fss-mirror":return Zs;case"lorenz":return ef;case"fractal":return tf;case"template":return rf;case"voronoi":return Qs;case"cover":return Xs;case"vignette":return Ks;default:return Ys}},kf=t(function(r,t){var e=a(function(e,n,o,c,u,i,a,_,s){var f=ll(s),d=l(Is,r,{ctor:"[]"},t);return m.update(d,{background:e,theta:n,omega:o,layers:c,size:u,origin:i,mouse:a,now:_,product:f})});return l(ye,"product",ne,l(ye,"now",re,l(ye,"mouse",wf,l(ye,"origin",wf,l(ye,"size",wf,l(ye,"layers",Qt(function(r){var t=o(function(t,e,n,o,c){var u,i=Sf(t),a=_(R,nf,Fr(_(Ut,Tf(i),e))),l=_(r,i,a);return{kind:i,on:o,layer:"WebGLLayer"===(u=l).ctor?_(gf,u._0,_(R,h_,i_(c))):_(hf,u._0,N_(c)),model:a,name:n}});return l(ye,"blend",ne,l(ye,"isOn",ee,l(ye,"name",ne,l(ye,"model",ne,l(ye,"kind",ne,ge(t))))))}(t)),l(ye,"omega",re,l(ye,"theta",re,l(ye,"background",ne,ge(e))))))))))}),xf=e(function(r,t,e){return Fr(_(Ut,_(kf,r,t),e))}),Cf=t(function(r,t){var e,n=Sf(t.kind),o=_(R,nf,Fr(_(Ut,Tf(n),t.model))),c=_(r,n,o),u="WebGLLayer"===(e=c).ctor?_(gf,e._0,_(R,h_,ce(t.blend))):_(hf,e._0,_(R,B_,_(E,N_,oe(t.blend))));return{kind:n,on:t.isOn,layer:u,model:o,name:t.name}}),Ff=t(function(r,t){var e=vf(t.mode),n=ts(e),o=m.update(n,{background:t.background,mode:e,now:t.now,theta:t.theta,omega:t.omega,layers:_(X,Cf(r),t.layers),size:t.size,origin:t.origin,mouse:t.mouse,product:ll(t.product)});return m.update(o,{gui:"TronUi"===e.ctor?P(zs(o)):A})}),Lf=function(r){switch(r.ctor){case"Fss":return"fss";case"MirroredFss":return"fss-mirror";case"Lorenz":return"lorenz";case"Fractal":return"fractal";case"Template":return"template";case"Voronoi":return"voronoi";case"Cover":return"cover";case"Vignette":return"vignette";default:return"empty"}},Rf=t(function(r,t){var e=t;return Pt(br(_(X,r,{ctor:"::",_0:e._0,_1:{ctor:"::",_0:e._1,_1:{ctor:"::",_0:e._2,_1:{ctor:"[]"}}}})))}),Af=t(function(r,t){var e=t;return Pt(br(_(X,r,{ctor:"::",_0:e._0,_1:{ctor:"::",_0:e._1,_1:{ctor:"[]"}}})))}),Mf=function(r){return Et(function(){var t=r;switch(t.ctor){case"FssModel":var e=t._0;return{ctor:"::",_0:{ctor:"_Tuple2",_0:"renderMode",_1:zt(ml(e.renderMode))},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"faces",_1:_(Af,Ot,e.faces)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"lightSpeed",_1:Ot(e.lightSpeed)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"amplitude",_1:_(Rf,Bt,e.amplitude)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"colorShift",_1:_(Rf,Bt,e.colorShift)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"opacity",_1:Bt(e.opacity)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"mirror",_1:Nt(e.mirror)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"clip",_1:_(Af,Bt,_(R,Sl,e.clip))},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"shareMesh",_1:Nt(e.shareMesh)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"vignette",_1:Bt(e.vignette)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"iris",_1:Bt(e.iris)},_1:{ctor:"[]"}}}}}}}}}}}};case"VignetteModel":var n=t._0;return{ctor:"::",_0:{ctor:"_Tuple2",_0:"opacity",_1:Bt(n.opacity)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"color",_1:_(Rf,Bt,n.color)},_1:{ctor:"[]"}}};default:return{ctor:"[]"}}}())},Pf=function(r){return Et({ctor:"::",_0:{ctor:"_Tuple2",_0:"kind",_1:(n=r.kind,zt(Lf(n)))},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"blend",_1:(e=r.layer,"WebGLLayer"===e.ctor?zt(e_(e._1)):zt(m_(e._1)))},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"blendDesc",_1:(t=r.layer,"WebGLLayer"===t.ctor?zt(_($a,{delim:"; ",space:"> "},t._1)):zt(m_(t._1)))},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"isOn",_1:Nt(r.on)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"model",_1:Mf(r.model)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"name",_1:zt(r.name)},_1:{ctor:"[]"}}}}}}});var t,e,n},Ef=function(r){return{kind:Lf(r.kind),isOn:r.on,webglOrSvg:"WebGLLayer"===r.layer.ctor?"webgl":"svg",blend:(t=r.layer,"WebGLLayer"===t.ctor?{ctor:"_Tuple2",_0:P(t._1),_1:A}:{ctor:"_Tuple2",_0:A,_1:P(m_(t._1))}),name:r.name,model:_(It,2,Mf(r.model))};var t},Nf=function(r){return{background:r.background,mode:bf(r.mode),now:r.now,theta:r.theta,omega:r.omega,layers:_(X,Ef,r.layers),size:r.size,origin:r.origin,mouse:r.mouse,palette:q_(r.product),product:z_(r.product)}},Bf=function(r){var t=r;return Et({ctor:"::",_0:{ctor:"_Tuple2",_0:"v1",_1:Ot(t._0)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"v2",_1:Ot(t._1)},_1:{ctor:"[]"}}})},Of=function(r){return _(It,2,function(r){return Et({ctor:"::",_0:{ctor:"_Tuple2",_0:"background",_1:zt(r.background)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"mode",_1:zt(bf(r.mode))},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"theta",_1:Bt(r.theta)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"omega",_1:Bt(r.omega)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"layers",_1:Mt(_(X,Pf,r.layers))},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"size",_1:Bf(r.size)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"origin",_1:Bf(r.origin)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"mouse",_1:Bf(r.mouse)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"now",_1:Bt(r.now)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"palette",_1:Pt(br(_(X,zt,q_(r.product))))},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"product",_1:zt(z_(r.product))},_1:{ctor:"[]"}}}}}}}}}}}})}(r))},zf=c(function(r,t,e,n,o,c){var u,i=e,a=i._1,l=i._0,s=n,f=s._0,d=s._1;return _(to,{ctor:"::",_0:Pc(t),_1:{ctor:"::",_0:_(Lc,"data-stored",_(It,0,(u={blend:m_(o),posX:l,posY:a,width:f,height:d,imagePath:r,scale:c},Et({ctor:"::",_0:{ctor:"_Tuple2",_0:"scale",_1:Bt(u.scale)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"posX",_1:Bt(u.posX)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"posY",_1:Bt(u.posY)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"blend",_1:zt(u.blend)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"imagePath",_1:zt(u.imagePath)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"width",_1:Ot(u.width)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"height",_1:Ot(u.height)},_1:{ctor:"[]"}}}}}}}})))),_1:{ctor:"::",_0:Ic({ctor:"::",_0:{ctor:"_Tuple2",_0:"mix-blend-mode",_1:m_(o)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"position",_1:"absolute"},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"top",_1:"0px"},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"left",_1:"0px"},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"width",_1:_(C["++"],y(T(f)*c),"px")},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"height",_1:_(C["++"],y(T(d)*c),"px")},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"transform",_1:_(C["++"],"translate(",_(C["++"],y(l-T(f)*c/2),_(C["++"],"px, ",_(C["++"],y(a-T(d)*c/2),"px)"))))},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"background-image",_1:_(C["++"],'url("',_(C["++"],r,'")'))},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"background-repeat",_1:"no-repeat"},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"background-position",_1:"center center"},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"background-size",_1:"contain"},_1:{ctor:"[]"}}}}}}}}}}}}),_1:{ctor:"[]"}}}},{ctor:"[]"})}),If=e(function(r,t,e){var n,o,c=r,u=90,i=90,a="Just"===(o=_(E,function(r){return _(C["++"],r,".svg")},"Unknown"===(n=_l).ctor?A:P(z_(n)))).ctor?_(C["++"],"./assets/",o._0):"";return d(zf,a,_(C["++"],"logo-layer logo-layer-",z_(_l)),{ctor:"_Tuple2",_0:c._0,_1:c._1},{ctor:"_Tuple2",_0:u,_1:i},t,e)}),qf=n(function(r,t,e,n){var o,c=O_(r),u="Just"===(o=function(r){return _(E,function(r){return _(C["++"],r,"-text.svg")},"Unknown"===(t=r).ctor?A:P(z_(t)));var t}(r)).ctor?_(C["++"],"./assets/",o._0):"";return d(zf,u,_(C["++"],"product-name-layer product-name-layer-",z_(r)),t,c,e,n)}),Vf=o(function(r,t,e,n,o){var c=e,u=c._0,i=c._1,a=n,f=a._1,d=a._0,p=Ic({ctor:"::",_0:{ctor:"_Tuple2",_0:"mix-blend-mode",_1:m_(o)},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"position",_1:"absolute"},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"top",_1:"0px"},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"left",_1:"0px"},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"font-size",_1:_(C["++"],y(110),"px")},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"font-family",_1:"'Gotham', Helvetica, sans-serif"},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"font-weight",_1:"170"},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"text-transform",_1:"uppercase"},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"color",_1:"white"},_1:{ctor:"[]"}}}}}}}}}}),h=T(i)-T(f)-.1*T(i),g=T(u)-T(d)-.1*T(i),v=T(i)/2-T(f),b=T(u)/2-T(d),w=T(u)/1500;return _(to,{ctor:"::",_0:Pc("cover-layer"),_1:{ctor:"[]"}},m.eq(r,Ws)||m.eq(r,Hs(Ws))?{ctor:"::",_0:_(to,{ctor:"::",_0:p,_1:{ctor:"[]"}},{ctor:"::",_0:s(qf,t,{ctor:"_Tuple2",_0:b,_1:v},o,w),_1:{ctor:"::",_0:l(If,{ctor:"_Tuple2",_0:g,_1:h},o,w),_1:{ctor:"[]"}}}),_1:{ctor:"[]"}}:{ctor:"[]"})}),Df=(u(function(r,t,e,n,o,c,u){return{scale:r,posX:t,posY:e,blend:n,imagePath:o,width:c,height:u}}),n(function(r,t,e,n){var o,c,u,i,a,f,d,p,h,g,v=n.layer;if("WebGLLayer"===v.ctor){var b=v._1,y={ctor:"_Tuple2",_0:v._0,_1:n.model};r:do{if("_Tuple2"!==y.ctor)break r;switch(y._0.ctor){case"LorenzLayer":return{ctor:"::",_0:l(ci,t,{ctor:"::",_0:ao,_1:{ctor:"::",_0:d_(b),_1:{ctor:"[]"}}},y._0._0),_1:{ctor:"[]"}};case"FractalLayer":return{ctor:"::",_0:l(Nl,t,{ctor:"::",_0:ao,_1:{ctor:"::",_0:d_(b),_1:{ctor:"[]"}}},y._0._0),_1:{ctor:"[]"}};case"TemplateLayer":return{ctor:"::",_0:l(Wl,t,{ctor:"::",_0:ao,_1:{ctor:"::",_0:d_(b),_1:{ctor:"[]"}}},y._0._0),_1:{ctor:"[]"}};case"VoronoiLayer":return{ctor:"::",_0:l(Dl,t,{ctor:"::",_0:ao,_1:{ctor:"::",_0:d_(b),_1:{ctor:"[]"}}},y._0._0),_1:{ctor:"[]"}};case"FssLayer":if("FssModel"===y._1.ctor){var T={ctor:"_Tuple2",_0:y._0._0,_1:y._0._1},w=T._0,S=T._1;return{ctor:"::",_0:(o=xl,c=r.now,u=r.mouse,i=I_(r.product),a=e,f=t,d=y._1._0,p=w,h={ctor:"::",_0:ao,_1:{ctor:"::",_0:d_(b),_1:{ctor:"::",_0:uo,_1:{ctor:"[]"}}}},g=S,9===o.arity?o.func(c,u,i,a,f,d,p,h,g):o(c)(u)(i)(a)(f)(d)(p)(h)(g)),_1:{ctor:"[]"}}}break r;case"MirroredFssLayer":if("FssModel"===y._1.ctor){var k=y._0._0,x=y._0._1,F=y._1._0,L=m.update(F,{clip:P({ctor:"_Tuple2",_0:.50001,_1:1})}),R=m.update(F,{clip:P({ctor:"_Tuple2",_0:0,_1:.50001}),mirror:!0});return _(C["++"],s(Df,r,t,e,m.update(n,{layer:_(gf,_(_f,k,x),b),model:of(R)})),s(Df,r,t,e,m.update(n,{layer:_(gf,_(_f,k,x),b),model:of(L)})))}break r;default:return{ctor:"::",_0:l(rs,t,$l,{ctor:"::",_0:ao,_1:{ctor:"::",_0:d_(b),_1:{ctor:"::",_0:uo,_1:{ctor:"[]"}}}}),_1:{ctor:"[]"}}}}while(0);return{ctor:"[]"}}return{ctor:"[]"}})),Gf=e(function(r,t,e){var n=e.layer;return"SVGLayer"===n.ctor&&"CoverLayer"===n._0.ctor?f(Vf,r.mode,r.product,r.size,r.origin,n._1):_(to,{ctor:"[]"},{ctor:"[]"})}),Hf=function(r){return _(fr,Gf(r),_(Z,function(r){return r.on},_(Z,function(r){return"WebGLLayer"!==r.layer.ctor},r.layers)))},Jf=function(r){var e,n=function(r){var t=r,e=t.theta,n=t.origin,o=n._0,c=n._1,u=t.size,i=u._0,a=u._1;return{rotation:_(Ie,3*e,l(Ee,0,0,1)),perspective:s(Ve,80,1.5,.1,3e3),camera:l(Oe,l(Ee,0,0,.5),l(Ee,0,0,0),l(Ee,1,0,0)),cameraTranslate:ze(l(Ee,0,-.35,0)),cameraRotate:_(Ie,e+.5,l(Ee,0,0,1)),size:_(We,T(i),T(a)),origin:_(We,T(o),T(c)),paused:t.paused}}({paused:(e=r).paused,size:e.size,origin:e.origin,theta:e.theta});return _(or,function(t){var e=t;return s(Df,r,n,e._0,e._1)},_(fr,t(function(r,t){return{ctor:"_Tuple2",_0:r,_1:t}}),_(Z,function(r){return r.on},_(Z,function(r){return"WebGLLayer"===r.layer.ctor},r.layers))))},Uf=(t(function(r,t){var e=t;return"Configure"===e.ctor?_(ys,0,cf(e._0)):Ns(e._0)}),t(function(r,t){var e=r,n=t,o=n._1,c=n._0;return m.cmp(c,e._0)<1&&m.cmp(o,e._1)<1?P({ctor:"_Tuple2",_0:c,_1:o}):A})),Wf=t(function(r,t){return _(R,v(es),_(E,function(t){return function(e){return Vs(_(r,t,e))}},t.gui))}),jf=e(function(r,t,e){var n=br(e.layers),o=_(pr,r,n);return"Just"===o.ctor?m.update(e,{layers:vr(l(dr,r,t(o._0),n))}):e}),Yf=e(function(r,t,e){return l(jf,r,function(r){return m.update(r,{layer:_(t,r.layer,r.model)})},e)}),Kf=e(function(r,t,e){return l(jf,r,function(r){var e=t({ctor:"_Tuple2",_0:r.layer,_1:r.model});return m.update(r,{layer:e._0,model:e._1})},e)}),Xf=n(function(r,t,e,n){return l(jf,r,function(r){return m.update(r,{layer:function(){var n=r.layer;if("WebGLLayer"===n.ctor){var o=n._1;return _(gf,n._0,_(R,o,t(o)))}var c=n._1;return _(hf,n._0,_(R,c,e(c)))}()})},n)}),Zf=t(function(r,t){var e={ctor:"_Tuple2",_0:r,_1:t};r:do{if("_Tuple2"!==e.ctor)break r;switch(e._0.ctor){case"Fss":if("FssModel"===e._1.ctor)return _(gf,_(_f,A,_(wl,e._1._0,A)),h_);break r;case"MirroredFss":if("FssModel"===e._1.ctor)return _(gf,_(af,A,_(wl,e._1._0,A)),h_);break r;case"Lorenz":if("LorenzModel"===e._1.ctor)return _(gf,df(ai(e._1._0)),h_);break r;case"Template":if("TemplateModel"===e._1.ctor)return _(gf,lf(Yl(e._1._0)),h_);break r;case"Voronoi":if("VoronoiModel"===e._1.ctor)return _(gf,sf(Hl(e._1._0)),h_);break r;case"Fractal":if("FractalModel"===e._1.ctor)return _(gf,ff(Il(e._1._0)),h_);break r;case"Vignette":return _(gf,uf,_(p_,{ctor:"_Tuple3",_0:zo,_1:Fo,_2:Lo},{ctor:"_Tuple3",_0:zo,_1:wo,_2:Lo}));case"Cover":return _(hf,pf,B_);default:break r}}while(0);return mf}),$f=e(function(r,t,e){return l(Kf,r,function(r){var e,n=r,o=n._1;return{ctor:"_Tuple2",_0:n._0,_1:(e=o,"FssModel"===e.ctor?of(t(e._0)):o)}},e)}),Qf=t(function(r,t){return _(E,function(r){return r.model},_(pr,r,br(t.layers)))}),rd=function(r){return{size:r.size,product:z_(r.product),coverSize:O_(r.product),background:r.background}},td=function(r){return{ctor:"::",_0:{ctor:"_Tuple3",_0:$s,_1:"Lower Layer",_2:of(Al)},_1:{ctor:"::",_0:{ctor:"_Tuple3",_0:$s,_1:"Mid Layer",_2:of(Al)},_1:{ctor:"::",_0:{ctor:"_Tuple3",_0:$s,_1:"Top layer",_2:(t=Al,of(m.update(t,{renderMode:Fl,shareMesh:!0})))},_1:{ctor:"::",_0:{ctor:"_Tuple3",_0:Xs,_1:"Cover",_2:nf},_1:{ctor:"[]"}}}}};var t},ed=Js,nd={ctor:"_Tuple2",_0:l(Is,ed,td(),Zf),_1:ae({ctor:"::",_0:_(Qo,qs,Iu),_1:{ctor:"[]"}})},od=function(r){var t=r;return{ctor:"_Tuple2",_0:S(1*T(t._0)),_1:S(1*T(t._1))}},cd=function(r){var t=r;return{ctor:"_Tuple2",_0:w(0*T(t._0)/2),_1:w(0*T(t._1)/2)}},ud=ue.incomingPort("bang",qt({ctor:"_Tuple0"})),id=ue.incomingPort("changeMode",ne),ad=ue.incomingPort("pause",qt({ctor:"_Tuple0"})),_d=ue.incomingPort("continue",qt({ctor:"_Tuple0"})),ld=ue.incomingPort("triggerPause",qt({ctor:"_Tuple0"})),sd=ue.incomingPort("hideControls",qt({ctor:"_Tuple0"})),fd=ue.incomingPort("rotate",re),dd=(ue.incomingPort("initLayers",(Yu=ne,_(At.decodeContainer,"array",Yu))),ue.incomingPort("configureLorenz",_(Dt,function(r){return _(Dt,function(t){return Ht({value:r,layer:t})},_(Xt,"layer",te))},_(Xt,"value",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return _(Dt,function(n){return _(Dt,function(o){return _(Dt,function(c){return Ht({sigma:r,beta:t,rho:e,step:n,numVertices:o,thickness:c})},_(Xt,"thickness",re))},_(Xt,"numVertices",te))},_(Xt,"step",re))},_(Xt,"rho",re))},_(Xt,"beta",re))},_(Xt,"sigma",re)))))),pd=ue.incomingPort("configureFss",_(Dt,function(r){return _(Dt,function(t){return Ht({value:r,layer:t})},_(Xt,"layer",te))},_(Xt,"value",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return _(Dt,function(n){return _(Dt,function(o){return _(Dt,function(c){return _(Dt,function(u){return _(Dt,function(i){return _(Dt,function(a){return _(Dt,function(l){return _(Dt,function(_){return Ht({renderMode:r,amplitude:t,colorShift:e,opacity:n,vignette:o,iris:c,faces:u,mirror:i,clip:a,lightSpeed:l,shareMesh:_})},_(Xt,"shareMesh",ee))},_(Xt,"lightSpeed",te))},_(Xt,"clip",Yt({ctor:"::",_0:qt(A),_1:{ctor:"::",_0:_(jt,P,_(Dt,function(r){return _(Dt,function(t){return Ht({ctor:"_Tuple2",_0:r,_1:t})},_(Kt,1,re))},_(Kt,0,re))),_1:{ctor:"[]"}}})))},_(Xt,"mirror",ee))},_(Xt,"faces",_(Dt,function(r){return _(Dt,function(t){return Ht({ctor:"_Tuple2",_0:r,_1:t})},_(Kt,1,te))},_(Kt,0,te))))},_(Xt,"iris",re))},_(Xt,"vignette",re))},_(Xt,"opacity",re))},_(Xt,"colorShift",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return Ht({ctor:"_Tuple3",_0:r,_1:t,_2:e})},_(Kt,2,re))},_(Kt,1,re))},_(Kt,0,re))))},_(Xt,"amplitude",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return Ht({ctor:"_Tuple3",_0:r,_1:t,_2:e})},_(Kt,2,re))},_(Kt,1,re))},_(Kt,0,re))))},_(Xt,"renderMode",ne))))),hd=(ue.incomingPort("configureMirroredFss",_(Dt,function(r){return _(Dt,function(t){return Ht({value:r,layer:t})},_(Xt,"layer",te))},_(Xt,"value",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return _(Dt,function(n){return _(Dt,function(o){return _(Dt,function(c){return _(Dt,function(u){return _(Dt,function(i){return _(Dt,function(a){return _(Dt,function(l){return _(Dt,function(_){return Ht({renderMode:r,amplitude:t,colorShift:e,opacity:n,vignette:o,iris:c,faces:u,mirror:i,clip:a,lightSpeed:l,shareMesh:_})},_(Xt,"shareMesh",ee))},_(Xt,"lightSpeed",te))},_(Xt,"clip",Yt({ctor:"::",_0:qt(A),_1:{ctor:"::",_0:_(jt,P,_(Dt,function(r){return _(Dt,function(t){return Ht({ctor:"_Tuple2",_0:r,_1:t})},_(Kt,1,re))},_(Kt,0,re))),_1:{ctor:"[]"}}})))},_(Xt,"mirror",ee))},_(Xt,"faces",_(Dt,function(r){return _(Dt,function(t){return Ht({ctor:"_Tuple2",_0:r,_1:t})},_(Kt,1,te))},_(Kt,0,te))))},_(Xt,"iris",re))},_(Xt,"vignette",re))},_(Xt,"opacity",re))},_(Xt,"colorShift",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return Ht({ctor:"_Tuple3",_0:r,_1:t,_2:e})},_(Kt,2,re))},_(Kt,1,re))},_(Kt,0,re))))},_(Xt,"amplitude",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return Ht({ctor:"_Tuple3",_0:r,_1:t,_2:e})},_(Kt,2,re))},_(Kt,1,re))},_(Kt,0,re))))},_(Xt,"renderMode",ne))))),ue.incomingPort("changeProduct",ne)),md=ue.incomingPort("rebuildFss",_(Dt,function(r){return _(Dt,function(t){return Ht({value:r,layer:t})},_(Xt,"layer",te))},_(Xt,"value",_(Dt,function(r){return _(Dt,function(t){return Ht({lights:r,meshes:t})},_(Xt,"meshes",Qt(_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return _(Dt,function(n){return Ht({geometry:r,material:t,position:e,side:n})},_(Xt,"side",re))},_(Xt,"position",Qt(re)))},_(Xt,"material",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return Ht({ambient:r,diffuse:t,slave:e})},_(Xt,"slave",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return Ht({rgba:r,hex:t,opacity:e})},_(Xt,"opacity",re))},_(Xt,"hex",ne))},_(Xt,"rgba",Qt(re)))))},_(Xt,"diffuse",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return Ht({rgba:r,hex:t,opacity:e})},_(Xt,"opacity",re))},_(Xt,"hex",ne))},_(Xt,"rgba",Qt(re)))))},_(Xt,"ambient",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return Ht({rgba:r,hex:t,opacity:e})},_(Xt,"opacity",re))},_(Xt,"hex",ne))},_(Xt,"rgba",Qt(re)))))))},_(Xt,"geometry",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return _(Dt,function(n){return _(Dt,function(o){return _(Dt,function(c){return Ht({width:r,height:t,triangles:e,vertices:n,segmentWidth:o,sliceHeight:c})},_(Xt,"sliceHeight",re))},_(Xt,"segmentWidth",re))},_(Xt,"vertices",Qt(_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return _(Dt,function(n){return _(Dt,function(o){return Ht({position:r,v0:t,anchor:e,time:n,gradient:o})},_(Xt,"gradient",re))},_(Xt,"time",re))},_(Xt,"anchor",Qt(re)))},_(Xt,"v0",Qt(re)))},_(Xt,"position",Qt(re))))))},_(Xt,"triangles",Qt(_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return _(Dt,function(n){return _(Dt,function(o){return _(Dt,function(c){return _(Dt,function(u){return _(Dt,function(i){return _(Dt,function(a){return Ht({a:r,b:t,c:e,centroid:n,color:o,normal:c,u:u,v:i,vertices:a})},_(Xt,"vertices",Qt(_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return _(Dt,function(n){return _(Dt,function(o){return Ht({position:r,v0:t,anchor:e,time:n,gradient:o})},_(Xt,"gradient",re))},_(Xt,"time",re))},_(Xt,"anchor",Qt(re)))},_(Xt,"v0",Qt(re)))},_(Xt,"position",Qt(re))))))},_(Xt,"v",Qt(re)))},_(Xt,"u",Qt(re)))},_(Xt,"normal",Qt(re)))},_(Xt,"color",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return Ht({rgba:r,hex:t,opacity:e})},_(Xt,"opacity",re))},_(Xt,"hex",ne))},_(Xt,"rgba",Qt(re)))))},_(Xt,"centroid",Qt(re)))},_(Xt,"c",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return _(Dt,function(n){return _(Dt,function(o){return Ht({position:r,v0:t,anchor:e,time:n,gradient:o})},_(Xt,"gradient",re))},_(Xt,"time",re))},_(Xt,"anchor",Qt(re)))},_(Xt,"v0",Qt(re)))},_(Xt,"position",Qt(re)))))},_(Xt,"b",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return _(Dt,function(n){return _(Dt,function(o){return Ht({position:r,v0:t,anchor:e,time:n,gradient:o})},_(Xt,"gradient",re))},_(Xt,"time",re))},_(Xt,"anchor",Qt(re)))},_(Xt,"v0",Qt(re)))},_(Xt,"position",Qt(re)))))},_(Xt,"a",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return _(Dt,function(n){return _(Dt,function(o){return Ht({position:r,v0:t,anchor:e,time:n,gradient:o})},_(Xt,"gradient",re))},_(Xt,"time",re))},_(Xt,"anchor",Qt(re)))},_(Xt,"v0",Qt(re)))},_(Xt,"position",Qt(re))))))))},_(Xt,"height",te))},_(Xt,"width",te)))))))},_(Xt,"lights",Qt(_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return _(Dt,function(n){return _(Dt,function(o){return Ht({ambient:r,diffuse:t,speed:e,position:n,ray:o})},_(Xt,"ray",Qt(re)))},_(Xt,"position",Qt(re)))},_(Xt,"speed",re))},_(Xt,"diffuse",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return Ht({rgba:r,hex:t,opacity:e})},_(Xt,"opacity",re))},_(Xt,"hex",ne))},_(Xt,"rgba",Qt(re)))))},_(Xt,"ambient",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return Ht({rgba:r,hex:t,opacity:e})},_(Xt,"opacity",re))},_(Xt,"hex",ne))},_(Xt,"rgba",Qt(re))))))))))),gd=ue.incomingPort("turnOn",te),vd=ue.incomingPort("turnOff",te),bd=ue.incomingPort("mirrorOn",te),yd=ue.incomingPort("mirrorOff",te),Td=ue.incomingPort("import_",ne),wd=ue.incomingPort("changeFssRenderMode",_(Dt,function(r){return _(Dt,function(t){return Ht({value:r,layer:t})},_(Xt,"layer",te))},_(Xt,"value",ne))),Sd=ue.incomingPort("changeFacesX",_(Dt,function(r){return _(Dt,function(t){return Ht({value:r,layer:t})},_(Xt,"layer",te))},_(Xt,"value",te))),kd=ue.incomingPort("changeFacesY",_(Dt,function(r){return _(Dt,function(t){return Ht({value:r,layer:t})},_(Xt,"layer",te))},_(Xt,"value",te))),xd=ue.incomingPort("changeLightSpeed",_(Dt,function(r){return _(Dt,function(t){return Ht({value:r,layer:t})},_(Xt,"layer",te))},_(Xt,"value",te))),Cd=ue.incomingPort("changeVignette",_(Dt,function(r){return _(Dt,function(t){return Ht({value:r,layer:t})},_(Xt,"layer",te))},_(Xt,"value",re))),Fd=ue.incomingPort("changeIris",_(Dt,function(r){return _(Dt,function(t){return Ht({value:r,layer:t})},_(Xt,"layer",te))},_(Xt,"value",re))),Ld=ue.incomingPort("changeAmplitude",_(Dt,function(r){return _(Dt,function(t){return Ht({value:r,layer:t})},_(Xt,"layer",te))},_(Xt,"value",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return Ht({ctor:"_Tuple3",_0:r,_1:t,_2:e})},_(Kt,2,Yt({ctor:"::",_0:qt(A),_1:{ctor:"::",_0:_(jt,P,re),_1:{ctor:"[]"}}})))},_(Kt,1,Yt({ctor:"::",_0:qt(A),_1:{ctor:"::",_0:_(jt,P,re),_1:{ctor:"[]"}}})))},_(Kt,0,Yt({ctor:"::",_0:qt(A),_1:{ctor:"::",_0:_(jt,P,re),_1:{ctor:"[]"}}})))))),Rd=ue.incomingPort("shiftColor",_(Dt,function(r){return _(Dt,function(t){return Ht({value:r,layer:t})},_(Xt,"layer",te))},_(Xt,"value",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return Ht({ctor:"_Tuple3",_0:r,_1:t,_2:e})},_(Kt,2,Yt({ctor:"::",_0:qt(A),_1:{ctor:"::",_0:_(jt,P,re),_1:{ctor:"[]"}}})))},_(Kt,1,Yt({ctor:"::",_0:qt(A),_1:{ctor:"::",_0:_(jt,P,re),_1:{ctor:"[]"}}})))},_(Kt,0,Yt({ctor:"::",_0:qt(A),_1:{ctor:"::",_0:_(jt,P,re),_1:{ctor:"[]"}}})))))),Ad=ue.incomingPort("changeOpacity",_(Dt,function(r){return _(Dt,function(t){return Ht({value:r,layer:t})},_(Xt,"layer",te))},_(Xt,"value",re))),Md=ue.incomingPort("setCustomSize",_(Dt,function(r){return _(Dt,function(t){return Ht({ctor:"_Tuple2",_0:r,_1:t})},_(Kt,1,te))},_(Kt,0,te))),Pd=ue.incomingPort("applyRandomizer",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return _(Dt,function(n){return _(Dt,function(o){return _(Dt,function(c){return _(Dt,function(u){return _(Dt,function(i){return _(Dt,function(a){return _(Dt,function(l){return _(Dt,function(_){return Ht({background:r,layers:t,mode:e,mouse:n,now:o,origin:c,size:u,theta:i,omega:a,product:l,palette:_})},_(Xt,"palette",Qt(ne)))},_(Xt,"product",ne))},_(Xt,"omega",re))},_(Xt,"theta",re))},_(Xt,"size",_(Dt,function(r){return _(Dt,function(t){return Ht({ctor:"_Tuple2",_0:r,_1:t})},_(Kt,1,te))},_(Kt,0,te))))},_(Xt,"origin",_(Dt,function(r){return _(Dt,function(t){return Ht({ctor:"_Tuple2",_0:r,_1:t})},_(Kt,1,te))},_(Kt,0,te))))},_(Xt,"now",re))},_(Xt,"mouse",_(Dt,function(r){return _(Dt,function(t){return Ht({ctor:"_Tuple2",_0:r,_1:t})},_(Kt,1,te))},_(Kt,0,te))))},_(Xt,"mode",ne))},_(Xt,"layers",Qt(_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return _(Dt,function(n){return _(Dt,function(o){return _(Dt,function(c){return Ht({kind:r,blend:t,webglOrSvg:e,isOn:n,name:o,model:c})},_(Xt,"model",ne))},_(Xt,"name",ne))},_(Xt,"isOn",ee))},_(Xt,"webglOrSvg",ne))},_(Xt,"blend",_(Dt,function(r){return _(Dt,function(t){return Ht({ctor:"_Tuple2",_0:r,_1:t})},_(Kt,1,Yt({ctor:"::",_0:qt(A),_1:{ctor:"::",_0:_(jt,P,ne),_1:{ctor:"[]"}}})))},_(Kt,0,Yt({ctor:"::",_0:qt(A),_1:{ctor:"::",_0:_(jt,P,_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return Ht({color:r,colorEq:t,alphaEq:e})},_(Xt,"alphaEq",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return Ht({ctor:"_Tuple3",_0:r,_1:t,_2:e})},_(Kt,2,te))},_(Kt,1,te))},_(Kt,0,te))))},_(Xt,"colorEq",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return Ht({ctor:"_Tuple3",_0:r,_1:t,_2:e})},_(Kt,2,te))},_(Kt,1,te))},_(Kt,0,te))))},_(Xt,"color",Yt({ctor:"::",_0:qt(A),_1:{ctor:"::",_0:_(jt,P,_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return _(Dt,function(n){return Ht({r:r,g:t,b:e,a:n})},_(Xt,"a",re))},_(Xt,"b",re))},_(Xt,"g",re))},_(Xt,"r",re))),_1:{ctor:"[]"}}})))),_1:{ctor:"[]"}}})))))},_(Xt,"kind",ne)))))},_(Xt,"background",ne))),Ed=ue.incomingPort("savePng",qt({ctor:"_Tuple0"})),Nd=ue.incomingPort("changeWGLBlend",_(Dt,function(r){return _(Dt,function(t){return Ht({layer:r,value:t})},_(Xt,"value",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return Ht({color:r,colorEq:t,alphaEq:e})},_(Xt,"alphaEq",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return Ht({ctor:"_Tuple3",_0:r,_1:t,_2:e})},_(Kt,2,te))},_(Kt,1,te))},_(Kt,0,te))))},_(Xt,"colorEq",_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return Ht({ctor:"_Tuple3",_0:r,_1:t,_2:e})},_(Kt,2,te))},_(Kt,1,te))},_(Kt,0,te))))},_(Xt,"color",Yt({ctor:"::",_0:qt(A),_1:{ctor:"::",_0:_(jt,P,_(Dt,function(r){return _(Dt,function(t){return _(Dt,function(e){return _(Dt,function(n){return Ht({r:r,g:t,b:e,a:n})},_(Xt,"a",re))},_(Xt,"b",re))},_(Xt,"g",re))},_(Xt,"r",re))),_1:{ctor:"[]"}}})))))},_(Xt,"layer",te))),Bd=ue.incomingPort("changeSVGBlend",_(Dt,function(r){return _(Dt,function(t){return Ht({layer:r,value:t})},_(Xt,"value",ne))},_(Xt,"layer",te))),Od=ue.outgoingPort("startGui",function(r){return{background:r.background,layers:N.toArray(r.layers).map(function(r){return{kind:r.kind,blend:["Nothing"===r.blend._0.ctor?null:{color:"Nothing"===r.blend._0._0.color.ctor?null:{r:r.blend._0._0.color._0.r,g:r.blend._0._0.color._0.g,b:r.blend._0._0.color._0.b,a:r.blend._0._0.color._0.a},colorEq:[r.blend._0._0.colorEq._0,r.blend._0._0.colorEq._1,r.blend._0._0.colorEq._2],alphaEq:[r.blend._0._0.alphaEq._0,r.blend._0._0.alphaEq._1,r.blend._0._0.alphaEq._2]},"Nothing"===r.blend._1.ctor?null:r.blend._1._0],webglOrSvg:r.webglOrSvg,isOn:r.isOn,name:r.name,model:r.model}}),mode:r.mode,mouse:[r.mouse._0,r.mouse._1],now:r.now,origin:[r.origin._0,r.origin._1],size:[r.size._0,r.size._1],theta:r.theta,omega:r.omega,product:r.product,palette:N.toArray(r.palette).map(function(r){return r})}}),zd=ue.outgoingPort("requestFssRebuild",function(r){return{layer:r.layer,model:{background:r.model.background,layers:N.toArray(r.model.layers).map(function(r){return{kind:r.kind,blend:["Nothing"===r.blend._0.ctor?null:{color:"Nothing"===r.blend._0._0.color.ctor?null:{r:r.blend._0._0.color._0.r,g:r.blend._0._0.color._0.g,b:r.blend._0._0.color._0.b,a:r.blend._0._0.color._0.a},colorEq:[r.blend._0._0.colorEq._0,r.blend._0._0.colorEq._1,r.blend._0._0.colorEq._2],alphaEq:[r.blend._0._0.alphaEq._0,r.blend._0._0.alphaEq._1,r.blend._0._0.alphaEq._2]},"Nothing"===r.blend._1.ctor?null:r.blend._1._0],webglOrSvg:r.webglOrSvg,isOn:r.isOn,name:r.name,model:r.model}}),mode:r.model.mode,mouse:[r.model.mouse._0,r.model.mouse._1],now:r.model.now,origin:[r.model.origin._0,r.model.origin._1],size:[r.model.size._0,r.model.size._1],theta:r.model.theta,omega:r.model.omega,product:r.model.product,palette:N.toArray(r.model.palette).map(function(r){return r})},value:{renderMode:r.value.renderMode,amplitude:[r.value.amplitude._0,r.value.amplitude._1,r.value.amplitude._2],colorShift:[r.value.colorShift._0,r.value.colorShift._1,r.value.colorShift._2],opacity:r.value.opacity,vignette:r.value.vignette,iris:r.value.iris,faces:[r.value.faces._0,r.value.faces._1],mirror:r.value.mirror,clip:"Nothing"===r.value.clip.ctor?null:[r.value.clip._0._0,r.value.clip._0._1],lightSpeed:r.value.lightSpeed,shareMesh:r.value.shareMesh}}}),Id=e(function(r,t,e){var n,o=l($f,r,t,e);return{ctor:"_Tuple2",_0:o,_1:(n=_(Qf,r,o),"Just"===n.ctor&&"FssModel"===n._0.ctor?zd({layer:r,model:Nf(o),value:_(yf,n._0._0,o.product)}):_e)}}),qd=function(r){var e=Nf(r),n=t(function(t,n){return zd({layer:t,model:e,value:_(yf,n,r.product)})});return{ctor:"_Tuple2",_0:r,_1:ae(_(fr,n,_(Q,function(r){var t=r.model;return"FssModel"===t.ctor?P(t._0):A},r.layers)))}},Vd=ue.outgoingPort("presetSizeChanged",function(r){return{size:[r.size._0,r.size._1],product:r.product,coverSize:[r.coverSize._0,r.coverSize._1],background:r.background}}),Dd=ue.outgoingPort("export_",function(r){return r}),Gd=ue.outgoingPort("exportZip_",function(r){return r}),Hd=ue.outgoingPort("triggerSavePng",function(r){return{size:[r.size._0,r.size._1],product:r.product,coverSize:[r.coverSize._0,r.coverSize._1],background:r.background}}),Jd=ue.outgoingPort("requestRandomize",function(r){return{background:r.background,layers:N.toArray(r.layers).map(function(r){return{kind:r.kind,blend:["Nothing"===r.blend._0.ctor?null:{color:"Nothing"===r.blend._0._0.color.ctor?null:{r:r.blend._0._0.color._0.r,g:r.blend._0._0.color._0.g,b:r.blend._0._0.color._0.b,a:r.blend._0._0.color._0.a},colorEq:[r.blend._0._0.colorEq._0,r.blend._0._0.colorEq._1,r.blend._0._0.colorEq._2],alphaEq:[r.blend._0._0.alphaEq._0,r.blend._0._0.alphaEq._1,r.blend._0._0.alphaEq._2]},"Nothing"===r.blend._1.ctor?null:r.blend._1._0],webglOrSvg:r.webglOrSvg,isOn:r.isOn,name:r.name,model:r.model}}),mode:r.mode,mouse:[r.mouse._0,r.mouse._1],now:r.now,origin:[r.origin._0,r.origin._1],size:[r.size._0,r.size._1],theta:r.theta,omega:r.omega,product:r.product,palette:N.toArray(r.palette).map(function(r){return r})}}),Ud=ue.outgoingPort("requestFitToWindow",function(r){return null}),Wd=t(function(r,e){r:for(;;){var n=r;switch(n.ctor){case"Bang":return{ctor:"_Tuple2",_0:e,_1:Od(Nf(e))};case"ChangeMode":var o=n._0;return{ctor:"_Tuple2",_0:l(Is,o,td(),Zf),_1:ae({ctor:"::",_0:_(Qo,qs,Iu),_1:{ctor:"[]"}})};case"GuiMessage":var c=e.gui;if("Just"===c.ctor){var u=s(Va,Wd,e,n._0,c._0),i=u._0._0,a=u._0._1,f=u._1;return{ctor:"_Tuple2",_0:m.update(i,{gui:P(f)}),_1:a}}return{ctor:"_Tuple2",_0:e,_1:_e};case"Animate":var d=n._0;return{ctor:"_Tuple2",_0:m.update(e,{fps:S(1e3/d),theta:e.autoRotate||e.paused?e.theta:e.theta+d*e.omega/1e3,now:e.paused?e.now:e.now+d+e.timeShift}),_1:_e};case"Pause":return{ctor:"_Tuple2",_0:m.update(e,{paused:!0}),_1:_e};case"Continue":return{ctor:"_Tuple2",_0:m.update(e,{paused:!1}),_1:_e};case"TriggerPause":return{ctor:"_Tuple2",_0:m.update(e,{paused:!e.paused}),_1:_e};case"HideControls":return{ctor:"_Tuple2",_0:m.update(e,{controlsVisible:!1}),_1:_e};case"Import":return qd(_(R,e,l(xf,e.mode,Zf,n._0)));case"Export":return{ctor:"_Tuple2",_0:e,_1:Dd(Of(e))};case"ExportZip":return{ctor:"_Tuple2",_0:e,_1:Gd(Of(e))};case"TimeTravel":return{ctor:"_Tuple2",_0:m.update(e,{timeShift:n._0}),_1:_e};case"BackToNow":return{ctor:"_Tuple2",_0:m.update(e,{timeShift:0}),_1:_e};case"Rotate":return{ctor:"_Tuple2",_0:m.update(e,{omega:n._0}),_1:_e};case"Resize":var p=n._0.width,h=n._0.height;return{ctor:"_Tuple2",_0:m.update(e,{size:od({ctor:"_Tuple2",_0:p,_1:h}),origin:cd({ctor:"_Tuple2",_0:p,_1:h})}),_1:_e};case"ResizeFromPreset":var g=n._0.width,v=n._0.height;return{ctor:"_Tuple2",_0:i=m.update(e,{size:od({ctor:"_Tuple2",_0:g,_1:v}),origin:cd({ctor:"_Tuple2",_0:g,_1:v})}),_1:Vd(rd(i))};case"RequestFitToWindow":return{ctor:"_Tuple2",_0:e,_1:Ud({ctor:"_Tuple0"})};case"Locate":var b=m.update(e,{mouse:n._0});r=_(R,es,_(E,function(r){return Vs(_(Ua,r,{x:n._0._0,y:n._0._1}))},b.gui)),e=b;continue r;case"TurnOn":return{ctor:"_Tuple2",_0:l(jf,n._0,function(r){return m.update(r,{on:!0})},e),_1:_e};case"TurnOff":return{ctor:"_Tuple2",_0:l(jf,n._0,function(r){return m.update(r,{on:!1})},e),_1:_e};case"MirrorOn":return{ctor:"_Tuple2",_0:l(jf,n._0,function(r){var t=r.layer;if("WebGLLayer"===t.ctor){var e=t._0;return"FssLayer"===e.ctor?m.update(r,{layer:_(gf,_(af,e._0,e._1),t._1),kind:Zs}):r}return r},e),_1:_e};case"MirrorOff":return{ctor:"_Tuple2",_0:l(jf,n._0,function(r){var t=r.layer;if("WebGLLayer"===t.ctor){var e=t._0;return"MirroredFssLayer"===e.ctor?m.update(r,{layer:_(gf,_(_f,e._0,e._1),t._1),kind:$s}):r}return r},e),_1:_e};case"ChangeProduct":return qd(m.update(e,{product:n._0}));case"Configure":return{ctor:"_Tuple2",_0:l(Yf,n._0,t(function(r,t){var e=r;if("WebGLLayer"===e.ctor){var n=e._0;return _(gf,function(){var r={ctor:"_Tuple2",_0:n,_1:t};t:do{if("_Tuple2"!==r.ctor)break t;switch(r._0.ctor){case"LorenzLayer":if("LorenzModel"===r._1.ctor)return df(ai(r._1._0));break t;case"FractalLayer":if("FractalModel"===r._1.ctor)return ff(Il(r._1._0));break t;case"VoronoiLayer":if("VoronoiModel"===r._1.ctor)return sf(Hl(r._1._0));break t;case"FssLayer":if("FssModel"===r._1.ctor){var e=r._0._0,o=_(wl,r._1._0,e);return _(_f,e,o)}break t;case"MirroredFssLayer":if("FssModel"===r._1.ctor){var c=r._0._0;o=_(wl,r._1._0,c);return _(af,c,o)}break t;case"TemplateLayer":if("TemplateModel"===r._1.ctor)return lf(Yl(r._1._0));break t;default:if("VignetteModel"===r._1.ctor)return uf;break t}}while(0);return n}(),e._1)}return r}),e),_1:_e};case"ChangeWGLBlend":return{ctor:"_Tuple2",_0:s(Xf,n._0,function(r){return P(n._1)},function(r){return A},e),_1:_e};case"AlterWGLBlend":return{ctor:"_Tuple2",_0:s(Xf,n._0,function(r){return P(n._1(r))},function(r){return A},e),_1:_e};case"ChangeSVGBlend":return{ctor:"_Tuple2",_0:s(Xf,n._0,function(r){return A},function(r){return P(n._1)},e),_1:_e};case"ChangeFssRenderMode":return l(Id,n._0,function(r){return m.update(r,{renderMode:n._1})},e);case"ChangeFaces":return l(Id,n._0,function(r){return m.update(r,{faces:n._1})},e);case"AlterFaces":return l(Id,n._0,function(r){var t=r.faces,e=t._0,o=t._1;return m.update(r,{faces:{ctor:"_Tuple2",_0:_(R,e,n._1._0),_1:_(R,o,n._1._1)}})},e);case"ChangeLightSpeed":return l(Id,n._0,function(r){return m.update(r,{lightSpeed:n._1})},e);case"RebuildFss":var y=n._1;return{ctor:"_Tuple2",_0:l(Yf,n._0,t(function(r,t){var e=r;if("WebGLLayer"===e.ctor){var n=e._1,o={ctor:"_Tuple2",_0:e._0,_1:t};t:do{if("_Tuple2"!==o.ctor||"FssModel"!==o._1.ctor)break t;switch(o._0.ctor){case"FssLayer":var c=P(y),u=_(wl,o._1._0,c);return _(gf,_(_f,c,u),n);case"MirroredFssLayer":c=P(y),u=_(wl,o._1._0,c);return _(gf,_(af,c,u),n);default:break t}}while(0);return r}return r}),e),_1:_e};case"ChangeVignette":return{ctor:"_Tuple2",_0:l($f,n._0,function(r){return m.update(r,{vignette:n._1})},e),_1:_e};case"ChangeIris":return{ctor:"_Tuple2",_0:l($f,n._0,function(r){return m.update(r,{iris:n._1})},e),_1:_e};case"AlterAmplitude":return l(Id,n._0,function(r){var t=r.amplitude,e=t._0,o=t._1,c=t._2;return m.update(r,{amplitude:{ctor:"_Tuple3",_0:_(R,e,n._1._0),_1:_(R,o,n._1._1),_2:_(R,c,n._1._2)}})},e);case"ShiftColor":return{ctor:"_Tuple2",_0:l($f,n._0,function(r){var t=r.colorShift,e=t._0,o=t._1,c=t._2;return m.update(r,{colorShift:{ctor:"_Tuple3",_0:_(R,e,n._1._0),_1:_(R,o,n._1._1),_2:_(R,c,n._1._2)}})},e),_1:_e};case"ChangeOpacity":return{ctor:"_Tuple2",_0:l($f,n._0,function(r){return m.update(r,{opacity:n._1})},e),_1:_e};case"SavePng":return{ctor:"_Tuple2",_0:e,_1:Hd(rd(e))};case"Randomize":return{ctor:"_Tuple2",_0:e,_1:Jd(Nf(e))};case"ApplyRandomizer":return qd(_(Ff,Zf,n._0));default:return{ctor:"_Tuple2",_0:e,_1:_e}}}}),jd=Zn({init:nd,view:function(r){return _(to,{ctor:"[]"},{ctor:"::",_0:_(to,{ctor:"::",_0:Pc("svg-layers"),_1:{ctor:"[]"}},Hf(r)),_1:{ctor:"::",_0:r.controlsVisible?_(to,{ctor:"::",_0:Pc("overlay-panel import-export-panel hide-on-space"),_1:{ctor:"[]"}},{ctor:"::",_0:_(to,{ctor:"::",_0:Pc("timeline_holder"),_1:{ctor:"[]"}},{ctor:"::",_0:_(eo,{ctor:"::",_0:Pc("label past"),_1:{ctor:"[]"}},{ctor:"::",_0:Qn("past"),_1:{ctor:"[]"}}),_1:{ctor:"::",_0:_(oo,{ctor:"::",_0:Ec("range"),_1:{ctor:"::",_0:Pc("timeline"),_1:{ctor:"::",_0:Oc("0"),_1:{ctor:"::",_0:Bc("100"),_1:{ctor:"::",_0:Nc((n=r.timeShift,y(n/500*100+50))),_1:{ctor:"::",_0:Hc(function(r){return{ctor:"TimeTravel",_0:function(r){return(_(Lr,0,Er(r))-50)/100*500}(r)}}),_1:{ctor:"::",_0:(e=Ms,_(Gc,"mouseup",Ht(e))),_1:{ctor:"[]"}}}}}}}},{ctor:"[]"}),_1:{ctor:"::",_0:_(eo,{ctor:"::",_0:Pc("label future"),_1:{ctor:"[]"}},{ctor:"::",_0:Qn("future"),_1:{ctor:"[]"}}),_1:{ctor:"[]"}}}}),_1:{ctor:"::",_0:_(oo,{ctor:"::",_0:Ec("button"),_1:{ctor:"::",_0:Pc("export_html5"),_1:{ctor:"::",_0:Jc(Ps),_1:{ctor:"::",_0:Nc("warp in html5"),_1:{ctor:"[]"}}}}},{ctor:"::",_0:Qn("Export to html5.zip"),_1:{ctor:"[]"}}),_1:{ctor:"::",_0:_(oo,{ctor:"::",_0:Ec("button"),_1:{ctor:"::",_0:Pc("export_png"),_1:{ctor:"::",_0:Jc(ns),_1:{ctor:"::",_0:Nc("blast to png"),_1:{ctor:"[]"}}}}},{ctor:"::",_0:Qn("Export to png"),_1:{ctor:"[]"}}),_1:{ctor:"::",_0:_(to,{ctor:"::",_0:Pc("spacebar_info"),_1:{ctor:"[]"}},{ctor:"::",_0:Qn("spacebar to hide controls, click to pause"),_1:{ctor:"[]"}}),_1:{ctor:"[]"}}}}}):_(to,{ctor:"[]"},{ctor:"[]"}),_1:{ctor:"::",_0:l(_o,{ctor:"::",_0:mo,_1:{ctor:"::",_0:vo(!0),_1:{ctor:"::",_0:s(ho,0,0,0,1),_1:{ctor:"[]"}}}},{ctor:"::",_0:Pc("webgl-layers"),_1:{ctor:"::",_0:(t=ce(r.size),_(Lc,"width",y(t))),_1:{ctor:"::",_0:Rc(oe(r.size)),_1:{ctor:"::",_0:Ic({ctor:"::",_0:{ctor:"_Tuple2",_0:"display",_1:"block"},_1:{ctor:"[]"}}),_1:{ctor:"::",_0:Jc(Ls),_1:{ctor:"[]"}}}}}},Jf(r)),_1:{ctor:"::",_0:_(R,_(to,{ctor:"[]"},{ctor:"[]"}),_(E,function(r){return _(to,{ctor:"::",_0:Pc("hide-on-space"),_1:{ctor:"[]"}},{ctor:"::",_0:r,_1:{ctor:"[]"}})},_(E,$n(Vs),_(E,Wa,r.gui)))),_1:{ctor:"[]"}}}}});var t,e,n},subscriptions:function(r){return de({ctor:"::",_0:ud(function(r){return Gs}),_1:{ctor:"::",_0:(t=Ds,gc(wc(t))),_1:{ctor:"::",_0:Hu(qs),_1:{ctor:"::",_0:nu(function(t){var e=t;return _(R,es,_(E,function(r){return{ctor:"Locate",_0:r}},_(Uf,r.size,{ctor:"_Tuple2",_0:e.x,_1:e.y})))}),_1:{ctor:"::",_0:ou(_(Wf,Ha,r)),_1:{ctor:"::",_0:cu(_(Wf,Ja,r)),_1:{ctor:"::",_0:fd(Ns),_1:{ctor:"::",_0:hd(function(r){return Cs(ll(r))}),_1:{ctor:"::",_0:wd(function(r){var t=r;return _(ps,t.layer,Ml(t.value))}),_1:{ctor:"::",_0:Sd(function(t){var e=t,n=e.layer,o=_(Qf,n,r);if("Just"===o.ctor&&"FssModel"===o._0.ctor){var c=o._0._0.faces;return _(ds,n,{ctor:"_Tuple2",_0:e.value,_1:c._1})}return es}),_1:{ctor:"::",_0:kd(function(t){var e=t,n=e.layer,o=_(Qf,n,r);if("Just"===o.ctor&&"FssModel"===o._0.ctor){var c=o._0._0.faces;return _(ds,n,{ctor:"_Tuple2",_0:c._0,_1:e.value})}return es}),_1:{ctor:"::",_0:xd(function(r){var t=r;return _(ss,t.layer,t.value)}),_1:{ctor:"::",_0:Ld(function(r){var t=r;return _(as,t.layer,t.value)}),_1:{ctor:"::",_0:Rd(function(r){var t=r;return _(is,t.layer,t.value)}),_1:{ctor:"::",_0:Ad(function(r){var t=r;return _(us,t.layer,t.value)}),_1:{ctor:"::",_0:Cd(function(r){var t=r;return _(ls,t.layer,t.value)}),_1:{ctor:"::",_0:Fd(function(r){var t=r;return _(_s,t.layer,t.value)}),_1:{ctor:"::",_0:id(function(r){return{ctor:"ChangeMode",_0:vf(r)}}),_1:{ctor:"::",_0:Md(function(t){var e=t,n=e._0,o=e._1,c=m.cmp(n,0)>0&&m.cmp(o,0)>0?{ctor:"_Tuple2",_0:n,_1:o}:r.size,u=c._0,i=c._1;return Os(_(Du,u,i))}),_1:{ctor:"::",_0:Nd(function(r){var t=r;return _(bs,t.layer,t.value)}),_1:{ctor:"::",_0:Bd(function(r){var t=r;return _(ms,t.layer,N_(t.value))}),_1:{ctor:"::",_0:dd(function(r){var t=r;return _(ys,t.layer,cf(t.value))}),_1:{ctor:"::",_0:pd(function(r){var t,e=r;return _(ys,e.layer,of((t=e.value,m.update(t,{renderMode:Ml(t.renderMode)}))))}),_1:{ctor:"::",_0:md(function(r){var t=r;return _(hs,t.layer,t.value)}),_1:{ctor:"::",_0:Pd(os),_1:{ctor:"::",_0:Td(Es),_1:{ctor:"::",_0:ad(function(r){return As}),_1:{ctor:"::",_0:_d(function(r){return Rs}),_1:{ctor:"::",_0:ld(function(r){return Ls}),_1:{ctor:"::",_0:sd(function(r){return Fs}),_1:{ctor:"::",_0:gd(ks),_1:{ctor:"::",_0:vd(Ss),_1:{ctor:"::",_0:bd(ws),_1:{ctor:"::",_0:yd(Ts),_1:{ctor:"::",_0:Ed(function(r){return ns}),_1:{ctor:"[]"}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}});var t},update:Wd})(),Yd=(n(function(r,t,e,n){return{size:r,product:t,coverSize:e,background:n}}),{});if(Yd.Main=Yd.Main||{},void 0!==jd&&jd(Yd.Main,"Main",void 0),"function"==typeof define&&define.amd)define([],function(){return Yd});else if("object"!=typeof r){var Kd=this.Elm;if(void 0!==Kd)for(var Xd in Yd){if(Xd in Kd)throw new Error("There are two Elm modules called `"+Xd+"` on this page! Rename one of them.");Kd[Xd]=Yd[Xd]}else this.Elm=Yd}else r.exports=Yd}).call(this)}]);